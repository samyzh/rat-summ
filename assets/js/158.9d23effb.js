(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{1566:function(t,s,a){t.exports=a.p+"assets/img/react生命周期old.d2a6752a.png"},1567:function(t,s,a){t.exports=a.p+"assets/img/react生命周期new.a8766f0b.png"},2255:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"react"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#react"}},[t._v("#")]),t._v(" React")]),t._v(" "),n("h2",{attrs:{id:"生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),n("h3",{attrs:{id:"图示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#图示"}},[t._v("#")]),t._v(" 图示")]),t._v(" "),n("p",[t._v("React 16.3 版本之前 生命周期")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1566),alt:"c"}})]),t._v(" "),n("p",[t._v("React 新版 生命周期")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1567),alt:"react生命周期new"}})]),t._v(" "),n("h2",{attrs:{id:"组件通信"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#组件通信"}},[t._v("#")]),t._v(" 组件通信")]),t._v(" "),n("ul",[n("li",[t._v("props，父子通信")]),t._v(" "),n("li",[t._v("回调函数，子父通信")]),t._v(" "),n("li",[t._v("变量提升，兄弟组建通信")]),t._v(" "),n("li",[t._v("Context,跨组建通信")]),t._v(" "),n("li",[t._v("node的events模块的单例通信")]),t._v(" "),n("li",[t._v("redux共享数据通信")])]),t._v(" "),n("h2",{attrs:{id:"样式配合"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#样式配合"}},[t._v("#")]),t._v(" 样式配合")]),t._v(" "),n("h3",{attrs:{id:"样式化加载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#样式化加载"}},[t._v("#")]),t._v(" 样式化加载")]),t._v(" "),n("p",[t._v("有多种方法可用于对 React 组件进行样式设置，每种方法各有利弊。要提到的主要是：")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("内联样式")]),t._v("：适用于原型设计，但有局限性（例如，无伪类样式）")]),t._v(" "),n("li",[n("strong",[t._v("基于类的CSS样式")]),t._v("：比内联样式更高效，并且对 React 刚接触的开发人员来说是熟悉的")]),t._v(" "),n("li",[n("strong",[t._v("JS样式中的CSS")]),t._v("：有许多库允许将样式在组件内声明为 JavaScript，从而将样式更像代码。")])]),t._v(" "),n("p",[t._v("参考文章："),n("a",{attrs:{href:"https://www.sitepoint.com/react-components-styling-options/",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-components-styling-options"),n("OutboundLink")],1)]),t._v(" "),n("ul",[n("li",[t._v("inline CSS")]),t._v(" "),n("li",[t._v("normal CSS")]),t._v(" "),n("li",[t._v("CSS in JS libraries")]),t._v(" "),n("li",[t._v("CSS Modules")]),t._v(" "),n("li",[t._v("Sass & SCSS")]),t._v(" "),n("li",[t._v("Less")]),t._v(" "),n("li",[t._v("Stylable")])]),t._v(" "),n("h3",{attrs:{id:"前端富文本实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端富文本实现"}},[t._v("#")]),t._v(" 前端富文本实现")]),t._v(" "),n("div",{staticClass:"language-html line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("const rawHtml = '"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Title"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("'\nconst rawHtmlData = {\n    __html: rawHtml // 这里有个下划线\n}\nreturn "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("dangerouslySetInnerHTML")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),t._v("{rawHtmlData}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("h2",{attrs:{id:"jsx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jsx"}},[t._v("#")]),t._v(" jsx")]),t._v(" "),n("blockquote",[n("p",[n("strong",[t._v("每个 JSX 元素只是调用 "),n("code",[t._v("React.createElement(component, props, ...children)")]),t._v(" 的语法糖")]),t._v("。因此，使用 JSX 可以完成的任何事情都可以通过纯 JavaScript 完成")])]),t._v(" "),n("p",[t._v("本质："),n("strong",[t._v("JSX => React.createElement() => 虚拟DOM (JS对象) => 真实DOM")])]),t._v(" "),n("h3",{attrs:{id:"为什么使用jsx的组件中没有看到使用react却需要引入react"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么使用jsx的组件中没有看到使用react却需要引入react"}},[t._v("#")]),t._v(" 为什么使用jsx的组件中没有看到使用react却需要引入react？")]),t._v(" "),n("p",[t._v("本质上来说JSX是"),n("code",[t._v("React.createElement(component, props, ...children)")]),t._v("方法的语法糖。在React 17之前，如果使用了JSX，其实就是在使用React， "),n("code",[t._v("babel")]),t._v(" 会把组件转换为 "),n("code",[t._v("CreateElement")]),t._v(" 形式。"),n("strong",[t._v("在React 17之后，就不再需要引入，因为 "),n("code",[t._v("babel")]),t._v(" 已经可以帮我们自动引入react。")])]),t._v(" "),n("h3",{attrs:{id:"如何-react-createelement"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何-react-createelement"}},[t._v("#")]),t._v(" 如何 React.createElement ？")]),t._v(" "),n("div",{staticClass:"language-jsx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("className")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("greeting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n    Hello, world!\n  ")]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("p",[t._v("上述代码如何使用 "),n("code",[t._v("React.createElement")]),t._v(" 来实现:")]),t._v(" "),n("div",{staticClass:"language-jsx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" element "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("className"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'greeting'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello, world!'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br")])]),n("h2",{attrs:{id:"hooks"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[t._v("#")]),t._v(" Hooks")]),t._v(" "),n("h3",{attrs:{id:"_10个api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10个api"}},[t._v("#")]),t._v(" 10个API")]),t._v(" "),n("ul",[n("li",[t._v("Basic Hooks\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usestate",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useState")]),n("OutboundLink")],1),t._v("【维护状态】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#useeffect",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useEffect")]),n("OutboundLink")],1),t._v("【完成副作用操作】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usecontext",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useContext")]),n("OutboundLink")],1),t._v("【使用共享状态】")])])]),t._v(" "),n("li",[t._v("Additional Hooks\n"),n("ul",[n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usereducer",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useReducer")]),n("OutboundLink")],1),t._v("【类似redux】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usecallback",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useCallback")]),n("OutboundLink")],1),t._v("【缓存函数】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usememo",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useMemo")]),n("OutboundLink")],1),t._v("【缓存值】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#useref",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useRef")]),n("OutboundLink")],1),t._v("【访问DOM】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#useimperativehandle",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useImperativeHandle")]),n("OutboundLink")],1),t._v("【使用子组件暴露的值/方法】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#uselayouteffect",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useLayoutEffect")]),n("OutboundLink")],1),t._v("【完成副作用操作，会阻塞浏览器绘制】")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://reactjs.org/docs/hooks-reference.html#usedebugvalue",target:"_blank",rel:"noopener noreferrer"}},[n("code",[t._v("useDebugValue")]),n("OutboundLink")],1),t._v("【开发者工具中显示自定义 hook 的标签】")])])])]),t._v(" "),n("h3",{attrs:{id:"useeffet"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#useeffet"}},[t._v("#")]),t._v(" useEffet")]),t._v(" "),n("p",[t._v("我们可以理解成它替换了"),n("code",[t._v("componentDidMount")]),t._v(", "),n("code",[t._v("componentDidUpdate")]),t._v(", "),n("code",[t._v("componentWillUnmount")]),t._v(" 这三个生命周期，但是它的功能还更强大。")]),t._v(" "),n("p",[n("strong",[t._v("包含3个生命周期的代码结构")])]),t._v(" "),n("div",{staticClass:"language-jsx line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// => componentDidMount/componentDidUpdate")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里的代码块 等价于 componentDidMount")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something...")]),t._v("\n    \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return的写法 等价于 componentWillUnmount ")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something...")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依赖列表，当依赖的值有变更时候，执行副作用函数，等价于 componentDidUpdate")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" xxx，obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("p",[t._v("注意：依赖列表是灵活的，有三种写法")]),t._v(" "),n("ul",[n("li",[t._v("当数组为空 "),n("code",[t._v("[ ]")]),t._v("，表示不会应为页面的状态改变而执行回调方法【即仅在初始化时执行，"),n("code",[t._v("componentDidMount")]),t._v("】，")]),t._v(" "),n("li",[t._v("当这个参数不传递，表示页面的任何状态一旦变更都会执行回调方法")]),t._v(" "),n("li",[t._v("当数组非空，数组里的值一旦有变化，就会执行回调方法")])]),t._v(" "),n("h4",{attrs:{id:"模拟react的生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模拟react的生命周期"}},[t._v("#")]),t._v(" 模拟React的生命周期")]),t._v(" "),n("ul",[n("li",[t._v("constructor：函数组件不需要构造函数。你可以通过调用 useState 来初始化 state。")]),t._v(" "),n("li",[t._v("componentDidMount：通过 useEffect 传入第二个参数为[]实现。")]),t._v(" "),n("li",[t._v("componentDidUpdate：通过 useEffect 传入第二个参数为空或者为值变动的数组。")]),t._v(" "),n("li",[t._v("componentWillUnmount：主要用来清除副作用。通过 useEffect 函数 return 一个函数来模拟。")]),t._v(" "),n("li",[t._v("shouldComponentUpdate：你可以用 React.memo 包裹一个组件来对它的 props 进行浅比较。来模拟是否更新组件。")]),t._v(" "),n("li",[t._v("componentDidCatch and getDerivedStateFromError：目前还没有这些方法的 Hook 等价写法，但很快会加上。")])]),t._v(" "),n("h1",{attrs:{id:"性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),n("h2",{attrs:{id:"总括"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总括"}},[t._v("#")]),t._v(" 总括")]),t._v(" "),n("p",[n("strong",[t._v("性能优化，永远是面试的重点，性能优化对于 React 更加重要")])]),t._v(" "),n("ul",[n("li",[t._v("在页面中使用了"),n("code",[t._v("setTimout()")]),t._v("、"),n("code",[t._v("addEventListener()")]),t._v("等，要及时在"),n("code",[t._v("componentWillUnmount()")]),t._v("中销毁")]),t._v(" "),n("li",[t._v("使用异步组件")]),t._v(" "),n("li",[t._v("使用 "),n("code",[t._v("React-loadable")]),t._v(" 动态加载组件")]),t._v(" "),n("li",[n("code",[t._v("shouldComponentUpdate")]),t._v("(简称SCU )、"),n("code",[t._v("React.PureComponent")]),t._v("、"),n("code",[t._v("React.memo")])]),t._v(" "),n("li",[t._v("不可变值 ImmutableJS")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shouldComponentUpdate")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以渲染，执行 render()，默认返回 true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不能渲染，不执行 render()")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("h2",{attrs:{id:"详细分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#详细分类"}},[t._v("#")]),t._v(" 详细分类")]),t._v(" "),n("h3",{attrs:{id:"什么情况下需要使用-shouldcomponentupdate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么情况下需要使用-shouldcomponentupdate"}},[t._v("#")]),t._v(" 什么情况下需要使用 shouldComponentUpdate")]),t._v(" "),n("blockquote",[n("p",[t._v("在React中，默认情况下，如果父组件数据发生了更新，那么所有子组件都会无条件更新 !!!!!!\n通过"),n("code",[t._v("shouldComponentUpdate()")]),t._v("retrun fasle 来判断阻止 Header 组件做无意义的更新\n"),n("code",[t._v("shouldComponentUpdate()")]),t._v("并不是每次都需要使用，而是需要的时候才会优化")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("App")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" list"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 当list数据发生变化时，Header组件也会更新，调用 render() */")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Header "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n                "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("List data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("p",[t._v("在"),n("code",[t._v("shouldComponentUpdate()")]),t._v("判断中，有一个有意思的问题，解释为什么 React "),n("code",[t._v("setState()")]),t._v(" 要用不可变值")]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 父组件中")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("changeList")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        list"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 子组件中")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" _ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lodash'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("shouldComponentUpdate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数组深度比较（一次性递归到底，耗费性能，工作中慎用）")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEqual")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("list"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 相等，不渲染")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不相等，渲染")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br")])]),n("blockquote",[n("p",[t._v("子组件将始终不会渲染，因为在"),n("code",[t._v("shouldComponentUpdate()")]),t._v("中，"),n("code",[t._v("this.state.list.push()")]),t._v("已经修改了"),n("code",[t._v("this.props.list")]),t._v("，而"),n("code",[t._v("this.setState()")]),t._v("修改了"),n("code",[t._v("nextProps.list")]),t._v("所以两个值深度比较，将始终相同。")])]),t._v(" "),n("h3",{attrs:{id:"purecomponent-和-memo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#purecomponent-和-memo"}},[t._v("#")]),t._v(" PureComponent 和 memo")]),t._v(" "),n("ul",[n("li",[t._v("class类组件中用"),n("code",[t._v("PureComponent")]),t._v("，无状态组件(无状态)中用"),n("code",[t._v("memo")])]),t._v(" "),n("li",[t._v("PureComponent, SCU中实现了浅比较")]),t._v(" "),n("li",[t._v("浅比较已使用大部分情况（尽量不要做深度比较）")])]),t._v(" "),n("blockquote",[n("p",[t._v("PureComponent 与普通 Component 不同的地方在于，PureComponent自带了一个"),n("code",[t._v("shouldComponentUpdate()")]),t._v("，并且进行了浅比较")])]),t._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// memo用法")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("MyComponent")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 使用 props 渲染 */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// areEqual 也可不传")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("areEqual")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("prevProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextProps")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prevProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v("nextProps"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" React"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("memo")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyComponent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" areEqual"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br")])]),n("h3",{attrs:{id:"immutable-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#immutable-js"}},[t._v("#")]),t._v(" immutable.js")]),t._v(" "),n("ul",[n("li",[t._v("彻底拥抱“不可变值”")]),t._v(" "),n("li",[t._v("基础共享数据（不是深拷贝），速度快")]),t._v(" "),n("li",[t._v("有一定学习和迁移成本")])]),t._v(" "),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),n("p",[t._v("https://zh-hans.reactjs.org/docs/getting-started.html")])])}),[],!1,null,null,null);s.default=e.exports}}]);