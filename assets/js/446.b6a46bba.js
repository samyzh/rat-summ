(window.webpackJsonp=window.webpackJsonp||[]).push([[446],{2077:function(s,a,t){"use strict";t.r(a);var n=t(14),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("h3",{attrs:{id:"源码方式安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#源码方式安装"}},[s._v("#")]),s._v(" 源码方式安装")]),s._v(" "),t("ul",[t("li",[s._v("官网下载\n"),t("a",{attrs:{href:"https://links.jianshu.com/go?to=https%3A%2F%2Fdownload.docker.com%2Flinux%2Fstatic%2Fstable%2Fx86_64%2F",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://download.docker.com/linux/static/stable/x86_64/"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("解压缩")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf docker-xxxxx.tgz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("拷贝二进制文件")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" docker/* /usr/bin/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("docker注册为server")])]),s._v(" "),t("p",[s._v("创建 "),t("code",[s._v("/etc/systemd/system/docker.service")]),s._v("文件内容如下：")]),s._v(" "),t("div",{staticClass:"language-conf line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[Unit]\n\nDescription=Docker Application Container Engine\n\nDocumentation=https://docs.docker.com\n\nAfter=network-online.target firewalld.service\n\nWants=network-online.target\n\n[Service]\n\nType=notify\n\n# the default is not to use systemd for cgroups because the delegate issues still\n\n# exists and systemd currently does not support the cgroup feature set required\n\n# for containers run by docker\n\nExecStart=/usr/bin/dockerd\n\nExecReload=/bin/kill -s HUP $MAINPID\n\n# Having non-zero Limit*s causes performance problems due to accounting overhead\n\n# in the kernel. We recommend using cgroups to do container-local accounting.\n\nLimitNOFILE=infinity\n\nLimitNPROC=infinity\n\nLimitCORE=infinity\n\n# Uncomment TasksMax if your systemd version supports it.\n\n# Only systemd 226 and above support this version.\n\n#TasksMax=infinity\n\nTimeoutStartSec=0\n\n# set delegate yes so that systemd does not reset the cgroups of docker containers\n\nDelegate=yes\n\n# kill only the docker process, not all processes in the cgroup\n\nKillMode=process\n\n# restart the docker process if it exits prematurely\n\nRestart=on-failure\n\nStartLimitBurst=3\n\nStartLimitInterval=60s\n\n[Install]\n\nWantedBy=multi-user.target\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br")])]),t("ul",[t("li",[s._v("给执行权限")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/systemd/system/docker.service\nsystemctl daemon-reload\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("启动并设置开机启动")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl daemon-reload \nsystemctl start redis-server.service \nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" redis-server.servic\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -A"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置"}},[s._v("#")]),s._v(" 设置")]),s._v(" "),t("p",[s._v("创建docker用户组")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" docker     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加docker用户组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" gpasswd -a "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v(" docker     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#将登陆用户加入到docker用户组中")]),s._v("\nnewgrp docker     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#更新用户组")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#测试docker命令是否可以使用sudo正常使用")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"存储目录迁移"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#存储目录迁移"}},[s._v("#")]),s._v(" 存储目录迁移")]),s._v(" "),t("h3",{attrs:{id:"背景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[s._v("#")]),s._v(" 背景")]),s._v(" "),t("p",[s._v("docker的默认存储目录是"),t("code",[s._v("/var/lib/docker")]),s._v(",目录结构如下：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ztscshop docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /var/lib/docker")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ztscshop docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal 64\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  2 root root  4096 Jan 24  2019 builder\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  4 root root  4096 Jan 24  2019 buildkit\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("x  3 root root  4096 Jan 24  2019 containerd\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  4 root root  4096 Oct 24 15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("05 containers\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  3 root root  4096 Jan 24  2019 image\ndrwxr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  3 root root  4096 Jan 24  2019 network\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v(" 80 root root 16384 Oct 24 15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("25 overlay2\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  4 root root  4096 Jan 24  2019 plugins\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  2 root root  4096 Oct 22 11"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("57 runtimes\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  2 root root  4096 Jan 24  2019 swarm\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  2 root root  4096 Oct 24 15"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("13 tmp\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  2 root root  4096 Jan 24  2019 trust\ndrwx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v(" 15 root root  4096 Feb  7  2019 volumes\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ztscshop docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("docker所有自身的东西都会存在这些文件夹下面包括镜像文件和容器，所以会占用越来越多的磁盘空间。")]),s._v(" "),t("p",[s._v("如果docker所在的磁盘空间比较小，磁盘空间被占满没有空间的时候，显然会导致docker容器运行失败，此时必然要"),t("strong",[s._v("迁移docker的存储目录到一个更大的磁盘下面")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"查看占用空间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看占用空间"}},[s._v("#")]),s._v(" 查看占用空间")]),s._v(" "),t("p",[t("strong",[s._v("检查各磁盘空间的命令：")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#全局查看")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("df")]),s._v(" -h \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#依次查看各个目录的磁盘大小")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("du")]),s._v(" -ah --max-depth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("查看磁盘占用情况："),t("code",[s._v("df -h")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ecs-8f49 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem      Size  Used Avail Use% Mounted on\ndevtmpfs        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G   73M  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".7G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(".8G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/vda1        40G   13G   25G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("% /\ntmpfs           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".6G     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".6G   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\noverlay          40G   13G   25G  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("% /var/lib/docker/overlay2/53eb033fae8fadc98df74b118e743092fcd0ee68b579c2b771288c3c023b0b8b/merged\nshm              64M     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   64M   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /var/lib/docker/containers/8ecb90f024c08468c5f32e7c8b8b0d1ff87616536e6c2155cfb58447bded3071/shm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("查看docker自身的内存占用："),t("code",[s._v("docker system df")])]),s._v(" "),t("div",{staticClass:"language-scss line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-scss"}},[t("code",[s._v("[root@ecs-8f49 ~]# docker system df\n  TYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE\n  Images              16                  12                  2.893 GB            1.535 GB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("53%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Containers          12                  1                   155.6 MB            155.6 MB "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("100%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Local Volumes       1                   1                   4.212 GB            0 B "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("0%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"清除无用垃圾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#清除无用垃圾"}},[s._v("#")]),s._v(" 清除无用垃圾")]),s._v(" "),t("p",[t("code",[s._v("docker system prune")])]),s._v(" "),t("p",[s._v("命令可以用于清理磁盘，删除关闭的容器、无用的数据卷和网络，以及dangling镜像(即无tag的镜像)。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@ecs")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("f49 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker system prune")]),s._v("\n    WARNING"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" This will remove:\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" stopped containers\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" volumes "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" at least one container\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" networks "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" at least one container\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" dangling images\n    Are you sure you want "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v("? "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("y"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("N"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" y\n    Deleted Containers:\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("bd48276fcd28b3882605fd67a156a7ea848f8fbfe16c3588b630955dfda253d\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("74")]),s._v("af4504bdefbc58b83a476c12d6ce10260f91349eed0e5bfca5e51b86fb8474\n    d405d43eeb7908472b4b8712f668ca3b97f3796f6afc1c1d19a15879140ddf64\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("f645670de22840d04249351d07b2f68f77754e4dfebdb4b39c56d827d6b6805\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v("d32c6b3c34bb359cbbf8309d7be34074da391d3b48083f456a5911259a5213\n    ad7137d7e018144e17790a3c86a8217a95faecd07a39003bc4df275c8c8d351d\n    b02eb42677a52663e50fc4a2b1344d37a8d2a2cca445fe5eae49648a0ca54b13\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0813454")]),s._v("a5421cf380b72265c2e6832411a590479424dbc3470e47e1cc9cdd740\n    a58b5f545ce1cd03a2899ba277641b5f52203802d9672c72f281f2d5a31fc219\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("936")]),s._v("e65f72c60d754cb2a1441d0cdeb18f9a7ebde353f091fc44a034733fed52c\n    ad86565bd85af04f5847703ba213d226c7d7b69e5210211e4170671d3ea4051c\n\n    Deleted Volumes:\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("37620879")]),s._v("ca58c052c47e7677a1851f45c25cbc0437c8883cc2fe8e70e1cb921a\n\n    Total reclaimed space: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.368")]),s._v(" GB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[t("code",[s._v("docker system prune -a")]),s._v("命令清理得更加彻底，可以将没有容器使用Docker镜像都删掉。")]),s._v(" "),t("p",[s._v("注意，这两个命令会把你暂时关闭的容器，以及暂时没有用到的Docker镜像都删掉了…所以使用之前一定要想清楚.。我没用过，因为会清理 没有开启的 Docker 镜像。")]),s._v(" "),t("h3",{attrs:{id:"配置及目录迁移"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置及目录迁移"}},[s._v("#")]),s._v(" 配置及目录迁移")]),s._v(" "),t("p",[t("strong",[s._v("停止docker服务")])]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("systemctl stop docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("创建新的docker目录，执行命令df -h,找一个大的磁盘。 我在 /home目录下面建了 "),t("code",[s._v("/home/docker/lib")]),s._v("目录，执行的命令是：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /home/docker/lib\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("迁移"),t("code",[s._v("/var/lib/docker")]),s._v("目录下面的文件到 "),t("code",[s._v("/home/docker/lib")]),s._v("：")]),s._v(" "),t("p",[t("strong",[s._v("(rsync是linux文件夹同步的命令，参数要加一个-r,因为文件夹要递归copy，如果在同一台服务器上面，直接cp也是可以的)")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" -r -avz /var/lib/docker /home/docker/lib/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("配置 "),t("code",[s._v("/etc/systemd/system/docker.service.d/devicemapper.conf")]),s._v("。查看 "),t("code",[s._v("devicemapper.conf")]),s._v(" 是否存在。如果不存在，就新建。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/systemd/system/docker.service.d/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/systemd/system/docker.service.d/devicemapper.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后在 "),t("code",[s._v("devicemapper.conf")]),s._v(" 写入：（同步的时候把父文件夹一并同步过来，实际上的目录应在 /home/docker/lib/docker ）")]),s._v(" "),t("div",{staticClass:"language-ini line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ini"}},[t("code",[t("span",{pre:!0,attrs:{class:"token selector"}},[s._v("[Service]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v("/usr/bin/dockerd --graph=/home/docker/lib/docker")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("重新加载 docker")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl daemon-reload\nsystemctl restart docker\nsystemctl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("为了确认一切顺利，运行")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("docker info\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("命令检查Docker 的根目录.它将被更改为 "),t("code",[s._v("/home/docker/lib/docker")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Root")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("docker\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Debug")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mode")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Debug")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Mode")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Registry")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("v1"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("启动成功后，再确认之前的镜像还在：")]),s._v(" "),t("div",{staticClass:"language-ruby line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-ruby"}},[t("code",[s._v("root"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@nn0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("$ docker images\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REPOSITORY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TAG")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IMAGE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CREATED")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SIZE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AAA")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AAA")]),s._v(" v2 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7331")]),s._v("b8651bcc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" hours ago "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.85")]),s._v("GB\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BBB")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BBB")]),s._v(" v1 da4a80dd8424 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" hours ago "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.47")]),s._v("GB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("确定容器没问题后删除"),t("code",[s._v("/var/lib/docker/")]),s._v("目录中的文件。")]),s._v(" "),t("h3",{attrs:{id:"可能相关问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可能相关问题"}},[s._v("#")]),s._v(" 可能相关问题")]),s._v(" "),t("h4",{attrs:{id:"docker无法启动-driver-not-supported"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker无法启动-driver-not-supported"}},[s._v("#")]),s._v(" Docker无法启动 driver not supported")]),s._v(" "),t("p",[s._v("迁移"),t("code",[s._v("/var/lib/docker")]),s._v("目录后，Docker无法启动 (error initializing graphdriver: driver not supported)")]),s._v(" "),t("p",[s._v("启动信息")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nn0 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start docker")]),s._v("\nJob "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" docker.service failed because the control process exited with error code. See "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"systemctl status docker.service"')]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"journalctl -xe"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" details.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("启动详情")]),s._v(" "),t("div",{staticClass:"language-vhdl line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-vhdl"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain systemd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Starting Docker Application Container Engine"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Subject: Unit docker.service has begun start-up")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Defined-By: systemd")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- Unit docker.service has begun starting up.")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain dockerd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2390")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" time"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018-08-31T01:47:25.197015872+08:00"')]),s._v(" level"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("info msg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"libcontainerd: new containerd process, pid: 2393"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain dockerd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2390")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" time"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018-08-31T01:47:26.204103195+08:00"')]),s._v(" level"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("error msg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[graphdriver] prior storage driver overlay2 failed: driver not supported"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain dockerd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2390")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Error starting daemon"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" error initializing graphdriver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" driver "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" supported\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain systemd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" main "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("process")]),s._v(" exited"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" code"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exited"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("FAILURE\n          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("月 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" localhost"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("localdomain systemd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Failed "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" start Docker Application Container Engine"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("错误原因：error initializing graphdriver: driver not supported")]),s._v(" "),t("p",[s._v("解决办法：在 "),t("code",[s._v("/etc/docker")]),s._v(" 目录下创建daemon.json文件，并且加入以下配置")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" daemon.json\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" daemon.json\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-opts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2.override_kernel_check=true"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("再次启动："),t("code",[s._v("systemctl start docker")])]),s._v(" "),t("h4",{attrs:{id:"docker-runc-not-installed-on-system-问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-runc-not-installed-on-system-问题"}},[s._v("#")]),s._v(" docker-runc not installed on system 问题")]),s._v(" "),t("p",[s._v("问题描述")]),s._v(" "),t("p",[s._v("docker运行镜像的时候，报错如下： (如果报错端口映射的错误，那就先不映射端口直接启动镜像，试一下是不是这个错误，因为如果直接映射端口启动镜像的话，这个错误导致容器启动失败，但是报错是端口映射失败)")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nn0 k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it registry.helloworld.com/test/atsd:latest bash")]),s._v("\nWARNING: IPv4 forwarding is disabled. Networking will not work.\n/usr/bin/docker-current: Error response from daemon: shim error: docker-runc not installed on system.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("问题解决：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nn0 k8s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/libexec/docker/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nn0 docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -s docker-runc-current docker-runc")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"job-for-docker-service-failed-because-the-control-process-exited-with-error-code"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#job-for-docker-service-failed-because-the-control-process-exited-with-error-code"}},[s._v("#")]),s._v(" Job for docker.service failed because the control process exited with error code.")]),s._v(" "),t("p",[t("strong",[s._v("首先查看一下内核版本")])]),s._v(" "),t("p",[s._v("因为使用命令: yum install docker下载时, 默认下载的是Docker的最新版本, 但是内核版本低的话可能不兼容新版本Docker, 所以有可能出现如上错误")]),s._v(" "),t("p",[s._v("首先要来验证CentOS 版本是否支持 Docker，Docker 要求 CentOS 系统的内核版本高于 3.10")]),s._v(" "),t("p",[s._v("通过 uname -r 命令查看你当前的内核版本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -r")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-123.el7.x86_64\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("方案一、内核版本过低")])]),s._v(" "),t("p",[s._v("1.将以前下载好的Docker卸载干净，使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum remove docker-*\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-client-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-common "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-latest-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-engine-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" docker-engine\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("2.更新改linux系统的内核版本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum update\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("建议更新完之后, 重启一下系统")]),s._v(" "),t("p",[s._v("3.继续下载安装docker(尽量使用高级管理员权限下载)使用如下命令")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" dacker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("4.使用如下命令启动docker")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("systemctl start docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("问题解决!\n如果这样安装完之后还报错, 按照这个步骤再来一遍即可")]),s._v(" "),t("p",[s._v("如果方案一不能解决，请向下继续阅读，根据场景选择解决方式")]),s._v(" "),t("p",[t("em",[t("strong",[s._v("*方案二、检查配置文件是否错误*")])])]),s._v(" "),t("p",[s._v("检查一下配置文件，使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysconfig/docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("em",[t("strong",[s._v("*方案三、检查daemon.json文件是否错误*")])])]),s._v(" "),t("p",[s._v("检查一下daemon.json文件，使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("检查以下内容是否存在，如果没有则加入文件中（注意引号和冒号的输入格式是否为英文）：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/mnt/docker-data"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"storage-driver"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[t("em",[s._v("*")]),s._v("***方案四、****删除 "),t("code",[s._v("/var/lib/docker")]),s._v(" 目录*")]),s._v("*")]),s._v(" "),t("p",[s._v("删除 /var/lib/docker 目录")]),s._v(" "),t("p",[s._v("重启 daemon")]),s._v(" "),t("p",[s._v("重启 docker")]),s._v(" "),t("p",[s._v("使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" docker restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[t("em",[s._v("*")]),s._v("***方案五、安装 "),t("code",[s._v("docker-io-selinux")]),s._v("*****")]),s._v("*")]),s._v(" "),t("p",[s._v("安装 docker-io-selinux")]),s._v(" "),t("p",[s._v("重启 daemon")]),s._v(" "),t("p",[s._v("重启 docker")]),s._v(" "),t("p",[s._v("使用如下命令：")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-io-selinux\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" docker restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("em",[t("strong",[s._v("*方案六、重新安装Docker*")])])]),s._v(" "),t("p",[s._v("如果以上方案都没有解决你的问题，笔者建议按照步骤重新安装一下Docker,注意不要疏漏。")])])}),[],!1,null,null,null);a.default=e.exports}}]);