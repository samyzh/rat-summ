(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1364:function(s,a,t){s.exports=t.p+"assets/img/image-20220217165838873.d463a12d.png"},1365:function(s,a,t){s.exports=t.p+"assets/img/1670015-20210420193816196-574842230.50b25d9f.png"},1366:function(s,a,t){s.exports=t.p+"assets/img/image-20220218193803056.c1935785.png"},1367:function(s,a,t){s.exports=t.p+"assets/img/image-20220217151613594.6051e479.png"},1368:function(s,a,t){s.exports=t.p+"assets/img/image-20220217152913582.668d3811.png"},1369:function(s,a,t){s.exports=t.p+"assets/img/image-20220310202234930.21c877d2.png"},1370:function(s,a,t){s.exports=t.p+"assets/img/image-20220310202517879.d8a529db.png"},1371:function(s,a,t){s.exports=t.p+"assets/img/image-20220311092726152.ded83c59.png"},2163:function(s,a,t){"use strict";t.r(a);var n=t(14),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("简介")]),s._v(" "),n("p",[n("strong",[s._v("MySQL5.7 和以前版本不同点：")])]),s._v(" "),n("p",[s._v("*"),n("strong",[s._v("1.初始化工具不同*")])]),s._v(" "),n("p",[s._v("MySQL5.6.xx使用的是mysql_install_db，MySQL5.7.6+官方推荐使用mysqld –initialize。")]),s._v(" "),n("p",[n("em",[n("strong",[s._v("2.初始化数据库不同")])])]),s._v(" "),n("p",[s._v("MySQL5.6.xx初始化之后存在mysql,information_schema,performance_schema,test四个数据库，MySQL5.7.6+初始化之后存在mysql,information_schema,performance_schema,sys四个数据库。")]),s._v(" "),n("p",[n("strong",[s._v("3.初始化用户不同")])]),s._v(" "),n("p",[s._v("MySQL5.6.xx初始化之后存在root@localhost,root@'::1',root@'hostname',''@'localhost',''@'hostname'五个用户，MySQL5.7.6+初始化之后存在mysql.sys,root@localhost用户")]),s._v(" "),n("p",[n("em",[n("strong",[s._v("4.初始化root密码")])])]),s._v(" "),n("p",[s._v("MySQL5.6.xx初始化之后root用户密码为空，MySQL5.7.6+初始化之后会为root@localhost用户生成随机密码。")]),s._v(" "),n("h2",{attrs:{id:"安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),n("h3",{attrs:{id:"在线安装【推荐】"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在线安装【推荐】"}},[s._v("#")]),s._v(" 在线安装【推荐】")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装mysql安装源")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://repo.mysql.com//mysql57-community-release-el7-11.noarch.rpm\nyum -y localinstall mysql57-community-release-el7-11.noarch.rpm \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装MySQL")]),s._v("\nyum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-community-server\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个配置在线安装太慢了； 要搞成本地源安装；")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#优化后；")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -Uvh https://repo.mysql.com//mysql57-community-release-el7-11.noarch.rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" yum -y "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-community-server\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -rf /srv/app/soft/mysql/my.cnf /etc/my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("systemctl start mysqld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机启动")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld\nsystemctl daemon-reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("也是跟下面安装源码的包一样；")]),s._v(" "),n("p",[n("img",{attrs:{src:t(1364),alt:"image-20220217165838873"}})]),s._v(" "),n("h3",{attrs:{id:"rpm方式安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rpm方式安装"}},[s._v("#")]),s._v(" rpm方式安装")]),s._v(" "),n("h4",{attrs:{id:"卸载mariadb"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#卸载mariadb"}},[s._v("#")]),s._v(" "),n("strong",[s._v("卸载mariadb")])]),s._v(" "),n("p",[s._v("检查是否安装了mariadb（CentOS7默认安装），如存在则卸载mariadb；如果你是CentOS6，则默认是MySQL，那么你就卸载MySQL即可；删除CentOS7自带的mariadb数据库")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e --nodeps mariadb-libs  marisa\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mariadb\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e mariadb-libs-5.5.68-1.el7.x86_64 --nodeps\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[n("img",{attrs:{src:t(1365),alt:"img"}})]),s._v(" "),n("h4",{attrs:{id:"安装所需依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装所需依赖"}},[s._v("#")]),s._v(" 安装所需依赖")]),s._v(" "),n("p",[s._v("一般都是最新版了，以防万一后面安装出错，缺少依赖")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y libaio  net-tools numactl\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h4",{attrs:{id:"安装mysql包并启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql包并启动"}},[s._v("#")]),s._v(" 安装MySQL包并启动")]),s._v(" "),n("p",[s._v("下载："),n("code",[s._v("wget http://dev.mysql.com/get/mysql-5.7.35-1.el7.x86_64.rpm-bundle.tar")])]),s._v(" "),n("p",[n("strong",[s._v("安装：")])]),s._v(" "),n("p",[s._v("安装时必须严格遵守安装顺序 "),n("strong",[s._v("依赖关系依次为 common → libs → client → server")])]),s._v(" "),n("p",[n("strong",[s._v("注：ivh中， i-install安装；v-verbose进度条；h-hash哈希校验")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-common-5.7.35-1.el7.x86_64.rpm\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-libs-5.7.35-1.el7.x86_64.rpm \n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-client-5.7.35-1.el7.x86_64.rpm\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-server-5.7.35-1.el7.x86_64.rpm\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装后查询安装的MySQL版本")]),s._v("\n mysqladmin --version\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("统一封装：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# install mysql")]),s._v("\nRUN yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y libaio  net-tools numactl\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# RUN wget http://dev.mysql.com/get/mysql-5.7.35-1.el7.x86_64.rpm-bundle.tar \\")]),s._v("\nRUN "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /srv/app/soft/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf mysql-5.7.35.tar.gz "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" mysql-5.7.35 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-common-5.7.35-1.el7.x86_64.rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-libs-5.7.35-1.el7.x86_64.rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-client-5.7.35-1.el7.x86_64.rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh mysql-community-server-5.7.35-1.el7.x86_64.rpm\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[n("strong",[s._v("默认安装位置")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("/var/lib/mysql/         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据库目录")]),s._v("\n/usr/share/mysql        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置文件目录")]),s._v("\n/usr/bin                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#相关命令目录")]),s._v("\n/etc/init.d/mysql       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动脚本")]),s._v("\n\n/var/lib/mysql/  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据文件：")]),s._v("\n/usr/share/mysql  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置文件模板：")]),s._v("\n/usr/bin mysql  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#客户端工具目录：")]),s._v("\n/var/log/  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志目录：")]),s._v("\n/tmp/ pid， "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sock文件目录：")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[n("img",{attrs:{src:t(1366),alt:"image-20220218193803056"}})]),s._v(" "),n("p",[s._v("创建及权限目录：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -s /sbin/nologin mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /var/lib/mysql/data\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R root /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql:mysql /var/lib/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql /var/lib/mysql/data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"初始化命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化命令"}},[s._v("#")]),s._v(" 初始化命令")]),s._v(" "),n("p",[n("code",[s._v("/etc/my.cnf")])]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For advice on how to change settings please see")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html")]),s._v("\n\n[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # and set to the amount of RAM for the most important data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb_buffer_pool_size = 128M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to turn on a very important data integrity option: logging")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# changes to the binary log between backups.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log_bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Remove leading # to set options mainly useful for reporting servers.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The server defaults are faster for transactions and fast SELECTs.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Adjust sizes as needed, experiment to find the optimal values.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# join_buffer_size = 128M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sort_buffer_size = 2M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read_rnd_buffer_size = 2M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("datadir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/lib/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/lib/mysql/mysql.sock")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Disabling symbolic-links is recommended to prevent assorted security risks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("symbolic-links")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log-error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/log/mysqld.log")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("pid-file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/run/mysqld/mysqld.pid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这部分是新加的内容；默认先跳过配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-grant-tables")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("character_set_server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("init_connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("'SET NAMES utf8mb4'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("lower_case_table_names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br")])]),n("h5",{attrs:{id:"初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[s._v("#")]),s._v(" 初始化")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/mysql/*\n\nmysqld --initialize --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql --basedir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--datadir=/var/lib/mysql/data/ ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化完成，并给root用户生成了临时密码，这里要把密码记录下来，稍后需要")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/log/mysqld.log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看临时密码")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#清理一下日志文件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("-"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/var/log/mysqld.log\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#service mysqld start")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysqld start --user root &\t")]),s._v("\nmysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#./support-files/mysql.server start")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h5",{attrs:{id:"启动及查询状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动及查询状态"}},[s._v("#")]),s._v(" "),n("strong",[s._v("启动及查询状态")])]),s._v(" "),n("p",[s._v("启动MySQL")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("mysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysqld_safe --defaults-file=/etc/my.cnf &")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或者 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysqld start\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此时可以通过ps -ef | grep mysql看到相关进程")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询MySQL在系统的状态")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-8-15-centos ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl status mysqld")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动MySQL数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-8-15-centos ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl start mysqld")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭MySQL数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-8-15-centos ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop mysqld")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启MySQL数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-8-15-centos ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl restart mysqld")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看MySQL进程")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-8-15-centos ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef | grep mysql")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h5",{attrs:{id:"sql脚本操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql脚本操作"}},[s._v("#")]),s._v(" "),n("strong",[s._v("sql脚本操作")])]),s._v(" "),n("p",[s._v("设置密码")]),s._v(" "),n("div",{staticClass:"language-mysql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mysql -uroot –p\nSET PASSWORD = PASSWORD('123456');    #设置密码为123456\nexit\n\nmysql -uroot -p123456xxx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("设置允许 root 从任意 ip 登陆; 允许远程登陆")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("uroot "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#create user root@'192.168.0.2' identified by '123456';")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#grant all privileges on databas_name.* to root@'192.168.0.2';")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ALTER USER 'root'@'192.168.0.2' IDENTIFIED WITH mysql_native_password BY '123456';")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# select host,user from user;修改了密码，这里不做查询处理；要不然会报错提示；")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 原值为localhost")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#亦可使用：【推荐用这个脚本】")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#set password for root@localhost = password('root123xx');")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root123xx'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTION")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root123xx'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTION")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其中 “ *.* ” 代表所有资源所有权限， “ 'root'@% ” 其中 root 代表账户名，% 代表所有的访问地址，也可以使用一个唯一的地址进行替换，只有一个地址能够访问。如果是某个网段的可以使用地址与%结合的方式，如 10.0.42.%。IDENTIFIED BY 'root'，这个 root 是指访问密码。WITH GRANT OPTION 允许级联授权。")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[n("strong",[s._v("优化简写：")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[s._v("mysql\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" authentication_string"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root123'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("屏蔽跳过密码后，重启后;")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭")]),s._v("\nsystemctl stop mysqld.service\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改完毕密码后，需要把免密码认证取消：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/my.cnf\nskip-grant-tables这一行注释掉\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#systemctl start mysqld.service")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("再次设置远程连接登录；")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("host "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@localhost")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root-123'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" identified "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root-123'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" identified "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root-123'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("脚本设置处理；")]),s._v(" "),n("h5",{attrs:{id:"编码查询"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编码查询"}},[s._v("#")]),s._v(" 编码查询")]),s._v(" "),n("p",[s._v("查看字符集和数据文件位置")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("show variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%collation%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nshow variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%char%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nshow variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%dir%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"docker内部源码安装【重要】"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker内部源码安装【重要】"}},[s._v("#")]),s._v(" docker内部源码安装【重要】")]),s._v(" "),n("h5",{attrs:{id:"源码安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#源码安装"}},[s._v("#")]),s._v(" 源码安装")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v("RUN yum install "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("y libaio  net"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tools numactl\nRUN useradd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("s /sbin/nologin mysql \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" mkdir "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("p /var/lib/mysql/data \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" chown "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R root /var/lib/mysql \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" chown "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql /var/lib/mysql \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" chown "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("R mysql /var/lib/mysql/data\n\nRUN cd /srv/app/soft/mysql \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" tar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("zxvf mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35.tar.gz \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" cd mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35 \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ivh mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("community"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("common"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("1.el7.x86_64.rpm \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ivh mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("community"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("libs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("1.el7.x86_64.rpm \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ivh mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("community"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("1.el7.x86_64.rpm \\\n  "),n("span",{pre:!0,attrs:{class:"token important"}},[s._v("&&")]),s._v(" rpm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("ivh mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("community"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("5.7.35"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("1.el7.x86_64.rpm\nRUN cp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("rf /srv/app/soft/mysql/my.cnf /etc/my.cnf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h5",{attrs:{id:"启动及初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动及初始化"}},[s._v("#")]),s._v(" 启动及初始化")]),s._v(" "),n("p",[n("code",[s._v("entrypoint.sh")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/mysql/* "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" mysqld --initialize --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql --basedir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql\nmysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /var/log/mysqld.log | grep password")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 第二种替换方案；后面就不用sed替换了；【确保my.cnf中的配置修改没有设置跳过设置】")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqld --defaults-file=/etc/my.cnf --user root --skip-grant-tables & ")]),s._v("\nmysql -uroot mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /srv/app/soft/mysql/setpwd.sql\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{print "kill -9",'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/\\(skip-grant-tables\\).*/#skip-grant-tables/"')]),s._v(" /etc/my.cnf\nmysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" \n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# netstat -antlp")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 核心：--connect-expired-password")]),s._v("\nmysql -uroot -prootxxx --connect-expired-password mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /srv/app/soft/mysql/init.sql\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Please use --connect-expired-password option or invoke mysql in interactive mode.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -uroot -pxxxxx2 &&  source /srv/app/soft/mysql/init.sql")]),s._v("\n\nmysql -uroot -pxxxxx2 mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /srv/app/soft/mysql/dataportal.sql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h5",{attrs:{id:"相关脚本及配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相关脚本及配置"}},[s._v("#")]),s._v(" 相关脚本及配置")]),s._v(" "),n("p",[n("code",[s._v("setpwd.sql")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 初始化脚本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- show databases;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- mysqladmin -uroot -p create dataportal ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- create database dataportal default character set utf8mb4 collate utf8mb4_unicode_ci;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" authentication_string"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rootxxx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[n("code",[s._v("init.sql")])]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 初始化脚本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@localhost")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxxx2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" identified "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxxx2'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" identified "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxxx2'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[n("code",[s._v("my.cnf")])]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("datadir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/lib/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("socket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/lib/mysql/mysql.sock")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("symbolic-links")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log-error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/log/mysqld.log")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("pid-file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/var/run/mysqld/mysqld.pid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#默认先跳过配置")]),s._v("\nskip-grant-tables\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("character_set_server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("init_connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("'SET NAMES utf8mb4'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("lower_case_table_names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h3",{attrs:{id:"源码安装-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#源码安装-2"}},[s._v("#")]),s._v(" 源码安装")]),s._v(" "),n("blockquote",[n("p",[s._v("这边源码编译安装不推荐，编译安装时间时间很慢，直接rpm安装会快很多；")])]),s._v(" "),n("h4",{attrs:{id:"版本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#版本"}},[s._v("#")]),s._v(" 版本")]),s._v(" "),n("p",[n("strong",[s._v("下面使用mysql-boost5.7.30.tar.gz进行安装，选择源码Source Code，选择带Boost的版本")]),s._v("，点击Download开始下载。")]),s._v(" "),n("p",[s._v("注：Mysql5.7版本更新后有很多变化，连编译安装都有变化，而MySQL5.7的安装必须要boost库，不过MySQL的官网源码有带boost库的源码和不带boost库的源码两种，因此有两种安装方式，其实都是一样的，如果选择不带boost库源码的需要在安装MySQL之前单独安装boost，并在编译时指定boost的安装目录，选择带boost的版本，则不需要提前安装boost，只需要在cmake编译时带上参数-DWITH_BOOST=boost即可。")]),s._v(" "),n("p",[s._v("从 MySQL 5.7.5 开始 Boost 库是必需的，mysql 源码中用到了 C++的 Boost 库，要求必须安装 boost1.59.0 或以上版本, 这个选择源码安装;")]),s._v(" "),n("p",[n("img",{attrs:{src:t(1367),alt:"image-20220217151613594"}})]),s._v(" "),n("p",[s._v("删除CentOS7自带的mariadb数据库")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e --nodeps mariadb-libs\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e --nodeps marisa\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"安装依赖"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[s._v("#")]),s._v(" 安装依赖")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y libaio cmake gcc-c++ bison-devel  ncurses-devel  bison perl perl-devel  perl perl-devel \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("安装 libaio， libaio 包的作用是为了支持同步I/O，对于数据库之类的系统特别重要。")]),s._v(" "),n("p",[s._v("安装 cmake，CMake是一个跨平台的安装（编译）工具。")]),s._v(" "),n("h4",{attrs:{id:"编译安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#编译安装"}},[s._v("#")]),s._v(" 编译安装")]),s._v(" "),n("p",[n("strong",[s._v("解压安装包")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf mysql-boost5.7.30.tar.gz\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加mysql组及用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#groupadd mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#useradd -r -g mysql mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -s /sbin/nologin mysql\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/mysql/data\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R root /usr/local/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql:mysql /usr/local/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql /usr/local/mysql/data\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/resource/mysql-5.7.30\n\ncmake -DCMAKE_INSTALL_PREFIX"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql -DMYSQL_DATADIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data -DSYSCONFDIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc -DWITH_BOOST"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("boost -DWITH_MYISAM_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_INNOBASE_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_MEMORY_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_READLINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DMYSQL_UNIX_ADDR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock -DMYSQL_TCP_PORT"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -DENABLED_LOCAL_INFILE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_PARTITION_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DEXTRA_CHARSETS"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("all -DDEFAULT_CHARSET"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8 -DDEFAULT_COLLATION"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8_general_ci\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("这里再写一份换行版方便查看参数，执行时选择上面这行命令")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("cmake "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DCMAKE_INSTALL_PREFIX"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DMYSQL_DATADIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DSYSCONFDIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DWITH_BOOST"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("boost\n-DWITH_MYISAM_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DWITH_INNOBASE_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DWITH_MEMORY_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DWITH_READLINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DMYSQL_UNIX_ADDR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DMYSQL_TCP_PORT"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DENABLED_LOCAL_INFILE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DWITH_PARTITION_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DEXTRA_CHARSETS"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("all "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DDEFAULT_CHARSET"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-DDEFAULT_COLLATION"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8_general_ci\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("cmake参数解释如下：")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("DCMAKE_INSTALL_PREFIX=/usr/local/mysql:安装路径")])]),s._v(" "),n("li",[n("p",[s._v("DMYSQL_DATADIR=/data/mysql:数据文件存放位置")])]),s._v(" "),n("li",[n("p",[s._v("DSYSCONFDIR=/etc:my.cnf路径")])]),s._v(" "),n("li",[n("p",[s._v("DWITH_MYISAM_STORAGE_ENGINE=1:支持MyIASM引擎")])]),s._v(" "),n("li",[n("p",[s._v("DWITH_INNOBASE_STORAGE_ENGINE=1:支持InnoDB引擎")])]),s._v(" "),n("li",[n("p",[s._v("DMYSQL_UNIX_ADDR=/data/mysql/mysqld.sock:连接数据库socket路径")])]),s._v(" "),n("li",[n("p",[s._v("DMYSQL_TCP_PORT=3306:端口")])]),s._v(" "),n("li",[n("p",[s._v("DENABLED_LOCAL_INFILE=1:允许从本地导入数据")])]),s._v(" "),n("li",[n("p",[s._v("DWITH_PARTITION_STORAGE_ENGINE=1:安装支持数据库分区")])]),s._v(" "),n("li",[n("p",[s._v("DEXTRA_CHARSETS=all:安装所有的字符集")])]),s._v(" "),n("li",[n("p",[s._v("DDEFAULT_CHARSET=utf8:默认字符")])]),s._v(" "),n("li",[n("p",[s._v("DWITH_EMBEDDED_SERVER=1:嵌入式服务器")])])]),s._v(" "),n("h4",{attrs:{id:"配置初始化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置初始化"}},[s._v("#")]),s._v(" 配置初始化")]),s._v(" "),n("p",[n("strong",[s._v("设置全局命令")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/mysql/bin/mysqld /usr/bin/mysqld\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/mysql/bin/mysql /usr/bin/mysql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("也可以设置；\n在/etc/profile 中新增一行")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/bin:"),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("strong",[s._v("配置文件")])]),s._v(" "),n("p",[s._v("配置自定义"),n("code",[s._v("my.cnf")])]),s._v(" "),n("p",[s._v("修改点；可以用默认的；"),n("code",[s._v("cp /usr/local/mysql/support-files/my-default.cnf /etc/my.cnf")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(1368),alt:"image-20220217152913582"}})]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[client]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("port")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("socket")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/tmp/mysql.sock")]),s._v("\n\n[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("port")]),s._v("        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("socket")]),s._v("      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/tmp/mysql.sock")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("user")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("mysql")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("basedir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/usr/local/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("datadir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/data/mysql/data #/usr/local/mysql/data TODO")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("pid-file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/data/mysql/mysql.pid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log_error")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/data/mysql/mysql-error.log")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("slow_query_log")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("long_query_time")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("slow_query_log_file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/data/mysql/mysql-slow.log")]),s._v("\n\nskip-external-locking\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("key_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("32M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("max_allowed_packet")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1024M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("table_open_cache")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("128")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("sort_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("768K")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("net_buffer_length")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("8K")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("read_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("768K")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("read_rnd_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("512K")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("myisam_sort_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("8M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("thread_cache_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("16")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("query_cache_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("16M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("tmp_table_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("32M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("performance_schema_max_table_instances")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("explicit_defaults_for_timestamp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-networking")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("max_connections")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("500")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("max_connect_errors")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("100")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("open_files_limit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("65535")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log_bin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("mysql-bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("binlog_format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("mixed")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("server_id")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("232")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("expire_logs_days")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("early-plugin-load")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v('""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("default_storage_engine")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("InnoDB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_file_per_table")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_buffer_pool_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("128M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_log_file_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("32M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_log_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("8M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_flush_log_at_trx_commit")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("innodb_lock_wait_timeout")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("50")]),s._v("\n\n[mysqldump]\nquick\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("max_allowed_packet")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("16M")]),s._v("\n\n[mysql]\nno-auto-rehash\n\n[myisamchk]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("key_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("32M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("sort_buffer_size")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("768K")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("read_buffer")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2M")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("write_buffer")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2M")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br")])]),n("p",[s._v("修改常用的配置：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/my.cnf\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("datadir")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql_mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES\nsymbolic-links"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_connections")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_file_per_table")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#表名大小写不明感，敏感为")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lower_case_table_names")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("skip-grant-tables\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("character_set_server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("init_connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("'SET NAMES utf8mb4'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("lower_case_table_names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("初始化MySQL")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化MySQL")]),s._v("\nmysqld --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql --basedir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql --datadir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data/ --initialize\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#初始化完成，并给root用户生成了临时密码，这里要把密码记录下来，稍后需要")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/log/mysqld.log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看临时密码")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化MySQL，切记--defaults-file=/etc/my.cnf要放在参数的第一位，初始化信息可以在MySQL的errorlog中查看，并且在errorlog会生成一个root的随机密码，该随机密码仅仅为root@localhost用户所有。")]),s._v("\n./mysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --initialize --basedir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/web/mysql --datadir"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/mysql/data  --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[n("strong",[s._v("设置密码再打开验证")])]),s._v(" "),n("p",[s._v("修改完毕密码后，需要把免密码认证取消：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("update mysql.user "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("authentication_string")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" where "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/my.cnf\nskip-grant-tables这一行注释掉\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("查看目前 mysql 字符集")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#支持的所有的字符集")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SHOW CHARACTER SET"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SHOW CHARACTER SET LIKE "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'latin%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看默认字符集")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'collation_%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show variables like "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'character_set_%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"设置服务启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置服务启动"}},[s._v("#")]),s._v(" "),n("strong",[s._v("设置服务启动")])]),s._v(" "),n("blockquote",[n("p",[s._v("可选命令步骤; "),n("strong",[s._v("添加 MySQL 服务到 systemd")])])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#授予可执行的权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/init.d/mysqld\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置为开机启动")]),s._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("检查是否启动；")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动MySQL")]),s._v("\nmysqld_safe --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者 service mysqld start")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysqld start --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看全部端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -antlp\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h4",{attrs:{id:"连接配置权限"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#连接配置权限"}},[s._v("#")]),s._v(" "),n("strong",[s._v("连接配置权限")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cd /usr/local/mysql/bin")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输入刚刚的密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#./mysql -u root -p  ")]),s._v("\nmysql -u root -p  \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改MySQL用户root的密码为root")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root@localhost "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#赋予权限并设置可以远程访问")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" GRANT ALL PRIVILEGES ON *.* TO "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED BY "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" WITH GRANT OPTION"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#刷新权限")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" FLUSH PRIVILEGES"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看权限")]),s._v("\nmysql"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" user,host from mysql.user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"封装成docker方式安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#封装成docker方式安装"}},[s._v("#")]),s._v(" 封装成docker方式安装")]),s._v(" "),n("p",[n("code",[s._v("Dockerfile")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("RUN "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" /install_mysql.sh "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 触发安装脚本")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("code",[s._v("install_mysql.sh")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e --nodeps mariadb-libs\nyum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y cmake gcc gcc-c++ bison bison-devel ncurses  ncurses-devel perl perl-devel libaio cmake\n\n"),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("pkgName")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql-5.7.35.tar.gz"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# useradd -M -s /sbin/nologin mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" -r -g mysql mysql\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/mysql/data\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R root /usr/local/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql:mysql /usr/local/mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R mysql /usr/local/mysql/data\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir -p /mysql/data")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R   mysql:mysql   /usr/local/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown -R   mysql.mysql   /srv/dataIno/mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod 750  /mysql/data")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /srv/app/soft/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf  mysql-5.7.35.tar.gz "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" mysql-5.7.35 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" cmake -DCMAKE_INSTALL_PREFIX"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql -DMYSQL_DATADIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/data -DSYSCONFDIR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc -DWITH_BOOST"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("boost -DWITH_MYISAM_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_INNOBASE_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_MEMORY_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_READLINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DMYSQL_UNIX_ADDR"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql/mysql.sock -DMYSQL_TCP_PORT"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -DENABLED_LOCAL_INFILE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DWITH_PARTITION_STORAGE_ENGINE"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -DEXTRA_CHARSETS"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("all -DDEFAULT_CHARSET"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4 -DDEFAULT_COLLATION"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4_general_ci "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/mysql/bin/mysqld /usr/bin/mysqld\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /usr/local/mysql/bin/mysql /usr/bin/mysql\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /usr/local/mysql/bin && ./mysqld --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data/ --initialize")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# set password for root@localhost = password('x x');")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FLUSH PRIVILEGES;")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# select user,host from mysql.user;")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器内部启动")]),s._v("\nmysqld start --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\t\nmysqladmin -u root -p "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("h3",{attrs:{id:"docker容器安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#docker容器安装"}},[s._v("#")]),s._v(" docker容器安装")]),s._v(" "),n("h4",{attrs:{id:"启动容器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("docker run -p "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 --name mysql-test "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/log:/var/log/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /mydata/mysql/conf:/etc/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-v /etc/mysql:/etc/mysql/conf.d")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#-v $PWD/data:/var/lib/mysql")]),s._v("\n-e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root123 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-d mysql:5.7\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若未成功可能为权限问题导致，运行 su root 提升至管理员权限")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 3306:3306:    将容器的3306端口映射到主机的3306端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v /mydata/mysql/log:/var/log/mysql    将日志文件夹挂在到主机")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v /mydata/mysql/data:/var/lib/mysql    将配置文件夹挂在到主机")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -v /mydata/mysql/conf:/etc/mysql    将配置文件夹挂载到主机")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -e MYSQL_ROOT_PASSWORD=root123    初始化root用户的密码； 设置环境变量，这里设置的是root密码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d mysql：5.7    以后台方式运行")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认的配置文件位置为/etc/mysql/my.cnf，自定义的配置文件位置可以为/etc/mysql/conf.d或/etc/mysql/mysql.conf.d，因此将宿主机的/etc/mysql挂载到容器的/etc/mysql/conf.d，MySQL会自动合并默认的配置文件/etc/mysql/my.cnf与自定义的配置文件（这里是/etc/mysql/conf.d/my.cnf）。")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("###################################")]),s._v("\n\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mysql-test /bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("database")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./mysql/\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysqld "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("user=root "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("verbose\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always \n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_DATABASE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"web_level3_sqli"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_USER")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"web_level3_sqli"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thisisasecurepassword123"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_ALLOW_EMPTY_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h4",{attrs:{id:"开机自启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开机自启动"}},[s._v("#")]),s._v(" 开机自启动")]),s._v(" "),n("p",[s._v("管理员权限运行命令")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("#sudo docker run "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mypassword "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("to"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("directory"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d mysql\ndocker update mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("restart"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"修改mysql配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改mysql配置"}},[s._v("#")]),s._v(" 修改MySQL配置")]),s._v(" "),n("p",[s._v("将拉丁编码修改为utf8编码")]),s._v(" "),n("p",[s._v("在cmd中输入命令 "),n("code",[s._v("vi /mydata/mysql/conf/my.cnf")])]),s._v(" "),n("p",[s._v("在 "),n("code",[s._v("my.cnf")]),s._v(" 中添加")]),s._v(" "),n("div",{staticClass:"language-properties line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-properties"}},[n("code",[s._v("[client]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("default-character-set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n\n[mysql]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("default-character-set")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n\n[mysqld]\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("init_connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("'SET collation_connection = utf8mb4_unicode_ci'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("init_connect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("'SET NAMES utf8mb4'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("character-set-server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("collation-server")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("utf8mb4_unicode_ci")]),s._v("\nskip-character-set-client-handshake\n"),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("skip-name-resolve")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("               ")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("运行命令"),n("code",[s._v("docker restart mysql")]),s._v(" 重启mysql服务;")]),s._v(" "),n("h4",{attrs:{id:"初始化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#初始化-2"}},[s._v("#")]),s._v(" 初始化")]),s._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看一下原来容器的字符集")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" variables "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%character%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#登录mysql及修改密码")]),s._v("\nmysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#授权")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("‘你的密码’"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("；\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" mysql\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" ‘root’@’"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("’ identified "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" ‘root’ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("option")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加远程登录用户")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'samy'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),s._v(" IDENTIFIED "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" mysql_native_password "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GRANT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALL")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIVILEGES")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'samy'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'%'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h4",{attrs:{id:"启动相关参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动相关参数"}},[s._v("#")]),s._v(" 启动相关参数")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("MYSQL_ROOT_PASSWORD\n该变量是强制性的，并指定将为MySQL root超级用户帐户设置的密码。在上面的例子中，它被设置为my-secret-pw。")])]),s._v(" "),n("li",[n("p",[s._v("MYSQL_DATABASE\n此变量是可选的，并允许您指定要在映像启动时创建的数据库的名称。如果提供了用户/密码（见下文），那么该用户将被授予对该数据库的超级用户访问（对应于GRANT ALL）。")])]),s._v(" "),n("li",[n("p",[s._v("MYSQL_USER， MYSQL_PASSWORD\n这些变量是可选的，可用于创建新用户并设置该用户的密码。该用户将被授予超级用户权限（见上文），该权限由MYSQL_DATABASE变量指定。这两个变量都是创建用户所必需的。")])]),s._v(" "),n("li",[n("p",[s._v("请注意，不需要使用此机制来创建超级用户的root用户，该用户默认情况下会使用MYSQL_ROOT_PASSWORD变量指定的密码创建。")])]),s._v(" "),n("li",[n("p",[s._v("MYSQL_ALLOW_EMPTY_PASSWORD\n这是一个可选变量。设置为yes允许容器以root用户的空密码启动。注意：yes除非您真的知道您在做什么，否则不要将此变量设置为“不推荐”，因为这将使您的MySQL实例完全不受保护，从而允许任何人获得完整的超级用户访问权限。")])]),s._v(" "),n("li",[n("p",[s._v("MYSQL_RANDOM_ROOT_PASSWORD\n这是一个可选变量。设置yes为为root用户（使用pwgen）生成随机初始密码。生成的root密码将打印到stdout（GENERATED ROOT PASSWORD: .....）。")])]),s._v(" "),n("li",[n("p",[s._v("MYSQL_ONETIME_PASSWORD\n一旦初始化完成，将root用户（不是用户指定的用户MYSQL_USER）设置为已过期，强制首次登录时更改密码。注：该功能仅在MySQL 5.6+上受支持。在MySQL 5.5上使用此选项将在初始化期间引发相应的错误。")])])]),s._v(" "),n("h3",{attrs:{id:"mac-dmg-安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mac-dmg-安装"}},[s._v("#")]),s._v(" Mac dmg 安装")]),s._v(" "),n("h4",{attrs:{id:"安装步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装步骤"}},[s._v("#")]),s._v(" 安装步骤")]),s._v(" "),n("p",[s._v("记下数据库临时密码，一路下一步完成安装;")]),s._v(" "),n("p",[n("img",{attrs:{src:t(1369),alt:"image-20220310202234930"}})]),s._v(" "),n("h4",{attrs:{id:"启动mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动mysql"}},[s._v("#")]),s._v(" 启动mysql")]),s._v(" "),n("blockquote",[n("h6",{attrs:{id:"两种启动-mysql-的方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#两种启动-mysql-的方式"}},[s._v("#")]),s._v(" 两种启动 mysql 的方式")])]),s._v(" "),n("p",[n("strong",[s._v("偏好设置下一键启动")])]),s._v(" "),n("p",[n("img",{attrs:{src:t(1370),alt:"image-20220310202517879"}})]),s._v(" "),n("p",[n("strong",[s._v("命令行启动")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" mysql.server start\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" mysql.server stop\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启MySQL服务")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" mysql.server restart\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看MySQL服务状态")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" mysql.server status\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#登陆MySQL完整指令")]),s._v("\nmysql -h "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 -P "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" -u root -p\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h4",{attrs:{id:"修改密码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改密码"}},[s._v("#")]),s._v(" 修改密码")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" mysql.server start\nmysql -u root -p\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1234'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("也可以直接用命令行修改：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("mysqladmin -u root -p password newpass\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("连接后，工具直接提示你修改新密码：")]),s._v(" "),n("p",[n("img",{attrs:{src:t(1371),alt:"image-20220311092726152"}})]),s._v(" "),n("p",[n("strong",[s._v("记住密码时修改密码")])]),s._v(" "),n("p",[s._v("如果你记得密码，登录之后，直接修改就可以了(root就是你的密码)\n"),n("code",[s._v("alter user root@localhost identified by 'root';")])]),s._v(" "),n("p",[n("strong",[s._v("没记住密码时修改密码")])]),s._v(" "),n("p",[s._v("a. 先停掉mysql的所有服务和进程")]),s._v(" "),n("p",[s._v("如果在偏好设置那里点击stop mysql没响应，可以直接kill掉，终端执行：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16034")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#此处16034是MySQL的进程pid（第二列数字）")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("b. 执行命令以安全模式启动MySQL")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/mysql/bin\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ./mysqld_safe --skip-grant-tables\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"配置变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置变量"}},[s._v("#")]),s._v(" 配置变量")]),s._v(" "),n("p",[n("code",[s._v("vim .bash_profile")]),s._v("或者"),n("code",[s._v("vim .zshrc")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(":/usr/local/mysql/bin\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(":/usr/local/mysql/support-files\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bash_profile\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\nmysql --version\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mysql")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/bin/mysql\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("mysqladmin")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/mysql/bin/mysqladmin\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),n("p",[s._v("在/etc 目录下新建 my.cnf 配置文件，并赋予读写权限;")]),s._v(" "),n("h2",{attrs:{id:"配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),n("h3",{attrs:{id:"配置防火墙"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置防火墙"}},[s._v("#")]),s._v(" 配置防火墙")]),s._v(" "),n("p",[s._v("设置3306端口开放")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[s._v("firewall"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("add"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("permanent\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("重启防火墙")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[s._v("firewall"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("看到success表示添加成功。")]),s._v(" "),n("p",[s._v("验证3306是否开放成功")]),s._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[s._v("firewall"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("query"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tcp\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"启动及关闭mysql-服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动及关闭mysql-服务"}},[s._v("#")]),s._v(" 启动及关闭mysql 服务")]),s._v(" "),n("p",[s._v("有两种方式，但必须组合使用，不能混用：")]),s._v(" "),n("ul",[n("li",[s._v("使用 systemctl （针对CentOS 7.0及以上版本，7.0 以下版本使用 service 命令）")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("systemctl start mysqld\nsystemctl stop mysqld\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("使用 mysql 程序自带的命令")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 由于云服务器默认root登陆，需要加上 --user root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# & 号表示后台运行，否则会阻塞")]),s._v("\nmysqld start --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\t\nmysqladmin -u root -p "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("MySQL启动和关闭命令总结")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#----启动MySQL")]),s._v("\nmysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --user root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker中rpm安装的用这个启动；")]),s._v("\nmysqld --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\nmysqld_safe --defaults-file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/my.cnf --user"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysql start\n/etc/init.d/mysql start\nmysqld_multi start "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多实例")]),s._v("\nnet start mysql "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Windows")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /var/log/mysqld.log "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看临时密码")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#----关闭MySQL")]),s._v("\nmysqladmin "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v(" -uroot -p "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#这种停止，修改密码后停止有问题；该用后面的直接杀死处理；")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysqladmin shutdown -uroot -p -S /var/lib/mysql/mysql.sock ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" -v "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{print "kill -9",'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v("}'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#[推荐]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" mysql stop\n/etc/init.d/mysql stop\nmysqld_multi stop "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多实例")]),s._v("\nnet stop mysql "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Windows")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#--杀死mysql")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("killall")]),s._v(" mysqld\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("killall")]),s._v(" -9 mysqld\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" -9 mysqld\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看全部端口")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -antlp\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysqld\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br")])]),n("p",[n("strong",[s._v("监控服务mysql是否启动")])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#while ! nslookup mysql-0 > /dev/null || ! nc -w1 mysql-0 3306 > /dev/null; do")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nslookup")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" .Values.wdpserver.mysqlName "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("nc")]),s._v(" -w1 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" .Values.wdpserver.mysqlName "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" .Values.wdpserver.mysqlPort "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    tput cuu1\n    "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"['),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'+%Y-%m-%d %H:%M:%S'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('] [INFO] Waiting for WDP to Come up!"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"['),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'+%Y-%m-%d %H:%M:%S'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('] [INFO] Mysql is up, Will be starting WDP"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/docker-library/mysql/blob/master/5.7/Dockerfile.oracle",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方自定义容器实现"),n("OutboundLink")],1)]),s._v(" "),n("li",[s._v("https://www.cnblogs.com/louis-liu-oneself/p/13504270.html")]),s._v(" "),n("li",[s._v("https://wangyeyixia.com/article/35548.html")]),s._v(" "),n("li",[s._v("安装过程\n"),n("ul",[n("li",[s._v("http://blog.csdn.net/sungsasong/article/details/76278361")]),s._v(" "),n("li",[s._v("https://segmentfault.com/a/1190000012099346")]),s._v(" "),n("li",[s._v("http://www.centoscn.com/mysql/2016/0315/6844.html")]),s._v(" "),n("li",[s._v("https://www.cnblogs.com/liqing1009/p/7879945.html")])])]),s._v(" "),n("li",[s._v("make && makeinstall 时报错参考：http://www.yunweijilu.com/index.php/home/index/article/aid/135")]),s._v(" "),n("li",[s._v("centos 7 防火墙设置参考 ：https://jingyan.baidu.com/article/adc81513944addf723bf73af.html")]),s._v(" "),n("li",[s._v("MySQL5.7初始密码查看及重置:http://blog.csdn.net/t1anyuan/article/details/51858911")]),s._v(" "),n("li",[s._v("源码安装后卸载再装：https://www.jianshu.com/p/e54ff5283f18")]),s._v(" "),n("li",[s._v("MySQL常见错误解决方法：http://www.360doc.com/content/15/0201/13/3200886_445438524.shtml")]),s._v(" "),n("li",[s._v("MYSQL MY.CNF 参数优化参考：http://www.cnblogs.com/yangchunlong/p/8478275.html")])])])}),[],!1,null,null,null);a.default=e.exports}}]);