(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1895:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),n("p",[s._v("Vue 框架通过"),n("strong",[s._v("数据双向绑定")]),s._v("和"),n("strong",[s._v("虚拟 DOM 技术")]),s._v("，帮我们处理了前端开发中最脏最累的 DOM 操作部分， 我们"),n("strong",[s._v("不再需要去考虑如何操作 DOM 以及如何最高效地操作 DOM")]),s._v("；但 Vue 项目中"),n("strong",[s._v("仍然存在项目首屏优化、Webpack 编译配置优化等问题")]),s._v("，所以我们仍然需要去关注 Vue 项目性能方面的优化，使项目具有更高效的性能、更好的用户体验。")]),s._v(" "),n("h2",{attrs:{id:"优化角度"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#优化角度"}},[s._v("#")]),s._v(" 优化角度")]),s._v(" "),n("h3",{attrs:{id:"运行时性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运行时性能优化"}},[s._v("#")]),s._v(" 运行时性能优化")]),s._v(" "),n("h4",{attrs:{id:"代码层面的优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码层面的优化"}},[s._v("#")]),s._v(" 代码层面的优化")]),s._v(" "),n("ul",[n("li",[s._v("data优化；不要将所有的数据放在data中，data中的数据都会增加getter和setter，会收集对应的watcher;")]),s._v(" "),n("li",[n("code",[s._v("v-if")]),s._v("当值为"),n("code",[s._v("false")]),s._v("时内部指令不会执行，具有阻断功能，很多情况下使用"),n("code",[s._v("v-if")]),s._v("替代"),n("code",[s._v("v-show")]),s._v(";、")]),s._v(" "),n("li",[s._v("合理使用"),n("code",[s._v("computed")]),s._v("、"),n("code",[s._v("watch")]),s._v("及方法；")]),s._v(" "),n("li",[n("code",[s._v("vue")]),s._v("在"),n("code",[s._v("v-for")]),s._v("时给每项元素绑定事件需要用事件代理；")]),s._v(" "),n("li",[n("code",[s._v("key")]),s._v("确保唯一性(默认"),n("code",[s._v("vue")]),s._v("采用就地复用策略);")]),s._v(" "),n("li",[s._v("长列表只显示的话，"),n("code",[s._v("Object.freeze")]),s._v("冻结数据；")]),s._v(" "),n("li",[n("code",[s._v("SPA")]),s._v("页面采用"),n("code",[s._v("keep-alive")]),s._v("缓存组件；")]),s._v(" "),n("li",[s._v("扁平化 Store 数据结构;")]),s._v(" "),n("li",[s._v("数据持久化的问题（防抖，节流）；")]),s._v(" "),n("li",[s._v("事件的销毁；")]),s._v(" "),n("li",[s._v("拆分组件(提高复用性、增加代码的可维护性、减少不必要的渲染)；")]),s._v(" "),n("li",[s._v("尽量采用runtime运行时版本；")])]),s._v(" "),n("h4",{attrs:{id:"webpack层面的优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack层面的优化"}},[s._v("#")]),s._v(" Webpack层面的优化")]),s._v(" "),n("p",[s._v("详见【webpack的配置及使用】中的优化介绍；")]),s._v(" "),n("blockquote",[n("h4",{attrs:{id:"打包优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包优化"}},[s._v("#")]),s._v(" 打包优化")])]),s._v(" "),n("ul",[n("li",[s._v("使用"),n("code",[s._v("cdn")]),s._v("的方式加载第三方模块，压缩大小；")]),s._v(" "),n("li",[s._v("多线程打包"),n("code",[s._v("happypack")]),s._v(";")]),s._v(" "),n("li",[n("code",[s._v("splitChunks")]),s._v("抽离公共文件；")]),s._v(" "),n("li",[n("code",[s._v("sourceMap")]),s._v("生成；")]),s._v(" "),n("li",[s._v("对于 Webpack4，打包项目使用 production 模式，这样会自动开启代码压缩")]),s._v(" "),n("li",[s._v("使用 ES6 模块来开启 tree shaking，这个技术可以移除没有使用的代码")]),s._v(" "),n("li",[s._v("优化图片，对于小图可以使用 base64 的方式写入文件中")]),s._v(" "),n("li",[s._v("按照路由拆分代码，实现按需加载")]),s._v(" "),n("li",[s._v("给打包出来的文件名添加哈希，实现浏览器缓存文件")])]),s._v(" "),n("h5",{attrs:{id:"开发环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发环境"}},[s._v("#")]),s._v(" 开发环境")]),s._v(" "),n("ul",[n("li",[s._v("HRM (热替换)")]),s._v(" "),n("li",[s._v("webpack-dev-server （本地服务器）")]),s._v(" "),n("li",[s._v("soure-map （调试）")]),s._v(" "),n("li",[s._v("webpack-bundle-analyzer（打包生成代码块分析视图）")]),s._v(" "),n("li",[s._v("size-plugin（监控打包资源的体积变量化）")]),s._v(" "),n("li",[s._v("speed-measure-webpack-plugin（分析loader和plugin打包的耗时）")])]),s._v(" "),n("h5",{attrs:{id:"生产环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生产环境"}},[s._v("#")]),s._v(" 生产环境")]),s._v(" "),n("blockquote",[n("h4",{attrs:{id:"体积优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#体积优化"}},[s._v("#")]),s._v(" "),n("strong",[s._v("体积优化")])])]),s._v(" "),n("ul",[n("li",[s._v("css提取（mini-css-extract-plugin）")]),s._v(" "),n("li",[s._v("css压缩 （optimize-css-assets-webpack-plugin）")]),s._v(" "),n("li",[s._v("html压缩 （html-webpack-plugin ）")]),s._v(" "),n("li",[s._v("externals （排除不需要被打包的第三方）")]),s._v(" "),n("li",[s._v("js压缩 （production模式自动开启）")]),s._v(" "),n("li",[s._v("tree-shake ( production模式自动开启(webpack4限EsModule;webpack5不限EsModule,CommonJs,优秀得很) )")]),s._v(" "),n("li",[s._v("code-split ( optimization )")]),s._v(" "),n("li",[s._v("import(懒加载，预加载（预加载慎用））")])]),s._v(" "),n("blockquote",[n("h4",{attrs:{id:"打包速度优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包速度优化"}},[s._v("#")]),s._v(" "),n("strong",[s._v("打包速度优化")])])]),s._v(" "),n("ul",[n("li",[s._v("多线程打包（thread-loader 、happyPack）")]),s._v(" "),n("li",[s._v("动态链 （ DLL ）")]),s._v(" "),n("li",[s._v("babel缓存（ 缓存cacheDirectory ）")]),s._v(" "),n("li",[s._v("exclude / exclude (排除一些不需要编译的文件)")]),s._v(" "),n("li",[s._v("module.noParse (排除不需要被loader编译的第三方库)")])]),s._v(" "),n("h3",{attrs:{id:"加载时性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加载时性能优化"}},[s._v("#")]),s._v(" 加载时性能优化")]),s._v(" "),n("ul",[n("li",[s._v("第三方模块按需导入（"),n("code",[s._v("babel-plugin-component")]),s._v("），尽量不要全局引入;")]),s._v(" "),n("li",[s._v("使用更轻量级的工具库；")]),s._v(" "),n("li",[s._v("vue路由组件懒加载；")]),s._v(" "),n("li",[s._v("滚动到可视区域动态加载（"),n("code",[s._v("vue-virtual-scroll-list")]),s._v("）；始终加载上中下屏；优化无限列表性能；")]),s._v(" "),n("li",[s._v("图片懒加载（"),n("code",[s._v("vue-lazyload")]),s._v("）；")])]),s._v(" "),n("h3",{attrs:{id:"用户体验优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户体验优化"}},[s._v("#")]),s._v(" 用户体验优化")]),s._v(" "),n("h4",{attrs:{id:"seo优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#seo优化"}},[s._v("#")]),s._v(" "),n("code",[s._v("SEO")]),s._v("优化")]),s._v(" "),n("ul",[n("li",[s._v("预渲染插件 "),n("code",[s._v("prerender-spa-plugin")]),s._v(";")]),s._v(" "),n("li",[s._v("服务器渲染"),n("code",[s._v("ssr")]),s._v(";")])]),s._v(" "),n("h4",{attrs:{id:"加载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加载"}},[s._v("#")]),s._v(" 加载")]),s._v(" "),n("ul",[n("li",[s._v("骨架屏"),n("code",[s._v("app-skeleton")]),s._v("；")]),s._v(" "),n("li",[s._v("app壳"),n("code",[s._v("app-shell")]),s._v("；")]),s._v(" "),n("li",[s._v("service worker"),n("code",[s._v("pwa")]),s._v(" ;")])]),s._v(" "),n("h3",{attrs:{id:"基础的-web-技术的优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础的-web-技术的优化"}},[s._v("#")]),s._v(" 基础的 Web 技术的优化")]),s._v(" "),n("h4",{attrs:{id:"缓存压缩优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存压缩优化"}},[s._v("#")]),s._v(" 缓存压缩优化")]),s._v(" "),n("ul",[n("li",[s._v("开启"),n("code",[s._v("gzip")]),s._v("压缩；")]),s._v(" "),n("li",[s._v("浏览器缓存、服务端缓存；")])]),s._v(" "),n("h2",{attrs:{id:"详细分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#详细分析"}},[s._v("#")]),s._v(" 详细分析")]),s._v(" "),n("h3",{attrs:{id:"运行时性能优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#运行时性能优化-2"}},[s._v("#")]),s._v(" 运行时性能优化")]),s._v(" "),n("h4",{attrs:{id:"代码层面的优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码层面的优化-2"}},[s._v("#")]),s._v(" 代码层面的优化")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"不要将所有的数据放在data中-data中的数据都会增加getter和setter-会收集对应的watcher"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#不要将所有的数据放在data中-data中的数据都会增加getter和setter-会收集对应的watcher"}},[s._v("#")]),s._v(" 不要将所有的数据放在data中，data中的数据都会增加getter和setter，会收集对应的watcher;")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"拆分组件-提高复用性、增加代码的可维护性、减少不必要的渲染"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#拆分组件-提高复用性、增加代码的可维护性、减少不必要的渲染"}},[s._v("#")]),s._v(" 拆分组件(提高复用性、增加代码的可维护性、减少不必要的渲染)；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"v-if当值为false时内部指令不会执行-具有阻断功能-很多情况下使用v-if替代v-show"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#v-if当值为false时内部指令不会执行-具有阻断功能-很多情况下使用v-if替代v-show"}},[s._v("#")]),s._v(" "),n("code",[s._v("v-if")]),s._v("当值为"),n("code",[s._v("false")]),s._v("时内部指令不会执行，具有阻断功能，很多情况下使用"),n("code",[s._v("v-if")]),s._v("替代"),n("code",[s._v("v-show")]),s._v(";")])]),s._v(" "),n("p",[n("strong",[s._v("v-if")]),s._v(" 是 "),n("strong",[s._v("真正")]),s._v(" 的条件渲染，因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建；也是"),n("strong",[s._v("惰性的")]),s._v("：如果在初始渲染时条件为假，则什么也不做——直到条件第一次变为真时，才会开始渲染条件块。\n"),n("strong",[s._v("v-show")]),s._v(" 就简单得多， 不管初始条件是什么，"),n("strong",[s._v("元素总是会被渲染，并且只是简单地基于 CSS 的 display 属性进行切换")]),s._v("。\n"),n("code",[s._v("v-if")]),s._v(" 适用于在运行时"),n("strong",[s._v("很少改变条件，不需要频繁切换条件的场景")]),s._v("；"),n("code",[s._v("v-show")]),s._v(" 则适用于需要"),n("strong",[s._v("非常频繁切换条件的场景")]),s._v(";")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"合理使用computed、watch及方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#合理使用computed、watch及方法"}},[s._v("#")]),s._v(" 合理使用"),n("code",[s._v("computed")]),s._v("、"),n("code",[s._v("watch")]),s._v("及方法；")])]),s._v(" "),n("p",[n("strong",[s._v("computed：")]),s._v(" 是计算属性，"),n("strong",[s._v("依赖其它属性值(A)，并且 computed 的值有缓存(B)")]),s._v("，只有它依赖的属性值发生改变，下一次获取 computed 的值时才会重新计算 computed  的值；")]),s._v(" "),n("p",[n("strong",[s._v("watch：")]),s._v(" 更多的"),n("strong",[s._v("是「观察」的作用，类似于某些数据的监听回调")]),s._v(" ，每当监听的数据变化时都会执行回调进行后续操作；")]),s._v(" "),n("p",[n("strong",[s._v("运用场景：")])]),s._v(" "),n("ul",[n("li",[s._v("当我们需要"),n("strong",[s._v("进行数值计算，并且依赖于其它数据")]),s._v("时，应该使用 computed，因为可以"),n("strong",[s._v("利用 computed 的缓存特性，避免每次获取值")]),s._v("时，都要重新计算；")]),s._v(" "),n("li",[s._v("当我们需要"),n("strong",[s._v("在数据变化时执行异步或开销较大")]),s._v("的操作时，应该使用 watch，使用 watch 选项允许我们执行异步操作 ( 访问一个 API )，限制我们执行该操作的频率，并在我们"),n("strong",[s._v("得到最终结果前，设置中间状态")]),s._v("。这些都是计算属性无法做到的。")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"key确保唯一性-默认vue采用就地复用策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#key确保唯一性-默认vue采用就地复用策略"}},[s._v("#")]),s._v(" "),n("code",[s._v("key")]),s._v("确保唯一性(默认"),n("code",[s._v("vue")]),s._v("采用就地复用策略);")])]),s._v(" "),n("p",[s._v("v-for 遍历必须为 item 添加 key，且避免同时使用 v-if")]),s._v(" "),n("p",[n("strong",[s._v("（1）v-for 遍历必须为 item 添加 key")])]),s._v(" "),n("p",[s._v("在列表数据进行遍历渲染时，"),n("strong",[s._v("需要为每一项 item 设置唯一 key 值")]),s._v("，方便 Vue.js "),n("strong",[s._v("内部机制精准找到该条列表数据")]),s._v("。当 state 更新时，"),n("strong",[s._v("新的状态值和旧的状态值对比，较快地定位到 diff")]),s._v(" 。")]),s._v(" "),n("p",[n("strong",[s._v("（2）v-for 遍历避免同时使用 v-if")])]),s._v(" "),n("p",[n("strong",[s._v("不推荐")]),s._v("同时使用 "),n("code",[s._v("v-if")]),s._v(" 和 "),n("code",[s._v("v-for")]),s._v("； 当 "),n("code",[s._v("v-if")]),s._v(" 与 "),n("code",[s._v("v-for")]),s._v(" 一起使用时，"),n("strong",[n("code",[s._v("v-for")]),s._v(" 具有比 "),n("code",[s._v("v-if")]),s._v(" 更高的优先级")]),s._v("。这意味着 "),n("code",[s._v("v-if")]),s._v(" 将分别重复运行于每个 "),n("code",[s._v("v-for")]),s._v(" 循环中。")]),s._v(" "),n("div",{staticClass:"language-vue line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vue"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("todo in todos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-if")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("!todo.isComplete"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  {{ todo }}\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- 上面的代码将只渲染未完成的 todo --\x3e")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!-- 优化后 --\x3e")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--而如果你的目的是有条件地跳过循环的执行，那么可以将 v-if 置于外层元素 (或 <template>)上。--\x3e")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-if")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("todos.length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("todo in todos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ todo }}\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("p")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("No todos left!"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("p")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[n("strong",[s._v("v-for 比 v-if 优先级高")]),s._v("，如果每一次都需要遍历整个数组，将会影响速度，尤其是当之需要渲染很小一部分的时候，"),n("strong",[s._v("必要情况下应该替换成 computed 属性")]),s._v("。")]),s._v(" "),n("div",{staticClass:"language-vue line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-vue"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user in activeUsers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v(":key")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ user.name }}\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\ncomputed: {\n  activeUsers: function () {\n    return this.users.filter(function (user) {\n\t return user.isActive\n    })\n  }\n}\n//不推荐：\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("ul")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("li")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-for")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user in users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("v-if")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.isActive"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v(":key")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')]),s._v("user.id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    {{ user.name }}\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("li")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("ul")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"vue在v-for时给每项元素绑定事件需要用事件代理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue在v-for时给每项元素绑定事件需要用事件代理"}},[s._v("#")]),s._v(" "),n("code",[s._v("vue")]),s._v("在"),n("code",[s._v("v-for")]),s._v("时给每项元素绑定事件需要用事件代理；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"长列表只显示的话-object-freeze冻结数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#长列表只显示的话-object-freeze冻结数据"}},[s._v("#")]),s._v(" 长列表只显示的话，"),n("code",[s._v("Object.freeze")]),s._v("冻结数据；")])]),s._v(" "),n("p",[s._v("Vue 会通过 Object.defineProperty 对数据进行劫持，来实现视图响应数据的变化，然而"),n("strong",[s._v("有些时候我们的组件就是纯粹的数据展示，不会有任何改变")]),s._v("，我们就不需要 Vue 来劫持我们的数据，"),n("strong",[s._v("在大量数据展示的情况下，这能够很明显的减少组件初始化的时间")]),s._v("，那如何禁止 Vue 劫持我们的数据呢？"),n("strong",[s._v("可以通过 Object.freeze 方法来冻结一个对象，一旦被冻结的对象就再也不能被修改了")]),s._v("。对于长列表"),n("strong",[s._v("还可以通过分页的优化")]),s._v("；")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("data")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    users"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("async")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("created")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("await")]),s._v(" axios"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/api/users"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("freeze")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"spa页面采用keep-alive缓存组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spa页面采用keep-alive缓存组件"}},[s._v("#")]),s._v(" "),n("code",[s._v("SPA")]),s._v("页面采用"),n("code",[s._v("keep-alive")]),s._v("缓存组件；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"扁平化-store-数据结构"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#扁平化-store-数据结构"}},[s._v("#")]),s._v(" 扁平化 Store 数据结构")])]),s._v(" "),n("p",[s._v("手动去把接口里的信息通过类似数据的表一样像这样存起来，也可以借助一些工具，这里就需要提到一个概念叫做 "),n("code",[s._v("JSON数据规范化（normalize）")]),s._v(", Normalizr 是一个开源的工具，可以将上面的深层嵌套的 JSON 对象通过定义好的 schema 转变成使用 id 作为字典的实体表示的对象。")]),s._v(" "),n("p",[s._v("需要了解更多请参考 normalizr 的文档 "),n("a",{attrs:{href:"https://github.com/paularmstrong/normalizr",target:"_blank",rel:"noopener noreferrer"}},[s._v("github.com/paularmstro…"),n("OutboundLink")],1)]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"author"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Paul"')]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"title"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"My awesome blog post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"comments"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"324"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commenter"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Nicole"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("假如直接把这样的结构存储在 store 中，如果想修改某个 commenter 的信息，我们需要一层层去遍历找到这个用户的信息，同时有可能这个用户的信息出现了多次，还需要把其他地方的用户信息也进行修改，"),n("strong",[s._v("每次遍历的过程会带来额外的性能开销。")])]),s._v(" "),n("p",[s._v("假设我们把用户信息在 store 内统一存放成 "),n("code",[s._v("users[id]")]),s._v("这样的结构，修改和读取用户信息的成本就变得非常低。")]),s._v(" "),n("p",[s._v("举个例子，针对上面的 JSON 数据，我们定义 "),n("code",[s._v("users")]),s._v(" "),n("code",[s._v("comments")]),s._v(" "),n("code",[s._v("articles")]),s._v(" 三种 schema：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("normalize"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" schema"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'normalizr'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 定义 users schema")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("schema"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'users'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 定义 comments schema")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" comment "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("schema"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'comments'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  commenter"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 定义 articles schema")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" article "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("schema"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Entity")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'articles'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  author"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  comments"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("comment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" normalizedData "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("normalize")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("originalData"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" article"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("normalize 之后就可以得到下面的数据，我们"),n("strong",[s._v("可以按照这种形式存放在 store 中，之后想修改和读取某个 id 的用户信息就变得非常高效了，时间复杂度降低到了 O(1)")]),s._v("。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  result"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  entities"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"articles"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        author"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        title"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"My awesome blog post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        comments"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"324"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"users"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Paul"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Nicole"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"comments"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"324"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"324"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commenter"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("blockquote",[n("h6",{attrs:{id:"数据持久化的问题-防抖-节流"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据持久化的问题-防抖-节流"}},[s._v("#")]),s._v(" 数据持久化的问题（防抖，节流）；")])]),s._v(" "),n("p",[n("strong",[s._v("避免持久化 Store 数据带来的性能问题")])]),s._v(" "),n("p",[s._v("当你有让 Vue App 离线可用，或者有接口出错时候进行灾备的需求的时候，你可能会选择把 Store 数据进行持久化，这个时候需要注意以下几个方面：")]),s._v(" "),n("p",[n("strong",[s._v("持久化时写入数据的性能问题")])]),s._v(" "),n("p",[s._v("Vue 社区中比较流行的 vuex-persistedstate，利用了 store 的 subscribe 机制，来订阅 Store 数据的 mutation，如果发生了变化，就会写入 storage 中，"),n("strong",[s._v("默认用的是 localstorage 作为持久化存储")]),s._v("。")]),s._v(" "),n("p",[s._v("也就是说默认情况下每次 commit 都会向 localstorage 写入数据，localstorage 写入是同步的，而且存在不小的性能开销，如果你想打造 60fps 的应用，就必须避免频繁写入持久化数据")]),s._v(" "),n("p",[s._v("我们应该"),n("strong",[s._v("尽量减少直接写入 Storage 的频率")]),s._v("：")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("多次写入操作合并为一次")]),s._v("，比如采用函数节流或者将数据先缓存在内存中，最后在一并写入")]),s._v(" "),n("li",[n("strong",[s._v("只有在必要的时候才写入")]),s._v("，比如只有关心的模块的数据发生变化的时候才写入")])]),s._v(" "),n("p",[n("strong",[s._v("避免持久化存储的容量持续增长")])]),s._v(" "),n("p",[s._v("由于持久化缓存的容量有限，比如 "),n("strong",[s._v("localstorage 的缓存在某些浏览器只有 5M")]),s._v("，我们不能无限制的将所有数据都存起来，这样很容易达到容量限制，同时数据过大时，读取和写入操作会增加一些性能开销，同时内存也会上涨。")]),s._v(" "),n("p",[s._v("尤其是将 API 数据进行 normalize 数据扁平化后之后，会将一份数据散落在不同的实体上，下次请求到新的数据也会散落在其他不同的实体上，这样会带来持续的存储增长。")]),s._v(" "),n("p",[s._v("因此，当"),n("strong",[s._v("设计了一套持久化的数据缓存策略的时候，同时应该设计旧数据的缓存清除策略")]),s._v("，例如"),n("strong",[s._v("请求到新数据的时候将旧的实体逐个进行清除")]),s._v("。")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"事件的销毁"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#事件的销毁"}},[s._v("#")]),s._v(" 事件的销毁；")])]),s._v(" "),n("p",[n("strong",[s._v("Vue 组件销毁时，会自动清理它与其它实例的连接，解绑它的全部指令及事件监听器，但是仅限于组件本身的事件")]),s._v("。 如果"),n("strong",[s._v("在 js 内使用 "),n("code",[s._v("addEventListener")]),s._v("等方式是不会自动销毁的，我们需要在组件销毁时手动移除这些事件的监听，以免造成内存泄露")]),s._v("，如：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("created")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'click'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("click"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("beforeDestroy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("removeEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'click'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("click"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("相同事件绑定和解除，"),n("strong",[s._v("需要使用共用函数")]),s._v('；绑定和解除事件时 事件没有"on" 即onclick写成click; 共用函数不能带参数；')]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'touchmove'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("preventDefault")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("removeEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'touchmove'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("preventDefault")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//以上为错误写法；下面为正确写法；")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("bodyScroll")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    event"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("preventDefault")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'touchmove'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("bodyScroll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("removeEventListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'touchmove'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("bodyScroll"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"尽量采用runtime运行时版本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#尽量采用runtime运行时版本"}},[s._v("#")]),s._v(" 尽量采用runtime运行时版本；")])]),s._v(" "),n("p",[n("strong",[s._v("引入生产环境的 Vue 文件")])]),s._v(" "),n("p",[s._v("开发环境下，Vue 会提供很多警告来帮你对付常见的错误与陷阱。而在生产环境下，这些警告语句没有用，反而会增加应用的体积。有些警告检查还有一些小的"),n("strong",[s._v("运行时开销")]),s._v("。")]),s._v(" "),n("p",[s._v("当使用 webpack 或 Browserify 类似的构建工具时，Vue 源码会根据 process.env.NODE_ENV 决定是否启用生产环境模式，默认情况为开发环境模式。在 webpack 与 Browserify 中都有方法来覆盖此变量，以启用 Vue 的生产环境模式，同时在构建过程中警告语句也会被压缩工具去除。")]),s._v(" "),n("p",[n("strong",[s._v("使用单文件组件预编译模板")])]),s._v(" "),n("p",[s._v("当使用 DOM 内模板或 JavaScript 内的字符串模板时，模板会在"),n("strong",[s._v("运行时被编译为渲染函数")]),s._v("。通常情况下这个过程已经足够快了，但"),n("strong",[s._v("对性能敏感的应用还是最好避免这种用法")]),s._v("。")]),s._v(" "),n("p",[s._v("预编译模板最简单的方式就是使用"),n("strong",[s._v("单文件组件")]),s._v("——相关的构建设置会自动把预编译处理好，所以构建好的代码已经包含了编译出来的渲染函数而不是原始的模板字符串。")]),s._v(" "),n("p",[n("strong",[s._v("提取组件的 CSS 到单独到文件")])]),s._v(" "),n("p",[s._v("当使用单文件组件时，组件内的 CSS 会以 `` 标签的方式通过 JavaScript 动态注入。这有一些小小的"),n("strong",[s._v("运行时开销")]),s._v("，将所有组件的 CSS 提取到同一个文件可以避免这个问题，也会让 CSS 更好地进行压缩和缓存。")]),s._v(" "),n("p",[s._v("查阅这个构建工具各自的文档来了解更多：")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://vue-loader.vuejs.org/zh-cn/configurations/extract-css.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack + vue-loader"),n("OutboundLink")],1),s._v(" ("),n("code",[s._v("vue-cli")]),s._v(" 的 webpack 模板已经预先配置好)")])]),s._v(" "),n("h4",{attrs:{id:"webpack层面的优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack层面的优化-2"}},[s._v("#")]),s._v(" Webpack层面的优化")]),s._v(" "),n("h5",{attrs:{id:"开发环境-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开发环境-2"}},[s._v("#")]),s._v(" 开发环境")]),s._v(" "),n("ul",[n("li",[s._v("HRM (热替换)")]),s._v(" "),n("li",[s._v("webpack-dev-server （本地服务器）")]),s._v(" "),n("li",[s._v("soure-map （调试）")]),s._v(" "),n("li",[s._v("webpack-bundle-analyzer（打包生成代码块分析视图）")]),s._v(" "),n("li",[s._v("size-plugin（监控打包资源的体积变量化）")]),s._v(" "),n("li",[s._v("speed-measure-webpack-plugin（分析loader和plugin打包的耗时）")])]),s._v(" "),n("h5",{attrs:{id:"生产环境-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生产环境-2"}},[s._v("#")]),s._v(" 生产环境")]),s._v(" "),n("blockquote",[n("h4",{attrs:{id:"体积优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#体积优化-2"}},[s._v("#")]),s._v(" "),n("strong",[s._v("体积优化")])])]),s._v(" "),n("ul",[n("li",[s._v("css提取（mini-css-extract-plugin）")]),s._v(" "),n("li",[s._v("css压缩 （optimize-css-assets-webpack-plugin）")]),s._v(" "),n("li",[s._v("html压缩 （html-webpack-plugin ）")]),s._v(" "),n("li",[s._v("externals （排除不需要被打包的第三方）")]),s._v(" "),n("li",[s._v("js压缩 （production模式自动开启）")]),s._v(" "),n("li",[s._v("tree-shake ( production模式自动开启(webpack4限EsModule;webpack5不限EsModule,CommonJs,优秀得很) )")]),s._v(" "),n("li",[s._v("code-split ( optimization )")]),s._v(" "),n("li",[s._v("import(懒加载，预加载（预加载慎用））")])]),s._v(" "),n("blockquote",[n("h4",{attrs:{id:"打包速度优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打包速度优化-2"}},[s._v("#")]),s._v(" "),n("strong",[s._v("打包速度优化")])])]),s._v(" "),n("ul",[n("li",[s._v("多线程打包（thread-loader 、happyPack）")]),s._v(" "),n("li",[s._v("动态链 （ DLL ）")]),s._v(" "),n("li",[s._v("babel缓存（ 缓存cacheDirectory ）")]),s._v(" "),n("li",[s._v("exclude / exclude (排除一些不需要编译的文件)")]),s._v(" "),n("li",[s._v("module.noParse (排除不需要被loader编译的第三方库)")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"使用cdn的方式加载第三方模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用cdn的方式加载第三方模块"}},[s._v("#")]),s._v(" 使用"),n("code",[s._v("cdn")]),s._v("的方式加载第三方模块；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"多线程打包happypack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#多线程打包happypack"}},[s._v("#")]),s._v(" 多线程打包"),n("code",[s._v("happypack")]),s._v(";")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"splitchunks抽离公共文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#splitchunks抽离公共文件"}},[s._v("#")]),s._v(" "),n("code",[s._v("splitChunks")]),s._v("抽离公共文件；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"sourcemap生成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sourcemap生成"}},[s._v("#")]),s._v(" "),n("code",[s._v("sourceMap")]),s._v("生成；")])]),s._v(" "),n("p",[n("strong",[s._v("生成环境不生成 map 文件")]),s._v("；找到 config/index.js，修改为 productionSourceMap: false")]),s._v(" "),n("h3",{attrs:{id:"加载性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加载性能优化"}},[s._v("#")]),s._v(" 加载性能优化")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"第三方模块按需导入-babel-plugin-component"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#第三方模块按需导入-babel-plugin-component"}},[s._v("#")]),s._v(" 第三方模块按需导入（"),n("code",[s._v("babel-plugin-component")]),s._v("）;")])]),s._v(" "),n("p",[s._v("在项目中经常会需要引入第三方插件，如果我们"),n("strong",[s._v("直接引入整个插件，会导致项目的体积太大")]),s._v("，我们可以借助 "),n("code",[s._v("babel-plugin-component")]),s._v(" ，然后"),n("strong",[s._v("可以只引入需要的组件，以达到减小项目体积的目的")]),s._v("。以下为项目中引入 element-ui 组件库为例：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//安装")]),s._v("\nnpm install babel"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("plugin"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("component "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("D")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//将 .babelrc 修改为")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"presets"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es2015"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modules"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"plugins"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"component"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"libraryName"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"element-ui"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"styleLibraryName"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"theme-chalk"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//在 main.js 中引入部分组件：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" Button"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Select "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'element-ui'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nVue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Button"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nVue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Select"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"使用更轻量级的工具库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用更轻量级的工具库"}},[s._v("#")]),s._v(" 使用更轻量级的工具库；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"vue路由组件懒加载-合理使用路由懒加载-异步组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue路由组件懒加载-合理使用路由懒加载-异步组件"}},[s._v("#")]),s._v(" vue路由组件懒加载；合理使用路由懒加载，异步组件；")])]),s._v(" "),n("p",[s._v("通过组件懒加载方案可以优化初始渲染的运行性能，其实，这对于优化应用的加载性能也很有帮助。")]),s._v(" "),n("p",[n("strong",[s._v("组件粒度的懒加载结合异步组件和 webpack 代码分片")]),s._v("，可以"),n("strong",[s._v("保证按需加载组件，以及组件依赖的资源、接口请求等")]),s._v("，比起通常单纯的对图片进行懒加载，更进一步的做到了按需加载资源。")]),s._v(" "),n("p",[n("strong",[s._v("Vue  是单页面应用，可能会有很多的路由引入 ，这样使用 webpcak 打包后的文件很大")]),s._v("，当进入首页时，加载的资源过多，页面会出现白屏的情况，不利于用户体验。如果我们"),n("strong",[s._v("能把不同路由对应的组件分割成不同的代码块，然后当路由被访问的时候才加载对应的组件，这样就更加高效了")]),s._v("。这样会大大提高首屏显示的速度，但是可能其他的页面的速度就会降下来。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("Foo")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./Foo.vue'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" router "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("VueRouter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  routes"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/foo'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" component"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Foo "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Router "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue-router'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//import Login from '../components/login/login.vue'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("login")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('/* webpackChunkName: "login" */')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'../pages/login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nVue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Router"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" routes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    path"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登陆'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    component"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" login"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    meta"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" requiresAuth"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" router "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Router")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'history'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  base"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" __dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  routes\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" router\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"滚动到可视区域动态加载-vue-virtual-scroll-list-始终加载上中下屏-优化无限列表性能"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#滚动到可视区域动态加载-vue-virtual-scroll-list-始终加载上中下屏-优化无限列表性能"}},[s._v("#")]),s._v(" 滚动到可视区域动态加载（"),n("code",[s._v("vue-virtual-scroll-list")]),s._v("）；始终加载上中下屏；优化无限列表性能")])]),s._v(" "),n("p",[s._v("如果你的应用"),n("strong",[s._v("存在非常长或者无限滚动的列表")]),s._v("，那么需要"),n("strong",[s._v("采用 "),n("code",[s._v("窗口化 的技术")]),s._v("来优化性能，只需要渲染少部分区域的内容，减少重新渲染组件和创建 dom 节点的时间")]),s._v("。 你可以参考以下开源项目 "),n("a",{attrs:{href:"https://github.com/tangbc/vue-virtual-scroll-list",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-virtual-scroll-list"),n("OutboundLink")],1),s._v(" 和 "),n("a",{attrs:{href:"https://github.com/Akryum/vue-virtual-scroller",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-virtual-scroller"),n("OutboundLink")],1),s._v("  来优化这种"),n("strong",[s._v("无限列表的场景的")]),s._v("。你也可以参考 Google 工程师的文章"),n("a",{attrs:{href:"https://developers.google.com/web/updates/2016/07/infinite-scroller",target:"_blank",rel:"noopener noreferrer"}},[s._v("Complexities of an Infinite Scroller"),n("OutboundLink")],1),s._v(" 来尝试自己实现一个虚拟的滚动列表来优化性能，"),n("strong",[s._v("主要使用到的技术是 DOM 回收、墓碑元素和滚动锚定")]),s._v("。")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"图片懒加载-vue-lazyload"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#图片懒加载-vue-lazyload"}},[s._v("#")]),s._v(" 图片懒加载（"),n("code",[s._v("vue-lazyload")]),s._v("）；")])]),s._v(" "),n("p",[s._v("对于图片过多的页面，为了加速页面加载速度，所以很多时候我们需要将页面内未出现在可视区域内的图片先不做加载， 等到滚动到可视区域后再去加载。这样对于页面加载性能上会有很大的提升，也提高了用户体验。我们在项目中使用 Vue 的 "),n("a",{attrs:{href:"https://github.com/hilongjw/vue-lazyload",target:"_blank",rel:"noopener noreferrer"}},[s._v("vue-lazyload"),n("OutboundLink")],1),s._v("插件：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" VueLazyload "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vue-lazyload'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置一：然后再 vue 中直接使用")]),s._v("\nVue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VueLazyload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//配置二：或者添加自定义选项")]),s._v("\nVue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VueLazyload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    preLoad"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    error"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dist/error.png'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    loading"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'dist/loading.gif'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    attempt"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//使用；在 vue 文件中将 img 标签的 src 属性直接改为 v-lazy ，从而将图片显示方式更改为懒加载显示：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("img v"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lazy"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/static/img/1.png"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//template:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ul"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("li v"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"img in list"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("img v"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lazy"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"img.src"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("li"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ul"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//use v-lazy-container work with raw HTML")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("div v"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lazy"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("container"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"{ selector: 'img' }\"")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("img data"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("src"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"//domain.com/img1.jpg"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("div"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h3",{attrs:{id:"用户体验优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用户体验优化-2"}},[s._v("#")]),s._v(" 用户体验优化")]),s._v(" "),n("h4",{attrs:{id:"seo优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#seo优化-2"}},[s._v("#")]),s._v(" "),n("code",[s._v("SEO")]),s._v("优化")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"预渲染插件-prerender-spa-plugin"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#预渲染插件-prerender-spa-plugin"}},[s._v("#")]),s._v(" 预渲染插件 "),n("code",[s._v("prerender-spa-plugin")]),s._v(";")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"服务器渲染ssr"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器渲染ssr"}},[s._v("#")]),s._v(" 服务器渲染"),n("code",[s._v("ssr")]),s._v(";")])]),s._v(" "),n("p",[s._v("首页单独做服务端渲染；"),n("strong",[s._v("利用服务端渲染（SSR）和预渲染（Prerender）来优化加载性能")])]),s._v(" "),n("p",[n("strong",[s._v("一些概念")])]),s._v(" "),n("ol",[n("li",[n("strong",[s._v("服务端渲染")]),s._v("：用户访问 url，服务端根据访问路径请求所需数据，拼接成 html 字符串，返回给前端。前端接"),n("strong",[s._v("收到 html 时已有部分内容")]),s._v("；")]),s._v(" "),n("li",[n("strong",[s._v("预渲染")]),s._v("：构建阶段生成匹配预渲染路径的 html 文件（注意：每个需要预渲染的路由都有一个对应的 html）。构建出来的 html 文件已有部分内容。")]),s._v(" "),n("li",[n("strong",[s._v("客户端渲染")]),s._v("：用户访问 url，请求 html 文件，前端根据路由动态渲染页面内容。关键链路较长，有一定的白屏时间；")])]),s._v(" "),n("p",[n("strong",[s._v("服务端渲染、预渲染和客户端渲染的对比")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(727),alt:""}}),s._v("\n这种情况下"),n("strong",[s._v("可以采用服务端渲染（SSR）和预渲染（Prerender）来提升加载性能")]),s._v("，这两种方案，用户读取到的直接就是网页内容，由于少了节省了很多 RTT（往返时延），同时，还可以对一些资源内联在页面，可以进一步提升加载的性能。")]),s._v(" "),n("p",[s._v("如果"),n("strong",[s._v("项目的 SEO 和 首屏渲染是评价项目的关键指标")]),s._v("，那么项目"),n("strong",[s._v("就需要服务端渲染")]),s._v("来帮助实现最佳的初始加载性能和 SEO")]),s._v(" "),n("h4",{attrs:{id:"加载-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加载-2"}},[s._v("#")]),s._v(" 加载")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"骨架屏app-skeleton"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#骨架屏app-skeleton"}},[s._v("#")]),s._v(" 骨架屏"),n("code",[s._v("app-skeleton")]),s._v("；")])]),s._v(" "),n("p",[n("strong",[s._v("通过组件懒加载优化超长应用内容初始渲染性能")])]),s._v(" "),n("p",[s._v("上面提到的"),n("strong",[s._v("无限列表的场景，比较适合列表内元素非常相似的情况")]),s._v("，不过有时候，你的 Vue 应用的超长列表内的内容往往不尽相同，例如在一个复杂的应用的主界面中，整个主界面由非常多不同的模块组成，而用户看到的往往只有首屏一两个模块。"),n("strong",[s._v("在初始渲染的时候不可见区域的模块也会执行和渲染，带来一些额外的性能开销")]),s._v("。")]),s._v(" "),n("p",[n("strong",[s._v("使用组件懒加载在不可见时只需要渲染一个骨架屏，不需要真正渲染组件")])]),s._v(" "),n("p",[s._v("可以对组件直接进行懒加载，对于不可见区域的组件内容，直接不进行加载和初始化，避免初始化渲染运行时的开销。具体可以参考专栏文章 "),n("a",{attrs:{href:"https://juejin.im/post/59bf501ff265da06602971b9",target:"_blank",rel:"noopener noreferrer"}},[s._v("性能优化之组件懒加载: Vue Lazy Component 介绍"),n("OutboundLink")],1),s._v("，了解如何做到组件粒度的懒加载。")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"app壳app-shell"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#app壳app-shell"}},[s._v("#")]),s._v(" app壳"),n("code",[s._v("app-shell")]),s._v("；")])]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"service-workerpwa"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#service-workerpwa"}},[s._v("#")]),s._v(" service worker"),n("code",[s._v("pwa")]),s._v(" ;")])]),s._v(" "),n("h3",{attrs:{id:"基础的-web-技术的优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基础的-web-技术的优化-2"}},[s._v("#")]),s._v(" 基础的 Web 技术的优化")]),s._v(" "),n("h4",{attrs:{id:"缓存压缩优化-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存压缩优化-2"}},[s._v("#")]),s._v(" 缓存压缩优化")]),s._v(" "),n("blockquote",[n("h5",{attrs:{id:"开启gzip压缩"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#开启gzip压缩"}},[s._v("#")]),s._v(" 开启"),n("code",[s._v("gzip")]),s._v("压缩；")])]),s._v(" "),n("p",[s._v("gzip 是 GNUzip 的缩写，最早用于 UNIX 系统的文件压缩。"),n("strong",[s._v("HTTP 协议上的 gzip 编码是一种用来改进 web 应用程序性能的技术，web 服务器和客户端（浏览器）必须共同支持 gzip")]),s._v("。")]),s._v(" "),n("p",[s._v("目前主流的浏览器，Chrome，firefox，IE等都支持该协议。常见的服务器如 Apache，Nginx，IIS 同样支持，"),n("strong",[s._v("gzip 压缩效率非常高，通常可以达到 70% 的压缩率")]),s._v("，也就是说，如果你的网页有 30K，压缩之后就变成了 9K 左右;")]),s._v(" "),n("p",[s._v("重启服务，观察网络面板里面的 response header，如果看到如下红圈里的字段则表明 gzip 开启成功")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//服务器压缩")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" compression "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'compression'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("compression")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//nginx中的设置； 详见【nginx运维部署相关】设置; 推荐在nginx中统一设置；")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    gzip                    on;\n    gzip_http_version       1.1;\n    gzip_comp_level         5;\n    gzip_min_length         1000;\n    gzip_types text/csv text/xml text/css text/plain text/javascript application/javascript application/x-javascript application/json application/xml;\n    gzip_disable    "MSIE [1-6]\\.";     # IE6无效\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("blockquote",[n("h5",{attrs:{id:"浏览器缓存、服务端缓存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#浏览器缓存、服务端缓存"}},[s._v("#")]),s._v(" 浏览器缓存、服务端缓存；")])]),s._v(" "),n("p",[s._v("详见【http协议】中缓存的介绍；")]),s._v(" "),n("p",[s._v("为了提高用户加载页面的速度，"),n("strong",[s._v("对静态资源进行缓存是非常必要的")]),s._v("，根据是否需要重新向服务器发起请求来分类，将 HTTP 缓存规则分为两大类（强制缓存，对比缓存）")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("版本")]),s._v(" "),n("th",[s._v("内容")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("http0.9")]),s._v(" "),n("td",[s._v("只允许客户端发送 GET 这一种请求;且不支持请求头,协议只支持纯文本;无状态性,每个访问独立处理,完成断开;无状态码")])]),s._v(" "),n("tr",[n("td",[s._v("http1.0")]),s._v(" "),n("td",[s._v("解决 0.9 的缺点,"),n("strong",[s._v("增加 If-modify-since(last-modify)和 expires 缓存属性")])])]),s._v(" "),n("tr",[n("td",[s._v("http1.x")]),s._v(" "),n("td",[n("strong",[s._v("增加 cache-control 和 If-none-match(etag)缓存属性")])])]),s._v(" "),n("tr",[n("td",[s._v("http2.0")]),s._v(" "),n("td",[n("strong",[s._v("采用二进制格式传输;多路复用;报头压缩;服务器推送")])])]),s._v(" "),n("tr",[n("td",[s._v("http3.0")]),s._v(" "),n("td",[s._v("采用 QUIC 协议,"),n("strong",[s._v("自定义连接机制")]),s._v(";自定义"),n("strong",[s._v("重传机制")]),s._v(";"),n("strong",[s._v("无阻塞的多路复用")])])])])]),s._v(" "),n("p",[s._v("tips：")]),s._v(" "),n("ul",[n("li",[s._v("请求头中如果有 If-Modified-Since，服务器会将时间与 last-modified 对比，相同返回 304;")]),s._v(" "),n("li",[s._v("expires 是响应头内容，返回一个固定的时间, 缺陷是时间到了服务器要重新设置;")])]),s._v(" "),n("p",[n("strong",[s._v("常用请求头：1.请求和响应报文的通用Header;2.常用的响应Header;")]),s._v(" "),n("img",{attrs:{src:a(728),alt:""}})]),s._v(" "),n("h4",{attrs:{id:"缓存的优点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存的优点"}},[s._v("#")]),s._v(" 缓存的优点")]),s._v(" "),n("ol",[n("li",[s._v("减少了冗余的数据传递，"),n("strong",[s._v("节省宽带流量")])]),s._v(" "),n("li",[s._v("减少了"),n("strong",[s._v("服务器的负担，大大提高了网站性能")])]),s._v(" "),n("li",[n("strong",[s._v("加快了客户端加载网页的速度")]),s._v(" 这也正是HTTP缓存属于客户端缓存的原因。")])]),s._v(" "),n("h4",{attrs:{id:"缓存流程图"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#缓存流程图"}},[s._v("#")]),s._v(" 缓存流程图")]),s._v(" "),n("ol",[n("li",[n("strong",[s._v("会先判断强缓存")]),s._v("，Expires, Cache-Control(max-age) no-cache=true, public ；")]),s._v(" "),n("li",[n("strong",[s._v("再判断协商缓存 "),n("code",[s._v("etag")]),s._v("及"),n("code",[s._v("last-modified")]),s._v("是否存在")]),s._v("；存在利用属性 If-None-match（etag）If-Modified-since(last-modified)携带值(这一步叫做"),n("strong",[s._v("数据签名")]),s._v(")；")]),s._v(" "),n("li",[n("strong",[s._v("请求服务器,服务器对比 etag(last-modified)，生效返回 304")]),s._v(";")])]),s._v(" "),n("p",[n("img",{attrs:{src:a(729),alt:""}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(730),alt:""}})]),s._v(" "),n("h3",{attrs:{id:"不同刷新的请求执行过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#不同刷新的请求执行过程"}},[s._v("#")]),s._v(" 不同刷新的请求执行过程")]),s._v(" "),n("h2",{attrs:{id:"定位-vue-应用性能问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#定位-vue-应用性能问题"}},[s._v("#")]),s._v(" 定位 Vue 应用性能问题")]),s._v(" "),n("p",[s._v("Vue 应用的性能问题可以分为两个部分，第一部分是运行时性能问题，第二部分是加载性能问题。")]),s._v(" "),n("h3",{attrs:{id:"chrome-devtool-todo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chrome-devtool-todo"}},[s._v("#")]),s._v(" Chrome Devtool/TODO")]),s._v(" "),n("p",[s._v("和其他 web 应用一样，定位 Vue 应用性能问题最好的工具是 Chrome Devtool，通过 Performance 工具可以用来录制一段时间的 CPU 占用、内存占用、FPS 等运行时性能问题，通过 Network 工具可以用来分析加载性能问题。")]),s._v(" "),n("p",[s._v("例如，通过 Performance 工具的 Bottom Up 标签我们可以看出一段时间内耗时最多的操作，这对于优化 CPU 占用和 FPS 过低非常有用，可以看出最为耗时的操作发生在哪里，可以知道具体函数的执行时间，定位到瓶颈之后，我们就可以做一些针对性的优化。")]),s._v(" "),n("p",[s._v("更多 Chrome Devtool 使用方式请参考"),n("a",{attrs:{href:"https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用 Chrome Devtool 定位性能问题 的指南"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),n("p",[s._v("https://juejin.cn/post/6922641008106668045")])])}),[],!1,null,null,null);t.default=e.exports},727:function(s,t,a){s.exports=a.p+"assets/img/22-40-07.e3dfc7e7.jpg"},728:function(s,t,a){s.exports=a.p+"assets/img/21-47-37.e654a3f6.jpg"},729:function(s,t,a){s.exports=a.p+"assets/img/10-03-56.95a824fd.jpg"},730:function(s,t,a){s.exports=a.p+"assets/img/12-55-20.149a22d3.jpg"}}]);