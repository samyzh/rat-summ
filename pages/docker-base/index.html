<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker&amp;compose及swarm的使用 | 写作认知体系</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/rat-summ/img/favicon.ico">
    <link rel="manifest" href="/rat-summ/manifest.json">
    <script charset="utf-8" src="/rat-summ/js/readmore.js"></script>
    <meta name="description" content="uname -r">
    <meta name="image" content="https://my.samyz.cn/~/20-55-11.jpg">
    <meta name="twitter:title" content="docker&compose及swarm的使用">
    <meta name="twitter:description" content="uname -r">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://my.samyz.cn/~/20-55-11.jpg">
    <meta name="twitter:url" content="https://my.samyz.cn/%E3%80%8A%E6%8A%80%E8%83%BD%E8%AE%B0%E5%BD%95%E3%80%8B/20.devops/10.docker/01.docker&compose%E5%8F%8Aswarm%E7%9A%84%E4%BD%BF%E7%94%A8.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="docker&compose及swarm的使用">
    <meta property="og:description" content="uname -r">
    <meta property="og:image" content="https://my.samyz.cn/~/20-55-11.jpg">
    <meta property="og:url" content="https://my.samyz.cn/%E3%80%8A%E6%8A%80%E8%83%BD%E8%AE%B0%E5%BD%95%E3%80%8B/20.devops/10.docker/01.docker&compose%E5%8F%8Aswarm%E7%9A%84%E4%BD%BF%E7%94%A8.html">
    <meta property="og:site_name" content="samyzh">
    <meta property="article:published_time" content="2017-01-02 22:18">
    <meta property="article:tag" content="null">
    <meta itemprop="name" content="docker&compose及swarm的使用">
    <meta itemprop="description" content="uname -r">
    <meta itemprop="image" content="https://my.samyz.cn/~/20-55-11.jpg">
    <meta name="keywords" content="vuepress,theme,doc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/rat-summ/assets/css/0.styles.b7fb6ee3.css" as="style"><link rel="preload" href="/rat-summ/assets/js/app.12c8e251.js" as="script"><link rel="preload" href="/rat-summ/assets/js/3.9ee9750d.js" as="script"><link rel="preload" href="/rat-summ/assets/js/204.f9c43a60.js" as="script"><link rel="preload" href="/rat-summ/assets/js/126.5b6d9993.js" as="script"><link rel="prefetch" href="/rat-summ/assets/js/10.80323458.js"><link rel="prefetch" href="/rat-summ/assets/js/100.63ac2838.js"><link rel="prefetch" href="/rat-summ/assets/js/101.f09c9fa8.js"><link rel="prefetch" href="/rat-summ/assets/js/102.e02db0d7.js"><link rel="prefetch" href="/rat-summ/assets/js/103.51677b36.js"><link rel="prefetch" href="/rat-summ/assets/js/104.61a1cf5b.js"><link rel="prefetch" href="/rat-summ/assets/js/105.70098b35.js"><link rel="prefetch" href="/rat-summ/assets/js/106.6ae75c51.js"><link rel="prefetch" href="/rat-summ/assets/js/107.d489a3d5.js"><link rel="prefetch" href="/rat-summ/assets/js/108.8e8c89ba.js"><link rel="prefetch" href="/rat-summ/assets/js/109.882f5f95.js"><link rel="prefetch" href="/rat-summ/assets/js/11.d181b5e4.js"><link rel="prefetch" href="/rat-summ/assets/js/110.9d564d94.js"><link rel="prefetch" href="/rat-summ/assets/js/111.478420b6.js"><link rel="prefetch" href="/rat-summ/assets/js/112.6c4c063d.js"><link rel="prefetch" href="/rat-summ/assets/js/113.3315b958.js"><link rel="prefetch" href="/rat-summ/assets/js/114.12c71440.js"><link rel="prefetch" href="/rat-summ/assets/js/115.ae4f07da.js"><link rel="prefetch" href="/rat-summ/assets/js/116.43f95817.js"><link rel="prefetch" href="/rat-summ/assets/js/117.ed8bfc6d.js"><link rel="prefetch" href="/rat-summ/assets/js/118.64e4c02c.js"><link rel="prefetch" href="/rat-summ/assets/js/119.b875aab9.js"><link rel="prefetch" href="/rat-summ/assets/js/12.0e10da37.js"><link rel="prefetch" href="/rat-summ/assets/js/120.bd5786bb.js"><link rel="prefetch" href="/rat-summ/assets/js/121.86519d2a.js"><link rel="prefetch" href="/rat-summ/assets/js/122.ceba69a1.js"><link rel="prefetch" href="/rat-summ/assets/js/123.daacf7b1.js"><link rel="prefetch" href="/rat-summ/assets/js/124.343ee32a.js"><link rel="prefetch" href="/rat-summ/assets/js/125.9bcd4dbe.js"><link rel="prefetch" href="/rat-summ/assets/js/127.83f78f6b.js"><link rel="prefetch" href="/rat-summ/assets/js/128.d24cd969.js"><link rel="prefetch" href="/rat-summ/assets/js/129.1f27d5da.js"><link rel="prefetch" href="/rat-summ/assets/js/13.464088c6.js"><link rel="prefetch" href="/rat-summ/assets/js/130.d8eb4273.js"><link rel="prefetch" href="/rat-summ/assets/js/131.8781abf8.js"><link rel="prefetch" href="/rat-summ/assets/js/132.6498f3c3.js"><link rel="prefetch" href="/rat-summ/assets/js/133.57a6dd2f.js"><link rel="prefetch" href="/rat-summ/assets/js/134.fad0beeb.js"><link rel="prefetch" href="/rat-summ/assets/js/135.77d5837d.js"><link rel="prefetch" href="/rat-summ/assets/js/136.f276fa7c.js"><link rel="prefetch" href="/rat-summ/assets/js/137.26c2d25c.js"><link rel="prefetch" href="/rat-summ/assets/js/138.7e4b3e8b.js"><link rel="prefetch" href="/rat-summ/assets/js/139.5b8ba084.js"><link rel="prefetch" href="/rat-summ/assets/js/14.8dbffc81.js"><link rel="prefetch" href="/rat-summ/assets/js/140.cebddf00.js"><link rel="prefetch" href="/rat-summ/assets/js/141.93995db1.js"><link rel="prefetch" href="/rat-summ/assets/js/142.ae5cbf85.js"><link rel="prefetch" href="/rat-summ/assets/js/143.dac237e2.js"><link rel="prefetch" href="/rat-summ/assets/js/144.fed101d1.js"><link rel="prefetch" href="/rat-summ/assets/js/145.df2f2e49.js"><link rel="prefetch" href="/rat-summ/assets/js/146.5feac5c1.js"><link rel="prefetch" href="/rat-summ/assets/js/147.0389a873.js"><link rel="prefetch" href="/rat-summ/assets/js/148.d3e8a026.js"><link rel="prefetch" href="/rat-summ/assets/js/149.7efffb81.js"><link rel="prefetch" href="/rat-summ/assets/js/15.8ec7b29e.js"><link rel="prefetch" href="/rat-summ/assets/js/150.fd38d672.js"><link rel="prefetch" href="/rat-summ/assets/js/151.afe3a15d.js"><link rel="prefetch" href="/rat-summ/assets/js/152.9412368d.js"><link rel="prefetch" href="/rat-summ/assets/js/153.7d3adbef.js"><link rel="prefetch" href="/rat-summ/assets/js/154.e3448ffd.js"><link rel="prefetch" href="/rat-summ/assets/js/155.0f81c9f4.js"><link rel="prefetch" href="/rat-summ/assets/js/156.c7bd68bf.js"><link rel="prefetch" href="/rat-summ/assets/js/157.d4cf6362.js"><link rel="prefetch" href="/rat-summ/assets/js/158.9d23effb.js"><link rel="prefetch" href="/rat-summ/assets/js/159.03c2fc1f.js"><link rel="prefetch" href="/rat-summ/assets/js/16.d97cc4b2.js"><link rel="prefetch" href="/rat-summ/assets/js/160.a3697128.js"><link rel="prefetch" href="/rat-summ/assets/js/161.ceef51ed.js"><link rel="prefetch" href="/rat-summ/assets/js/162.5a415671.js"><link rel="prefetch" href="/rat-summ/assets/js/163.cb7f48e0.js"><link rel="prefetch" href="/rat-summ/assets/js/164.22d1a032.js"><link rel="prefetch" href="/rat-summ/assets/js/165.d36b06fe.js"><link rel="prefetch" href="/rat-summ/assets/js/166.5562cf71.js"><link rel="prefetch" href="/rat-summ/assets/js/167.f2f53141.js"><link rel="prefetch" href="/rat-summ/assets/js/168.d1764292.js"><link rel="prefetch" href="/rat-summ/assets/js/169.71c1b376.js"><link rel="prefetch" href="/rat-summ/assets/js/17.974c76b3.js"><link rel="prefetch" href="/rat-summ/assets/js/170.a1844c75.js"><link rel="prefetch" href="/rat-summ/assets/js/171.8bd11d6b.js"><link rel="prefetch" href="/rat-summ/assets/js/172.630472f7.js"><link rel="prefetch" href="/rat-summ/assets/js/173.9f780f02.js"><link rel="prefetch" href="/rat-summ/assets/js/174.3903a474.js"><link rel="prefetch" href="/rat-summ/assets/js/175.0b55890f.js"><link rel="prefetch" href="/rat-summ/assets/js/176.ebd9da76.js"><link rel="prefetch" href="/rat-summ/assets/js/177.f866bfcc.js"><link rel="prefetch" href="/rat-summ/assets/js/178.9dab120a.js"><link rel="prefetch" href="/rat-summ/assets/js/179.00f175ae.js"><link rel="prefetch" href="/rat-summ/assets/js/18.f1a4f7b2.js"><link rel="prefetch" href="/rat-summ/assets/js/180.fd45856c.js"><link rel="prefetch" href="/rat-summ/assets/js/181.1f9f05a8.js"><link rel="prefetch" href="/rat-summ/assets/js/182.dec7bce8.js"><link rel="prefetch" href="/rat-summ/assets/js/183.ee99d36c.js"><link rel="prefetch" href="/rat-summ/assets/js/184.873055ff.js"><link rel="prefetch" href="/rat-summ/assets/js/185.836db06c.js"><link rel="prefetch" href="/rat-summ/assets/js/186.ed2b2aa0.js"><link rel="prefetch" href="/rat-summ/assets/js/187.f55e617d.js"><link rel="prefetch" href="/rat-summ/assets/js/188.ffd267f6.js"><link rel="prefetch" href="/rat-summ/assets/js/189.0777dab4.js"><link rel="prefetch" href="/rat-summ/assets/js/19.edc5370a.js"><link rel="prefetch" href="/rat-summ/assets/js/190.37c6eb5c.js"><link rel="prefetch" href="/rat-summ/assets/js/191.e2148011.js"><link rel="prefetch" href="/rat-summ/assets/js/192.74b5350b.js"><link rel="prefetch" href="/rat-summ/assets/js/193.92639440.js"><link rel="prefetch" href="/rat-summ/assets/js/194.07a698d3.js"><link rel="prefetch" href="/rat-summ/assets/js/195.d9d05ac9.js"><link rel="prefetch" href="/rat-summ/assets/js/196.893ea875.js"><link rel="prefetch" href="/rat-summ/assets/js/197.faf002df.js"><link rel="prefetch" href="/rat-summ/assets/js/198.e9af0cc8.js"><link rel="prefetch" href="/rat-summ/assets/js/199.78a32edd.js"><link rel="prefetch" href="/rat-summ/assets/js/2.7c04700d.js"><link rel="prefetch" href="/rat-summ/assets/js/20.33603afe.js"><link rel="prefetch" href="/rat-summ/assets/js/200.d1cec810.js"><link rel="prefetch" href="/rat-summ/assets/js/201.de6d878d.js"><link rel="prefetch" href="/rat-summ/assets/js/202.cdb07eb9.js"><link rel="prefetch" href="/rat-summ/assets/js/203.f82a15e9.js"><link rel="prefetch" href="/rat-summ/assets/js/205.ebfd1b03.js"><link rel="prefetch" href="/rat-summ/assets/js/206.9322b908.js"><link rel="prefetch" href="/rat-summ/assets/js/207.b611c8e4.js"><link rel="prefetch" href="/rat-summ/assets/js/208.b56c09a4.js"><link rel="prefetch" href="/rat-summ/assets/js/209.5fa250ae.js"><link rel="prefetch" href="/rat-summ/assets/js/21.e361060e.js"><link rel="prefetch" href="/rat-summ/assets/js/210.afb67c23.js"><link rel="prefetch" href="/rat-summ/assets/js/211.975d8a93.js"><link rel="prefetch" href="/rat-summ/assets/js/212.e6114672.js"><link rel="prefetch" href="/rat-summ/assets/js/213.dcc0418e.js"><link rel="prefetch" href="/rat-summ/assets/js/214.b34c4a78.js"><link rel="prefetch" href="/rat-summ/assets/js/215.46240575.js"><link rel="prefetch" href="/rat-summ/assets/js/216.4fcc46c0.js"><link rel="prefetch" href="/rat-summ/assets/js/217.a2791aae.js"><link rel="prefetch" href="/rat-summ/assets/js/218.4c256ceb.js"><link rel="prefetch" href="/rat-summ/assets/js/219.a943095e.js"><link rel="prefetch" href="/rat-summ/assets/js/22.483a320b.js"><link rel="prefetch" href="/rat-summ/assets/js/220.9fc9ad7e.js"><link rel="prefetch" href="/rat-summ/assets/js/221.cbc0e78d.js"><link rel="prefetch" href="/rat-summ/assets/js/222.191f7e78.js"><link rel="prefetch" href="/rat-summ/assets/js/223.2f2104da.js"><link rel="prefetch" href="/rat-summ/assets/js/224.a96291e3.js"><link rel="prefetch" href="/rat-summ/assets/js/225.5e7d4a2f.js"><link rel="prefetch" href="/rat-summ/assets/js/226.f2c52aeb.js"><link rel="prefetch" href="/rat-summ/assets/js/227.29ce8f1e.js"><link rel="prefetch" href="/rat-summ/assets/js/228.606fc221.js"><link rel="prefetch" href="/rat-summ/assets/js/229.35c0193b.js"><link rel="prefetch" href="/rat-summ/assets/js/23.ea56380f.js"><link rel="prefetch" href="/rat-summ/assets/js/230.c18c39ff.js"><link rel="prefetch" href="/rat-summ/assets/js/231.8ac9de68.js"><link rel="prefetch" href="/rat-summ/assets/js/232.a37a54cf.js"><link rel="prefetch" href="/rat-summ/assets/js/233.2d63ab61.js"><link rel="prefetch" href="/rat-summ/assets/js/234.bb2f44c1.js"><link rel="prefetch" href="/rat-summ/assets/js/235.6b07773d.js"><link rel="prefetch" href="/rat-summ/assets/js/236.d9377791.js"><link rel="prefetch" href="/rat-summ/assets/js/237.9cae90d9.js"><link rel="prefetch" href="/rat-summ/assets/js/238.fc5c2f17.js"><link rel="prefetch" href="/rat-summ/assets/js/239.b69acdbe.js"><link rel="prefetch" href="/rat-summ/assets/js/24.8165c81c.js"><link rel="prefetch" href="/rat-summ/assets/js/240.2998122f.js"><link rel="prefetch" href="/rat-summ/assets/js/241.dfd9d735.js"><link rel="prefetch" href="/rat-summ/assets/js/242.6d57d6b1.js"><link rel="prefetch" href="/rat-summ/assets/js/243.39bb5753.js"><link rel="prefetch" href="/rat-summ/assets/js/244.37f91d9e.js"><link rel="prefetch" href="/rat-summ/assets/js/245.710a3e10.js"><link rel="prefetch" href="/rat-summ/assets/js/246.680ed8ab.js"><link rel="prefetch" href="/rat-summ/assets/js/247.7ea05ed5.js"><link rel="prefetch" href="/rat-summ/assets/js/248.e76a424e.js"><link rel="prefetch" href="/rat-summ/assets/js/249.7c88f5bc.js"><link rel="prefetch" href="/rat-summ/assets/js/25.def02ca5.js"><link rel="prefetch" href="/rat-summ/assets/js/250.4569c567.js"><link rel="prefetch" href="/rat-summ/assets/js/251.878e4926.js"><link rel="prefetch" href="/rat-summ/assets/js/252.67d9ba84.js"><link rel="prefetch" href="/rat-summ/assets/js/253.82ca1732.js"><link rel="prefetch" href="/rat-summ/assets/js/254.27dbadc2.js"><link rel="prefetch" href="/rat-summ/assets/js/255.60f68a5f.js"><link rel="prefetch" href="/rat-summ/assets/js/256.b47e4d3f.js"><link rel="prefetch" href="/rat-summ/assets/js/257.0df59c99.js"><link rel="prefetch" href="/rat-summ/assets/js/258.130b0487.js"><link rel="prefetch" href="/rat-summ/assets/js/259.97887542.js"><link rel="prefetch" href="/rat-summ/assets/js/26.97b1d951.js"><link rel="prefetch" href="/rat-summ/assets/js/260.6dac92fb.js"><link rel="prefetch" href="/rat-summ/assets/js/261.af516821.js"><link rel="prefetch" href="/rat-summ/assets/js/262.ef9f9b6a.js"><link rel="prefetch" href="/rat-summ/assets/js/263.dcc5eb79.js"><link rel="prefetch" href="/rat-summ/assets/js/264.61ce928d.js"><link rel="prefetch" href="/rat-summ/assets/js/265.82cb28d2.js"><link rel="prefetch" href="/rat-summ/assets/js/266.9eb89497.js"><link rel="prefetch" href="/rat-summ/assets/js/267.99284b0c.js"><link rel="prefetch" href="/rat-summ/assets/js/268.82dfc492.js"><link rel="prefetch" href="/rat-summ/assets/js/269.6cac85a2.js"><link rel="prefetch" href="/rat-summ/assets/js/27.c1905c39.js"><link rel="prefetch" href="/rat-summ/assets/js/270.69da763d.js"><link rel="prefetch" href="/rat-summ/assets/js/271.bbbb2115.js"><link rel="prefetch" href="/rat-summ/assets/js/272.ff0f601d.js"><link rel="prefetch" href="/rat-summ/assets/js/273.0f3d1f43.js"><link rel="prefetch" href="/rat-summ/assets/js/274.de951754.js"><link rel="prefetch" href="/rat-summ/assets/js/275.36fcef7b.js"><link rel="prefetch" href="/rat-summ/assets/js/276.0f69e2d6.js"><link rel="prefetch" href="/rat-summ/assets/js/277.6116c28b.js"><link rel="prefetch" href="/rat-summ/assets/js/278.3ec4a543.js"><link rel="prefetch" href="/rat-summ/assets/js/279.79cacba3.js"><link rel="prefetch" href="/rat-summ/assets/js/28.29769ec1.js"><link rel="prefetch" href="/rat-summ/assets/js/280.67eae4c9.js"><link rel="prefetch" href="/rat-summ/assets/js/281.6454a6a5.js"><link rel="prefetch" href="/rat-summ/assets/js/282.de2ce91b.js"><link rel="prefetch" href="/rat-summ/assets/js/283.82e0f4ca.js"><link rel="prefetch" href="/rat-summ/assets/js/284.69abfc0e.js"><link rel="prefetch" href="/rat-summ/assets/js/285.558435fb.js"><link rel="prefetch" href="/rat-summ/assets/js/286.fa4f4e4a.js"><link rel="prefetch" href="/rat-summ/assets/js/287.8f22a85e.js"><link rel="prefetch" href="/rat-summ/assets/js/288.d36804d8.js"><link rel="prefetch" href="/rat-summ/assets/js/289.992bf452.js"><link rel="prefetch" href="/rat-summ/assets/js/29.bc17da71.js"><link rel="prefetch" href="/rat-summ/assets/js/290.d217e3d5.js"><link rel="prefetch" href="/rat-summ/assets/js/291.0108ca07.js"><link rel="prefetch" href="/rat-summ/assets/js/292.c1cf5376.js"><link rel="prefetch" href="/rat-summ/assets/js/293.55852ed3.js"><link rel="prefetch" href="/rat-summ/assets/js/294.709d66f6.js"><link rel="prefetch" href="/rat-summ/assets/js/295.e8eb94ac.js"><link rel="prefetch" href="/rat-summ/assets/js/296.ffbcc931.js"><link rel="prefetch" href="/rat-summ/assets/js/297.7048aea4.js"><link rel="prefetch" href="/rat-summ/assets/js/298.9cd565b1.js"><link rel="prefetch" href="/rat-summ/assets/js/299.8e2896d9.js"><link rel="prefetch" href="/rat-summ/assets/js/30.e0901edb.js"><link rel="prefetch" href="/rat-summ/assets/js/300.1ba977f6.js"><link rel="prefetch" href="/rat-summ/assets/js/301.4bd8028d.js"><link rel="prefetch" href="/rat-summ/assets/js/302.7e3656f6.js"><link rel="prefetch" href="/rat-summ/assets/js/303.5fa30d30.js"><link rel="prefetch" href="/rat-summ/assets/js/304.0bb8668c.js"><link rel="prefetch" href="/rat-summ/assets/js/305.61286ea3.js"><link rel="prefetch" href="/rat-summ/assets/js/306.6e1b897f.js"><link rel="prefetch" href="/rat-summ/assets/js/307.f11f9af6.js"><link rel="prefetch" href="/rat-summ/assets/js/308.83cfb59e.js"><link rel="prefetch" href="/rat-summ/assets/js/309.88606eb8.js"><link rel="prefetch" href="/rat-summ/assets/js/31.727deefc.js"><link rel="prefetch" href="/rat-summ/assets/js/310.ca3c4062.js"><link rel="prefetch" href="/rat-summ/assets/js/311.9c98aab5.js"><link rel="prefetch" href="/rat-summ/assets/js/312.f5d5917b.js"><link rel="prefetch" href="/rat-summ/assets/js/313.6a0d74b5.js"><link rel="prefetch" href="/rat-summ/assets/js/314.351731a0.js"><link rel="prefetch" href="/rat-summ/assets/js/315.1bceaee4.js"><link rel="prefetch" href="/rat-summ/assets/js/316.91d9bb5c.js"><link rel="prefetch" href="/rat-summ/assets/js/317.43a7c8e3.js"><link rel="prefetch" href="/rat-summ/assets/js/318.f91f4e5e.js"><link rel="prefetch" href="/rat-summ/assets/js/319.03048efe.js"><link rel="prefetch" href="/rat-summ/assets/js/32.be33afa2.js"><link rel="prefetch" href="/rat-summ/assets/js/320.6c4d6375.js"><link rel="prefetch" href="/rat-summ/assets/js/321.c0f4c466.js"><link rel="prefetch" href="/rat-summ/assets/js/322.40427a9f.js"><link rel="prefetch" href="/rat-summ/assets/js/323.8ed5a81e.js"><link rel="prefetch" href="/rat-summ/assets/js/324.8af7bf04.js"><link rel="prefetch" href="/rat-summ/assets/js/325.eb380a4f.js"><link rel="prefetch" href="/rat-summ/assets/js/326.6b704e5c.js"><link rel="prefetch" href="/rat-summ/assets/js/327.ee41c7c2.js"><link rel="prefetch" href="/rat-summ/assets/js/328.c50090e6.js"><link rel="prefetch" href="/rat-summ/assets/js/329.b7234454.js"><link rel="prefetch" href="/rat-summ/assets/js/33.a5387702.js"><link rel="prefetch" href="/rat-summ/assets/js/330.0b389f14.js"><link rel="prefetch" href="/rat-summ/assets/js/331.ebc829ce.js"><link rel="prefetch" href="/rat-summ/assets/js/332.3dbd0d43.js"><link rel="prefetch" href="/rat-summ/assets/js/333.2ad93411.js"><link rel="prefetch" href="/rat-summ/assets/js/334.19c4fca0.js"><link rel="prefetch" href="/rat-summ/assets/js/335.618d7f92.js"><link rel="prefetch" href="/rat-summ/assets/js/336.06b12de2.js"><link rel="prefetch" href="/rat-summ/assets/js/337.dfb91030.js"><link rel="prefetch" href="/rat-summ/assets/js/338.fbf6c528.js"><link rel="prefetch" href="/rat-summ/assets/js/339.081585fe.js"><link rel="prefetch" href="/rat-summ/assets/js/34.2aa94fce.js"><link rel="prefetch" href="/rat-summ/assets/js/340.392a0549.js"><link rel="prefetch" href="/rat-summ/assets/js/341.571be598.js"><link rel="prefetch" href="/rat-summ/assets/js/342.0c20e7dc.js"><link rel="prefetch" href="/rat-summ/assets/js/343.f087f4bc.js"><link rel="prefetch" href="/rat-summ/assets/js/344.432ae94b.js"><link rel="prefetch" href="/rat-summ/assets/js/345.5d1f52c2.js"><link rel="prefetch" href="/rat-summ/assets/js/346.29082c3e.js"><link rel="prefetch" href="/rat-summ/assets/js/347.5431d43a.js"><link rel="prefetch" href="/rat-summ/assets/js/348.70a115c6.js"><link rel="prefetch" href="/rat-summ/assets/js/349.110d3aea.js"><link rel="prefetch" href="/rat-summ/assets/js/35.3926e73e.js"><link rel="prefetch" href="/rat-summ/assets/js/350.4dd299b8.js"><link rel="prefetch" href="/rat-summ/assets/js/351.aa1cf3a7.js"><link rel="prefetch" href="/rat-summ/assets/js/352.f2c9aff8.js"><link rel="prefetch" href="/rat-summ/assets/js/353.bb0da04a.js"><link rel="prefetch" href="/rat-summ/assets/js/354.7b1fde0d.js"><link rel="prefetch" href="/rat-summ/assets/js/355.7c67d056.js"><link rel="prefetch" href="/rat-summ/assets/js/356.a2f3c163.js"><link rel="prefetch" href="/rat-summ/assets/js/357.4aa2a57f.js"><link rel="prefetch" href="/rat-summ/assets/js/358.7abdc16b.js"><link rel="prefetch" href="/rat-summ/assets/js/359.0acb9993.js"><link rel="prefetch" href="/rat-summ/assets/js/36.e9252af1.js"><link rel="prefetch" href="/rat-summ/assets/js/360.077f565b.js"><link rel="prefetch" href="/rat-summ/assets/js/361.7d044219.js"><link rel="prefetch" href="/rat-summ/assets/js/362.6d5271d3.js"><link rel="prefetch" href="/rat-summ/assets/js/363.52b56886.js"><link rel="prefetch" href="/rat-summ/assets/js/364.6f2d9945.js"><link rel="prefetch" href="/rat-summ/assets/js/365.25fd0aec.js"><link rel="prefetch" href="/rat-summ/assets/js/366.8697c537.js"><link rel="prefetch" href="/rat-summ/assets/js/367.ade10048.js"><link rel="prefetch" href="/rat-summ/assets/js/368.58690662.js"><link rel="prefetch" href="/rat-summ/assets/js/369.e37f17bc.js"><link rel="prefetch" href="/rat-summ/assets/js/37.40c6e32d.js"><link rel="prefetch" href="/rat-summ/assets/js/370.81c0f5c2.js"><link rel="prefetch" href="/rat-summ/assets/js/371.781d9032.js"><link rel="prefetch" href="/rat-summ/assets/js/372.2f75884d.js"><link rel="prefetch" href="/rat-summ/assets/js/373.83a4e2c0.js"><link rel="prefetch" href="/rat-summ/assets/js/374.c1c69154.js"><link rel="prefetch" href="/rat-summ/assets/js/375.4df7a40c.js"><link rel="prefetch" href="/rat-summ/assets/js/376.0feeb93c.js"><link rel="prefetch" href="/rat-summ/assets/js/377.561ca7da.js"><link rel="prefetch" href="/rat-summ/assets/js/378.3da43834.js"><link rel="prefetch" href="/rat-summ/assets/js/379.75c285a8.js"><link rel="prefetch" href="/rat-summ/assets/js/38.e48735ea.js"><link rel="prefetch" href="/rat-summ/assets/js/380.f94bd4a3.js"><link rel="prefetch" href="/rat-summ/assets/js/381.71953594.js"><link rel="prefetch" href="/rat-summ/assets/js/382.944a71d7.js"><link rel="prefetch" href="/rat-summ/assets/js/383.c6a18246.js"><link rel="prefetch" href="/rat-summ/assets/js/384.e089b47b.js"><link rel="prefetch" href="/rat-summ/assets/js/385.91742919.js"><link rel="prefetch" href="/rat-summ/assets/js/386.48e3b2e2.js"><link rel="prefetch" href="/rat-summ/assets/js/387.e29cd861.js"><link rel="prefetch" href="/rat-summ/assets/js/388.f70a74b4.js"><link rel="prefetch" href="/rat-summ/assets/js/389.104fdecf.js"><link rel="prefetch" href="/rat-summ/assets/js/39.825dffc2.js"><link rel="prefetch" href="/rat-summ/assets/js/390.6275cef1.js"><link rel="prefetch" href="/rat-summ/assets/js/391.8bb66679.js"><link rel="prefetch" href="/rat-summ/assets/js/392.3fe296d9.js"><link rel="prefetch" href="/rat-summ/assets/js/393.a4dc5585.js"><link rel="prefetch" href="/rat-summ/assets/js/394.d659930b.js"><link rel="prefetch" href="/rat-summ/assets/js/395.d2262aea.js"><link rel="prefetch" href="/rat-summ/assets/js/396.25b1e0de.js"><link rel="prefetch" href="/rat-summ/assets/js/397.41c6d90f.js"><link rel="prefetch" href="/rat-summ/assets/js/398.1023659d.js"><link rel="prefetch" href="/rat-summ/assets/js/399.6645efbd.js"><link rel="prefetch" href="/rat-summ/assets/js/4.5b220e8a.js"><link rel="prefetch" href="/rat-summ/assets/js/40.1f51dbcf.js"><link rel="prefetch" href="/rat-summ/assets/js/400.a979839c.js"><link rel="prefetch" href="/rat-summ/assets/js/401.3f1af38a.js"><link rel="prefetch" href="/rat-summ/assets/js/402.17ee8256.js"><link rel="prefetch" href="/rat-summ/assets/js/403.e5dd7606.js"><link rel="prefetch" href="/rat-summ/assets/js/404.b57e2cc6.js"><link rel="prefetch" href="/rat-summ/assets/js/405.2042fa73.js"><link rel="prefetch" href="/rat-summ/assets/js/406.e64bdb23.js"><link rel="prefetch" href="/rat-summ/assets/js/407.9a276c18.js"><link rel="prefetch" href="/rat-summ/assets/js/408.a528edd8.js"><link rel="prefetch" href="/rat-summ/assets/js/409.dba4cf75.js"><link rel="prefetch" href="/rat-summ/assets/js/41.58f3de48.js"><link rel="prefetch" href="/rat-summ/assets/js/410.d0b106c6.js"><link rel="prefetch" href="/rat-summ/assets/js/411.4b9dd0be.js"><link rel="prefetch" href="/rat-summ/assets/js/412.d2b4534c.js"><link rel="prefetch" href="/rat-summ/assets/js/413.13933934.js"><link rel="prefetch" href="/rat-summ/assets/js/414.f3aa79b3.js"><link rel="prefetch" href="/rat-summ/assets/js/415.7fb4f462.js"><link rel="prefetch" href="/rat-summ/assets/js/416.529de55d.js"><link rel="prefetch" href="/rat-summ/assets/js/417.4ca243c1.js"><link rel="prefetch" href="/rat-summ/assets/js/418.3c7e6391.js"><link rel="prefetch" href="/rat-summ/assets/js/419.821db849.js"><link rel="prefetch" href="/rat-summ/assets/js/42.1f57183a.js"><link rel="prefetch" href="/rat-summ/assets/js/420.4153e14c.js"><link rel="prefetch" href="/rat-summ/assets/js/421.94820f33.js"><link rel="prefetch" href="/rat-summ/assets/js/422.b85144cb.js"><link rel="prefetch" href="/rat-summ/assets/js/423.5702fec2.js"><link rel="prefetch" href="/rat-summ/assets/js/424.f3bb53f3.js"><link rel="prefetch" href="/rat-summ/assets/js/425.a09dac6c.js"><link rel="prefetch" href="/rat-summ/assets/js/426.5e7ea56d.js"><link rel="prefetch" href="/rat-summ/assets/js/427.dfe1e1f5.js"><link rel="prefetch" href="/rat-summ/assets/js/428.8829fe2e.js"><link rel="prefetch" href="/rat-summ/assets/js/429.206cbd26.js"><link rel="prefetch" href="/rat-summ/assets/js/43.f4ef7e7a.js"><link rel="prefetch" href="/rat-summ/assets/js/430.2e934b92.js"><link rel="prefetch" href="/rat-summ/assets/js/431.93b96b64.js"><link rel="prefetch" href="/rat-summ/assets/js/432.5742508e.js"><link rel="prefetch" href="/rat-summ/assets/js/433.602400bb.js"><link rel="prefetch" href="/rat-summ/assets/js/434.3c068b74.js"><link rel="prefetch" href="/rat-summ/assets/js/435.bd23ba01.js"><link rel="prefetch" href="/rat-summ/assets/js/436.f276df3f.js"><link rel="prefetch" href="/rat-summ/assets/js/437.e3136874.js"><link rel="prefetch" href="/rat-summ/assets/js/438.365bddbf.js"><link rel="prefetch" href="/rat-summ/assets/js/439.8610d147.js"><link rel="prefetch" href="/rat-summ/assets/js/44.95428610.js"><link rel="prefetch" href="/rat-summ/assets/js/440.d470a96c.js"><link rel="prefetch" href="/rat-summ/assets/js/441.51e68998.js"><link rel="prefetch" href="/rat-summ/assets/js/442.21942f8f.js"><link rel="prefetch" href="/rat-summ/assets/js/443.d78b7124.js"><link rel="prefetch" href="/rat-summ/assets/js/444.7ab2a2ce.js"><link rel="prefetch" href="/rat-summ/assets/js/445.734e537c.js"><link rel="prefetch" href="/rat-summ/assets/js/446.b6a46bba.js"><link rel="prefetch" href="/rat-summ/assets/js/447.0e610df1.js"><link rel="prefetch" href="/rat-summ/assets/js/448.c431addf.js"><link rel="prefetch" href="/rat-summ/assets/js/449.fd3f57c4.js"><link rel="prefetch" href="/rat-summ/assets/js/45.2f49bb0c.js"><link rel="prefetch" href="/rat-summ/assets/js/450.488cf3df.js"><link rel="prefetch" href="/rat-summ/assets/js/451.1812acf0.js"><link rel="prefetch" href="/rat-summ/assets/js/452.b9e98643.js"><link rel="prefetch" href="/rat-summ/assets/js/453.3a90612b.js"><link rel="prefetch" href="/rat-summ/assets/js/454.5aaa7797.js"><link rel="prefetch" href="/rat-summ/assets/js/455.0f8b8d13.js"><link rel="prefetch" href="/rat-summ/assets/js/456.6973979f.js"><link rel="prefetch" href="/rat-summ/assets/js/457.3cb9217b.js"><link rel="prefetch" href="/rat-summ/assets/js/458.79141a21.js"><link rel="prefetch" href="/rat-summ/assets/js/459.abcc974c.js"><link rel="prefetch" href="/rat-summ/assets/js/46.8c8bf5f1.js"><link rel="prefetch" href="/rat-summ/assets/js/460.b38c1ada.js"><link rel="prefetch" href="/rat-summ/assets/js/461.62beb08c.js"><link rel="prefetch" href="/rat-summ/assets/js/462.64f5f4e1.js"><link rel="prefetch" href="/rat-summ/assets/js/463.83081d34.js"><link rel="prefetch" href="/rat-summ/assets/js/464.d610e5ce.js"><link rel="prefetch" href="/rat-summ/assets/js/465.193b3b89.js"><link rel="prefetch" href="/rat-summ/assets/js/466.419fe212.js"><link rel="prefetch" href="/rat-summ/assets/js/467.910dc67d.js"><link rel="prefetch" href="/rat-summ/assets/js/468.b93c4e70.js"><link rel="prefetch" href="/rat-summ/assets/js/469.a4bc872a.js"><link rel="prefetch" href="/rat-summ/assets/js/47.11f3cc99.js"><link rel="prefetch" href="/rat-summ/assets/js/470.477c2897.js"><link rel="prefetch" href="/rat-summ/assets/js/471.abfff3cd.js"><link rel="prefetch" href="/rat-summ/assets/js/472.b8aea607.js"><link rel="prefetch" href="/rat-summ/assets/js/473.f6d4bd02.js"><link rel="prefetch" href="/rat-summ/assets/js/474.9449d59a.js"><link rel="prefetch" href="/rat-summ/assets/js/475.8a4bbfb6.js"><link rel="prefetch" href="/rat-summ/assets/js/476.0269ac30.js"><link rel="prefetch" href="/rat-summ/assets/js/477.3bcc01f0.js"><link rel="prefetch" href="/rat-summ/assets/js/478.c307cee9.js"><link rel="prefetch" href="/rat-summ/assets/js/479.c70c4a8e.js"><link rel="prefetch" href="/rat-summ/assets/js/48.05e97651.js"><link rel="prefetch" href="/rat-summ/assets/js/480.ac7405da.js"><link rel="prefetch" href="/rat-summ/assets/js/481.04261af4.js"><link rel="prefetch" href="/rat-summ/assets/js/482.7db8d1e2.js"><link rel="prefetch" href="/rat-summ/assets/js/483.ba568078.js"><link rel="prefetch" href="/rat-summ/assets/js/484.48a25747.js"><link rel="prefetch" href="/rat-summ/assets/js/485.d26a0a83.js"><link rel="prefetch" href="/rat-summ/assets/js/486.a50b2468.js"><link rel="prefetch" href="/rat-summ/assets/js/487.89c199d5.js"><link rel="prefetch" href="/rat-summ/assets/js/488.11ffda69.js"><link rel="prefetch" href="/rat-summ/assets/js/489.f410761e.js"><link rel="prefetch" href="/rat-summ/assets/js/49.4f8217ba.js"><link rel="prefetch" href="/rat-summ/assets/js/490.1d754006.js"><link rel="prefetch" href="/rat-summ/assets/js/491.80c5139a.js"><link rel="prefetch" href="/rat-summ/assets/js/492.d29884ed.js"><link rel="prefetch" href="/rat-summ/assets/js/493.605b5b69.js"><link rel="prefetch" href="/rat-summ/assets/js/494.cf11b24a.js"><link rel="prefetch" href="/rat-summ/assets/js/495.4fed3a56.js"><link rel="prefetch" href="/rat-summ/assets/js/496.2f9b5653.js"><link rel="prefetch" href="/rat-summ/assets/js/497.bdf700cb.js"><link rel="prefetch" href="/rat-summ/assets/js/498.c37bf4a0.js"><link rel="prefetch" href="/rat-summ/assets/js/499.273512ce.js"><link rel="prefetch" href="/rat-summ/assets/js/5.eb8a0105.js"><link rel="prefetch" href="/rat-summ/assets/js/50.8b43ef9b.js"><link rel="prefetch" href="/rat-summ/assets/js/500.41ab926a.js"><link rel="prefetch" href="/rat-summ/assets/js/501.b7e68b2b.js"><link rel="prefetch" href="/rat-summ/assets/js/502.c21b2ced.js"><link rel="prefetch" href="/rat-summ/assets/js/503.57cfc1cb.js"><link rel="prefetch" href="/rat-summ/assets/js/504.3737dd74.js"><link rel="prefetch" href="/rat-summ/assets/js/505.1a6e2c5c.js"><link rel="prefetch" href="/rat-summ/assets/js/506.bec8c785.js"><link rel="prefetch" href="/rat-summ/assets/js/507.9850a1ea.js"><link rel="prefetch" href="/rat-summ/assets/js/508.345fb54a.js"><link rel="prefetch" href="/rat-summ/assets/js/509.12b14128.js"><link rel="prefetch" href="/rat-summ/assets/js/51.6837cba4.js"><link rel="prefetch" href="/rat-summ/assets/js/510.0595d708.js"><link rel="prefetch" href="/rat-summ/assets/js/511.9ebeed80.js"><link rel="prefetch" href="/rat-summ/assets/js/512.a4b26565.js"><link rel="prefetch" href="/rat-summ/assets/js/513.dae12896.js"><link rel="prefetch" href="/rat-summ/assets/js/514.98452f74.js"><link rel="prefetch" href="/rat-summ/assets/js/515.79ac850c.js"><link rel="prefetch" href="/rat-summ/assets/js/516.2b46c6b5.js"><link rel="prefetch" href="/rat-summ/assets/js/517.21cae069.js"><link rel="prefetch" href="/rat-summ/assets/js/518.618ba011.js"><link rel="prefetch" href="/rat-summ/assets/js/519.d295be6f.js"><link rel="prefetch" href="/rat-summ/assets/js/52.6a3d1870.js"><link rel="prefetch" href="/rat-summ/assets/js/520.77322b7a.js"><link rel="prefetch" href="/rat-summ/assets/js/521.ab51a9d7.js"><link rel="prefetch" href="/rat-summ/assets/js/522.95569e5d.js"><link rel="prefetch" href="/rat-summ/assets/js/523.19e88a87.js"><link rel="prefetch" href="/rat-summ/assets/js/524.a9f13ff4.js"><link rel="prefetch" href="/rat-summ/assets/js/525.55775443.js"><link rel="prefetch" href="/rat-summ/assets/js/526.796f403d.js"><link rel="prefetch" href="/rat-summ/assets/js/527.8777ce49.js"><link rel="prefetch" href="/rat-summ/assets/js/528.fdc61407.js"><link rel="prefetch" href="/rat-summ/assets/js/529.410e276b.js"><link rel="prefetch" href="/rat-summ/assets/js/53.73686482.js"><link rel="prefetch" href="/rat-summ/assets/js/530.f4fc62f0.js"><link rel="prefetch" href="/rat-summ/assets/js/531.58338ca6.js"><link rel="prefetch" href="/rat-summ/assets/js/54.b4f9eb75.js"><link rel="prefetch" href="/rat-summ/assets/js/55.df849147.js"><link rel="prefetch" href="/rat-summ/assets/js/56.96d53eac.js"><link rel="prefetch" href="/rat-summ/assets/js/57.f19e0377.js"><link rel="prefetch" href="/rat-summ/assets/js/58.46887073.js"><link rel="prefetch" href="/rat-summ/assets/js/59.3f235b14.js"><link rel="prefetch" href="/rat-summ/assets/js/6.0306f3a7.js"><link rel="prefetch" href="/rat-summ/assets/js/60.f00dba60.js"><link rel="prefetch" href="/rat-summ/assets/js/61.110e9966.js"><link rel="prefetch" href="/rat-summ/assets/js/62.77adea85.js"><link rel="prefetch" href="/rat-summ/assets/js/63.84621a5a.js"><link rel="prefetch" href="/rat-summ/assets/js/64.c5e5007f.js"><link rel="prefetch" href="/rat-summ/assets/js/65.7932d639.js"><link rel="prefetch" href="/rat-summ/assets/js/66.f7b98c28.js"><link rel="prefetch" href="/rat-summ/assets/js/67.f73aa713.js"><link rel="prefetch" href="/rat-summ/assets/js/68.cd494063.js"><link rel="prefetch" href="/rat-summ/assets/js/69.b044b142.js"><link rel="prefetch" href="/rat-summ/assets/js/7.3eb2e5f4.js"><link rel="prefetch" href="/rat-summ/assets/js/70.fde8898d.js"><link rel="prefetch" href="/rat-summ/assets/js/71.9f0111ee.js"><link rel="prefetch" href="/rat-summ/assets/js/72.a980e88b.js"><link rel="prefetch" href="/rat-summ/assets/js/73.f83a1246.js"><link rel="prefetch" href="/rat-summ/assets/js/74.466aeb6d.js"><link rel="prefetch" href="/rat-summ/assets/js/75.8267a967.js"><link rel="prefetch" href="/rat-summ/assets/js/76.d627aaef.js"><link rel="prefetch" href="/rat-summ/assets/js/77.7f0d7168.js"><link rel="prefetch" href="/rat-summ/assets/js/78.1793ccbe.js"><link rel="prefetch" href="/rat-summ/assets/js/79.482c515e.js"><link rel="prefetch" href="/rat-summ/assets/js/8.79d1c3bb.js"><link rel="prefetch" href="/rat-summ/assets/js/80.3915b314.js"><link rel="prefetch" href="/rat-summ/assets/js/81.b8ec0fa5.js"><link rel="prefetch" href="/rat-summ/assets/js/82.dc9885a7.js"><link rel="prefetch" href="/rat-summ/assets/js/83.2d36b6a8.js"><link rel="prefetch" href="/rat-summ/assets/js/84.0ee5beb0.js"><link rel="prefetch" href="/rat-summ/assets/js/85.adac7d72.js"><link rel="prefetch" href="/rat-summ/assets/js/86.d7ed3e20.js"><link rel="prefetch" href="/rat-summ/assets/js/87.93bc5012.js"><link rel="prefetch" href="/rat-summ/assets/js/88.13a7244f.js"><link rel="prefetch" href="/rat-summ/assets/js/89.5512fba5.js"><link rel="prefetch" href="/rat-summ/assets/js/9.9db0e627.js"><link rel="prefetch" href="/rat-summ/assets/js/90.0d36bb3b.js"><link rel="prefetch" href="/rat-summ/assets/js/91.3b31c7ee.js"><link rel="prefetch" href="/rat-summ/assets/js/92.01af09c3.js"><link rel="prefetch" href="/rat-summ/assets/js/93.c98fe6f4.js"><link rel="prefetch" href="/rat-summ/assets/js/94.23a6678b.js"><link rel="prefetch" href="/rat-summ/assets/js/95.c50f9e7e.js"><link rel="prefetch" href="/rat-summ/assets/js/96.36897011.js"><link rel="prefetch" href="/rat-summ/assets/js/97.dead9357.js"><link rel="prefetch" href="/rat-summ/assets/js/98.e487ff01.js"><link rel="prefetch" href="/rat-summ/assets/js/99.2474b24c.js">
    <link rel="stylesheet" href="/rat-summ/assets/css/0.styles.b7fb6ee3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rat-summ/" class="home-link router-link-active"><img src="/rat-summ/img/logo.png" alt="写作认知体系" class="logo"> <span class="site-name can-hide">写作认知体系</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rat-summ/" class="nav-link">首页</a></div><div class="nav-item"><a href="/rat-summ/writeRead/" class="nav-link">写作阅读</a></div><div class="nav-item"><a href="/rat-summ/promoteOper/" class="nav-link">推广运营</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="💖职场技能" class="dropdown-title"><a href="/rat-summ/workSkill/" class="link-title">💖职场技能</a> <span class="title" style="display:none;">💖职场技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rat-summ/skill-note/" class="nav-link">技能记录</a></li><li class="dropdown-item"><!----> <a href="/rat-summ/skill-inter/" class="nav-link">面试技巧</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌹快捷入口" class="dropdown-title"><!----> <span class="title" style="display:;">🌹快捷入口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>快捷链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/rat-summ/pages/devLink/" class="nav-link">开发收藏</a></li></ul></li><li class="dropdown-item"><h4>💖体系入口</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-skill" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工作实践体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-summ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  写作认知体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-invest" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投资理财体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/samyzh/rat-summ" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/rat-summ/" class="nav-link">首页</a></div><div class="nav-item"><a href="/rat-summ/writeRead/" class="nav-link">写作阅读</a></div><div class="nav-item"><a href="/rat-summ/promoteOper/" class="nav-link">推广运营</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="💖职场技能" class="dropdown-title"><a href="/rat-summ/workSkill/" class="link-title">💖职场技能</a> <span class="title" style="display:none;">💖职场技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rat-summ/skill-note/" class="nav-link">技能记录</a></li><li class="dropdown-item"><!----> <a href="/rat-summ/skill-inter/" class="nav-link">面试技巧</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🌹快捷入口" class="dropdown-title"><!----> <span class="title" style="display:;">🌹快捷入口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>快捷链接</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/rat-summ/pages/devLink/" class="nav-link">开发收藏</a></li></ul></li><li class="dropdown-item"><h4>💖体系入口</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-skill" target="_blank" rel="noopener noreferrer" class="nav-link external">
  工作实践体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-summ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  写作认知体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://my.samyz.cn/rat-invest" target="_blank" rel="noopener noreferrer" class="nav-link external">
  投资理财体系
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/samyzh/rat-summ" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>知识体系</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d299c4/" class="sidebar-link">知识体系</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>html&amp;css</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/59df57/" class="sidebar-link">html的使用</a></li><li><a href="/rat-summ/pages/bfeb1c/" class="sidebar-link">css的使用</a></li><li><a href="/rat-summ/pages/6f569a/" class="sidebar-link">html居中及常用布局</a></li><li><a href="/rat-summ/pages/75c080/" class="sidebar-link">html移动端适配</a></li><li><a href="/rat-summ/pages/1f3ef7/" class="sidebar-link">CSS和JS动画</a></li><li><a href="/rat-summ/pages/445bb3/" class="sidebar-link">html与js的组合使用</a></li><li><a href="/rat-summ/pages/b50ea5/" class="sidebar-link">前端跨页面通信</a></li><li><a href="/rat-summ/pages/91bfa6/" class="sidebar-link">html跨tab页通信(同源跨域)</a></li><li><a href="/rat-summ/pages/975a2e/" class="sidebar-link">cookie常用操作</a></li><li><a href="/rat-summ/pages/b09bd9/" class="sidebar-link">JS中对URL进行转码与解码</a></li><li><a href="/rat-summ/pages/7f7002/" class="sidebar-link">img标注热点分布</a></li><li><a href="/rat-summ/pages/d3dec5/" class="sidebar-link">html中input输入数字控制</a></li><li><a href="/rat-summ/pages/ac76fc/" class="sidebar-link">textarea的换行与空格问题</a></li><li><a href="/rat-summ/pages/59d1b8/" class="sidebar-link">html屏幕相关</a></li><li><a href="/rat-summ/pages/b0b165/" class="sidebar-link">console实用调试技巧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>基础框架</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/1db8ae/" class="sidebar-link">jquery及zepto的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/2e79cd/" class="sidebar-link">html禁止复制文字</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>pwa</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/702634/" class="sidebar-link">pwa基础</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>WebComponent</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/4f2593/" class="sidebar-link">WebComponent基础</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>浏览器渲染</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7027dc/" class="sidebar-link">浏览器渲染机制</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c7ba6e/" class="sidebar-link">左侧树折叠效果</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/80f4c6/" class="sidebar-link">浏览器优化</a></li><li><a href="/rat-summ/pages/01686b/" class="sidebar-link">浏览器渲染原理与性能优化</a></li><li><a href="/rat-summ/pages/a6d3de/" class="sidebar-link">lighthouse实践及分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>样式</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/3b6bc5/" class="sidebar-link">第三方ui库样式重写</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/77c195/" class="sidebar-link">js分类、比较及数组</a></li><li><a href="/rat-summ/pages/8a1238/" class="sidebar-link">js函数</a></li><li><a href="/rat-summ/pages/803bc1/" class="sidebar-link">js对象、class、proxy及Symbol</a></li><li><a href="/rat-summ/pages/c85153/" class="sidebar-link">es6之变量,扩展,symbol,set,map,proxy,reflect及class</a></li><li><a href="/rat-summ/pages/db6ce7/" class="sidebar-link">es6之module,iterator,promise及es6+</a></li><li><a href="/rat-summ/pages/5c649d/" class="sidebar-link">es6中的proxy的使用</a></li><li><a href="/rat-summ/pages/b8e539/" class="sidebar-link">js异步</a></li><li><a href="/rat-summ/pages/2fa04b/" class="sidebar-link">js事件循环及优化</a></li><li><a href="/rat-summ/pages/45b059/" class="sidebar-link">js模块规范</a></li><li><a href="/rat-summ/pages/730656/" class="sidebar-link">数组常用方法</a></li><li><a href="/rat-summ/pages/b887a0/" class="sidebar-link">常用正则表达式提高效率</a></li><li><a href="/rat-summ/pages/c5c2b5/" class="sidebar-link">前端异常的捕获与处理</a></li><li><a href="/rat-summ/pages/c7a8f5/" class="sidebar-link">ES6优化实践</a></li><li><a href="/rat-summ/pages/48ae2c/" class="sidebar-link">ES6-ES12的开发技巧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>进价</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/328e70/" class="sidebar-link">v8内存管理</a></li><li><a href="/rat-summ/pages/71fa00/" class="sidebar-link">js原生方法手写实现</a></li><li><a href="/rat-summ/pages/35e184/" class="sidebar-link">js中手写常用方法</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>网络库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a34b2c/" class="sidebar-link">ajax&amp;axios&amp;fetch对比</a></li><li><a href="/rat-summ/pages/e1382d/" class="sidebar-link">axios分析及实践</a></li><li><a href="/rat-summ/pages/67de0f/" class="sidebar-link">axios文档使用</a></li><li><a href="/rat-summ/pages/5a2414/" class="sidebar-link">fetch处理超时</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>常用库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7349f2/" class="sidebar-link">lodashjs中节流及防抖的实现</a></li><li><a href="/rat-summ/pages/d88e3e/" class="sidebar-link">puppeteer实践及分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/7afb20/" class="sidebar-link">数字取整问题</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/3caff3/" class="sidebar-link">typescript语法及实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c7cd4e/" class="sidebar-link">node版本及源管理</a></li><li><a href="/rat-summ/pages/24c387/" class="sidebar-link">npm常用命令操作</a></li><li><a href="/rat-summ/pages/b9d467/" class="sidebar-link">npm发布及私服搭建</a></li><li><a href="/rat-summ/pages/b23049/" class="sidebar-link">yarn相关总结</a></li><li><a href="/rat-summ/pages/90e3bb/" class="sidebar-link">verdaccio详细设置</a></li><li><a href="/rat-summ/pages/53158b/" class="sidebar-link">nexus布署私有npm仓库</a></li><li><a href="/rat-summ/pages/cc3405/" class="sidebar-link">npm包管理机制</a></li><li><a href="/rat-summ/pages/16031f/" class="sidebar-link">pnpm实践及分析</a></li><li><a href="/rat-summ/pages/68c863/" class="sidebar-link">mac下彻底卸载node和npm</a></li><li><a href="/rat-summ/pages/d4e855/" class="sidebar-link">patch-package修改依赖包</a></li><li><a href="/rat-summ/pages/c886c0/" class="sidebar-link">pnm包管理</a></li><li><a href="/rat-summ/pages/bb9351/" class="sidebar-link">bower包管理</a></li><li><a href="/rat-summ/pages/8a2ca0/" class="sidebar-link">npm-git-bower设置代理</a></li><li><a href="/rat-summ/pages/f51081/" class="sidebar-link">docker下安装nodejs环境</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>node</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f36b82/" class="sidebar-link">index</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/6c90e5/" class="sidebar-link">express基本配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>koa</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/796cbb/" class="sidebar-link">模板引擎ejs</a></li><li><a href="/rat-summ/pages/a340bc/" class="sidebar-link">深入浅出 Koa 的洋葱模型</a></li><li><a href="/rat-summ/pages/41cb0f/" class="sidebar-link">如何更好地理解中间件和洋葱模型</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>egg</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/514ebb/" class="sidebar-link">eggjs中curl请求、HTTP基础及RouteCtrl实战</a></li><li><a href="/rat-summ/pages/39412b/" class="sidebar-link">eggjs中HttpClient网络及Curl的使用</a></li><li><a href="/rat-summ/pages/4738e8/" class="sidebar-link">eggjs中Cookie与Session使用</a></li><li><a href="/rat-summ/pages/47858c/" class="sidebar-link">eggjs中实现RESTfulAPI及Router</a></li><li><a href="/rat-summ/pages/a69e2d/" class="sidebar-link">eggjs中cluster的实现原理</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpck</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/3793a8/" class="sidebar-link">webpack基础入门</a></li><li><a href="/rat-summ/pages/c741f3/" class="sidebar-link">webpack的自定义实现</a></li><li><a href="/rat-summ/pages/1e9637/" class="sidebar-link">webpack的源码分析</a></li><li><a href="/rat-summ/pages/c9f7c2/" class="sidebar-link">webpack热更新原理</a></li><li><a href="/rat-summ/pages/ac0ea5/" class="sidebar-link">webpack路由懒加载的原理</a></li><li><a href="/rat-summ/pages/d71cdf/" class="sidebar-link">组件按需加载babel-plugin-component分析</a></li><li><a href="/rat-summ/pages/eb92bd/" class="sidebar-link">webpack中require和import的区别</a></li><li><a href="/rat-summ/pages/sourcemap-detail/" class="sidebar-link">webpack中sourcemap详细配置</a></li><li><a href="/rat-summ/pages/1566f7/" class="sidebar-link">webpack的proxy用法</a></li><li><a href="/rat-summ/pages/1df7c0/" class="sidebar-link">http-proxy-middleware</a></li><li><a href="/rat-summ/pages/8c5df0/" class="sidebar-link">webpack-dll配置</a></li><li><a href="/rat-summ/pages/463f64/" class="sidebar-link">vue-config详解及实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/47b067/" class="sidebar-link">webpack优化总括</a></li><li><a href="/rat-summ/pages/ff5832/" class="sidebar-link">webpack的使用及优化</a></li><li><a href="/rat-summ/pages/540308/" class="sidebar-link">webpack打包构建优化</a></li><li><a href="/rat-summ/pages/47832b/" class="sidebar-link">vue-config构建优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/000507/" class="sidebar-link">webpack的插件实践</a></li><li><a href="/rat-summ/pages/webpack-externals/" class="sidebar-link">webpack中external实践</a></li><li><a href="/rat-summ/pages/624188/" class="sidebar-link">webpack中TreeShaking及压缩的实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>vue</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a3a764/" class="sidebar-link">vue相关官方文档记录</a></li><li><a href="/rat-summ/pages/vue-use/" class="sidebar-link">vue的实践使用</a></li><li><a href="/rat-summ/pages/vue-my/" class="sidebar-link">vue自定义实现</a></li><li><a href="/rat-summ/pages/vue-src/" class="sidebar-link">vue源码分析</a></li><li><a href="/rat-summ/pages/80f59a/" class="sidebar-link">vue源码分析和对原理的理解</a></li><li><a href="/rat-summ/pages/41c21e/" class="sidebar-link">vue的源码分析</a></li><li><a href="/rat-summ/pages/6ce810/" class="sidebar-link">vue2、vue3及react的三种Diff算法</a></li><li><a href="/rat-summ/pages/00dd2e/" class="sidebar-link">vue与react的对比及个人思考</a></li><li><a href="/rat-summ/pages/vue_comp_tel/" class="sidebar-link">vue组件通信方式及原理分析</a></li><li><a href="/rat-summ/pages/9f3a90/" class="sidebar-link">vue将原生事件绑定到组件</a></li><li><a href="/rat-summ/pages/1431ab/" class="sidebar-link">vue生命周期及原理分析</a></li><li><a href="/rat-summ/pages/2ea231/" class="sidebar-link">vue常用修饰符详解</a></li><li><a href="/rat-summ/pages/892a81/" class="sidebar-link">vue常用的自定义指令</a></li><li><a href="/rat-summ/pages/bc2498/" class="sidebar-link">vue中extend实践及分析</a></li><li><a href="/rat-summ/pages/6bc868/" class="sidebar-link">vue中filter实践及分析</a></li><li><a href="/rat-summ/pages/191c2d/" class="sidebar-link">vue中nextTick实现原理</a></li><li><a href="/rat-summ/pages/vue-pro-pref/" class="sidebar-link">vue项目优化技巧【重点】</a></li><li><a href="/rat-summ/pages/211945/" class="sidebar-link">vue项目权限相关</a></li><li><a href="/rat-summ/pages/83f9be/" class="sidebar-link">vue项目实践</a></li><li><a href="/rat-summ/pages/22bc61/" class="sidebar-link">vue项目刷新当前页面</a></li><li><a href="/rat-summ/pages/398010/" class="sidebar-link">vue中使用jsx</a></li><li><a href="/rat-summ/pages/aeb50e/" class="sidebar-link">vue封装组件技巧</a></li><li><a href="/rat-summ/pages/c59b7d/" class="sidebar-link">vue3相关资料整理</a></li><li><a href="/rat-summ/pages/73a1c0/" class="sidebar-link">vue3新特点</a></li><li><a href="/rat-summ/pages/vue3-use/" class="sidebar-link">vue3实践使用</a></li><li><a href="/rat-summ/pages/vue3-my/" class="sidebar-link">vue3自定义实现</a></li><li><a href="/rat-summ/pages/vue3-src/" class="sidebar-link">vue3源码分析</a></li><li><a href="/rat-summ/pages/c51695/" class="sidebar-link">vue3与vue2组件通信方式及对比</a></li><li><a href="/rat-summ/pages/af09b9/" class="sidebar-link">vue3使用mitt</a></li><li><a href="/rat-summ/pages/78748a/" class="sidebar-link">vue3与react的hook比较</a></li><li><a href="/rat-summ/pages/d16cc3/" class="sidebar-link">vueuse实践及分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/vuex-use/" class="sidebar-link">vuex实践使用</a></li><li><a href="/rat-summ/pages/vuex-my/" class="sidebar-link">vuex自定义实现</a></li><li><a href="/rat-summ/pages/vuex-src/" class="sidebar-link">vuex源码分析</a></li><li><a href="/rat-summ/pages/93a55d/" class="sidebar-link">vuex4新特性</a></li><li><a href="/rat-summ/pages/93a599/" class="sidebar-link">vuex4源码分析</a></li><li><a href="/rat-summ/pages/a9aba2/" class="sidebar-link">pinia实践及分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/213b37/" class="sidebar-link">前端路由的原理及自定义</a></li><li><a href="/rat-summ/pages/vue-router-use/" class="sidebar-link">vue-rouer实践使用</a></li><li><a href="/rat-summ/pages/vue-router-my/" class="sidebar-link">vue-router自定义实现</a></li><li><a href="/rat-summ/pages/vue-router-src/" class="sidebar-link">vue-router源码分析</a></li><li><a href="/rat-summ/pages/3f15a5/" class="sidebar-link">vue-router4新特性</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ssr</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ff8fd0/" class="sidebar-link">ssr实践</a></li><li><a href="/rat-summ/pages/4bb23f/" class="sidebar-link">vue-ssr自定义实现</a></li><li><a href="/rat-summ/pages/e5d580/" class="sidebar-link">vue-ssr源码分析</a></li><li><a href="/rat-summ/pages/b7ed5f/" class="sidebar-link">nuxt实践使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/41364d/" class="sidebar-link">vue-cli实践使用</a></li><li><a href="/rat-summ/pages/313db8/" class="sidebar-link">vue-cli自定义实现</a></li><li><a href="/rat-summ/pages/71132c/" class="sidebar-link">vue-cli源码分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vuepress</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/388ab8/" class="sidebar-link">vuepress主题模版及实践</a></li><li><a href="/rat-summ/pages/281e9a/" class="sidebar-link">vuepress搭建文档中心</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/521b7b/" class="sidebar-link">长列表优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0a2802/" class="sidebar-link">vue中pdf下载及预览</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>vite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d6cc17/" class="sidebar-link">01.vite实践及分析</a></li><li><a href="/rat-summ/pages/8096e1/" class="sidebar-link">vite自定义实现</a></li><li><a href="/rat-summ/pages/1f61db/" class="sidebar-link">vite源码解析</a></li><li><a href="/rat-summ/pages/6b2a11/" class="sidebar-link">vite自定义实现2</a></li><li><a href="/rat-summ/pages/0413e2/" class="sidebar-link">vue-cli迁移vite2实践小结</a></li><li><a href="/rat-summ/pages/ff4767/" class="sidebar-link">Vite2&amp;React&amp;AntDesign4搭建开发环境</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>第三方库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/eecca3/" class="sidebar-link">antd-vue table设置rowClass</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>组件库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/rat-ui-vue2-my/" class="sidebar-link">基于vue2环境搭建</a></li><li><a href="/rat-summ/pages/rat-ui-vue3-my/" class="sidebar-link">基于vue3环境搭建</a></li><li><a href="/rat-summ/pages/rat-ui-vue3-me/" class="sidebar-link">vue3自定义组件库</a></li><li><a href="/rat-summ/pages/rat-ui-vue-icon-button/" class="sidebar-link">Icon和Button组件</a></li><li><a href="/rat-summ/pages/rat-ui-vue-message/" class="sidebar-link">Message组件</a></li><li><a href="/rat-summ/pages/rat-ui-vue-carousel/" class="sidebar-link">Carousel组件</a></li><li><a href="/rat-summ/pages/rat-ui-vue-tree/" class="sidebar-link">Tree组件</a></li><li><a href="/rat-summ/pages/824a5d/" class="sidebar-link">Tree组件2</a></li><li><a href="/rat-summ/pages/1a7009/" class="sidebar-link">Toast组件</a></li><li><a href="/rat-summ/pages/7b620d/" class="sidebar-link">vue组件化</a></li><li><a href="/rat-summ/pages/843a0b/" class="sidebar-link">相关参考</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>源码分析</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/1c6668/" class="sidebar-link">vue源码解密分析开源项目</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>react</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f74c57/" class="sidebar-link">react生命周期</a></li><li><a href="/rat-summ/pages/febb52/" class="sidebar-link">react源码解析</a></li><li><a href="/rat-summ/pages/f7cd7b/" class="sidebar-link">react动态添加样式</a></li><li><a href="/rat-summ/pages/a20232/" class="sidebar-link">componentWillReceiveProps代替方案</a></li><li><a href="/rat-summ/pages/894913/" class="sidebar-link">react的通信方式</a></li><li><a href="/rat-summ/pages/725a47/" class="sidebar-link">react组件通信的方式</a></li><li><a href="/rat-summ/pages/29ef52/" class="sidebar-link">react优化性能技巧</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>dva</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d887b1/" class="sidebar-link">dva使用实践</a></li><li><a href="/rat-summ/pages/203fe8/" class="sidebar-link">dva实现原理及自定义实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5c9300/" class="sidebar-link">react-router&amp;dom实践使用</a></li><li><a href="/rat-summ/pages/8a9a13/" class="sidebar-link">react-router&amp;dom自定义实现</a></li><li><a href="/rat-summ/pages/ebc64f/" class="sidebar-link">react-router&amp;dom的源码分析</a></li><li><a href="/rat-summ/pages/ebc3a4/" class="sidebar-link">connected-react-router自定义实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>hooks</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f3a825/" class="sidebar-link">hooks实践</a></li><li><a href="/rat-summ/pages/48c2d2/" class="sidebar-link">hooks自定义实现</a></li><li><a href="/rat-summ/pages/54db46/" class="sidebar-link">hooks源码实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>组件库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/400fdf/" class="sidebar-link">通过storybook实现组件库</a></li><li><a href="/rat-summ/pages/f45bc7/" class="sidebar-link">组件发布相关</a></li><li><a href="/rat-summ/pages/9311d0/" class="sidebar-link">lerna&amp;dumi组件库及文档</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f8eee2/" class="sidebar-link">react性能优化</a></li><li><a href="/rat-summ/pages/1cc554/" class="sidebar-link">umi项目本地构建优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>antd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b936a9/" class="sidebar-link">antdv3中使用DatePicker控件</a></li><li><a href="/rat-summ/pages/636811/" class="sidebar-link">antd从v3升级到v4</a></li><li><a href="/rat-summ/pages/5a40df/" class="sidebar-link">umi插件</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>兼容性</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>IE</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/9e9433/" class="sidebar-link">解决TextEncoder和TextDecoder在IE下不兼容的问题</a></li><li><a href="/rat-summ/pages/56ba6a/" class="sidebar-link">解决iconfont在IE下不兼容问题</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>常用库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>公共</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5e3047/" class="sidebar-link">常用后台管理模块库</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>jspdf</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/77850d/" class="sidebar-link">pdf生成处理</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>dnd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/224401/" class="sidebar-link">react-dnd用法详解</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>协议</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/23fc68/" class="sidebar-link">常用网络协议关系</a></li><li><a href="/rat-summ/pages/a62613/" class="sidebar-link">http协议相关</a></li><li><a href="/rat-summ/pages/65f844/" class="sidebar-link">websocket的使用</a></li><li><a href="/rat-summ/pages/8231a6/" class="sidebar-link">mqtt的使用</a></li><li><a href="/rat-summ/pages/b65f02/" class="sidebar-link">websocket-over-stomp</a></li><li><a href="/rat-summ/pages/http-defense/" class="sidebar-link">http防御</a></li><li><a href="/rat-summ/pages/1d91eb/" class="sidebar-link">从url输入到返回请求的过程</a></li><li><a href="/rat-summ/pages/f5f2bd/" class="sidebar-link">websocket重连优化</a></li><li><a href="/rat-summ/pages/471e57/" class="sidebar-link">iframe中cookie使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>api_权限</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/09a716/" class="sidebar-link">接口请求格式详解</a></li><li><a href="/rat-summ/pages/b2d2c4/" class="sidebar-link">apidoc使用实践</a></li><li><a href="/rat-summ/pages/0de4e4/" class="sidebar-link">前端鉴权知识</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>h5移动</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/560843/" class="sidebar-link">文章推荐</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>性能</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ee6f51/" class="sidebar-link">前端性能优化建议</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>监控</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/72e73a/" class="sidebar-link">常见监控问题汇总</a></li><li><a href="/rat-summ/pages/f0604f/" class="sidebar-link">sentry实践及性能监控</a></li><li><a href="/rat-summ/pages/90f275/" class="sidebar-link">sentry集成钉钉</a></li><li><a href="/rat-summ/pages/1c3756/" class="sidebar-link">sentry收集错误上报的原理</a></li><li><a href="/rat-summ/pages/24c0e6/" class="sidebar-link">sentry部署及实践</a></li><li><a href="/rat-summ/pages/351a6b/" class="sidebar-link">前端性能监控自己实现</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>辅助工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a2f35a/" class="sidebar-link">chrome开发者工具的使用</a></li><li><a href="/rat-summ/pages/0ac96f/" class="sidebar-link">sonarqube实践及分析</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>组件化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/d45aed/" class="sidebar-link">React组件库搭建</a></li><li><a href="/rat-summ/pages/834f6e/" class="sidebar-link">Vue组件库搭建</a></li><li><a href="/rat-summ/pages/071606/" class="sidebar-link">Vue移动端组件库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>模块化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>模板</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/adm-tpl-sys/" class="sidebar-link">管理端adm-tpl-sys模版</a></li><li><a href="/rat-summ/pages/adm-tpl-sub/" class="sidebar-link">管理端adm-tpl-sub模版</a></li><li><a href="/rat-summ/pages/adm-tpl-portal/" class="sidebar-link">管理端adm-tpl-portal模版</a></li><li><a href="/rat-summ/pages/adm-tpl-port/" class="sidebar-link">管理端adm-tpl-part模版</a></li><li><a href="/rat-summ/pages/adm-tpl-react/" class="sidebar-link">管理端adm-tpl-react模版</a></li><li><a href="/rat-summ/pages/adm-tpl-vue/" class="sidebar-link">管理端adm-tpl-vue模版</a></li><li><a href="/rat-summ/pages/h5-tpl-vue/" class="sidebar-link">移动端h5-tpl-vue模版</a></li><li><a href="/rat-summ/pages/doc-tpl-rat/" class="sidebar-link">管理端doc-tpl-rat模版</a></li><li><a href="/rat-summ/pages/doc-tpl-bdp/" class="sidebar-link">管理端doc-tpl-bdp模版</a></li><li><a href="/rat-summ/pages/adm-tpl-vue-multi/" class="sidebar-link">管理端adm-tpl-vue-multi模版</a></li><li><a href="/rat-summ/pages/adm-tpl-egg/" class="sidebar-link">管理端adm-tpl-egg模版</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>微前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/908314/" class="sidebar-link">微前端概况</a></li><li><a href="/rat-summ/pages/micro-fe-use/" class="sidebar-link">微前端实践使用</a></li><li><a href="/rat-summ/pages/micro-fe-my/" class="sidebar-link">微前端原理实现</a></li><li><a href="/rat-summ/pages/264bc0/" class="sidebar-link">qiankun实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>learn</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/monorepo-lerna-yarn-use/" class="sidebar-link">monorepo-lerna-yarn的实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>可视化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>bizchart</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c23b0f/" class="sidebar-link">bizchart基础</a></li><li><a href="/rat-summ/pages/e6701a/" class="sidebar-link">bizchart实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>x6</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/bf408c/" class="sidebar-link">x6实践</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>介绍</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c9a984/" class="sidebar-link">介绍借鉴</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>babel</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/561173/" class="sidebar-link">babel实践及配置</a></li><li><a href="/rat-summ/pages/b5a629/" class="sidebar-link">babel原理及AST</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>gulp</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/fb8427/" class="sidebar-link">glup的使用</a></li><li><a href="/rat-summ/pages/013312/" class="sidebar-link">gulp搭建本地服务</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b12f8c/" class="sidebar-link">webpack</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/b68d92/" class="sidebar-link">常用的代码规范配置</a></li><li><a href="/rat-summ/pages/e58bf8/" class="sidebar-link">eslint+prettier规范与检测代码</a></li><li><a href="/rat-summ/pages/git-cz-commit/" class="sidebar-link">cz代码提交规范的工作流</a></li><li><a href="/rat-summ/pages/4de8c4/" class="sidebar-link">prettier配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>cli</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/da383f/" class="sidebar-link">脚手架cli开发</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>测试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/24e8fd/" class="sidebar-link">自动化前端测试</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>构建</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/72751e/" class="sidebar-link">前端构建OOM</a></li><li><a href="/rat-summ/pages/a4bce3/" class="sidebar-link">前端内存分析</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>uml</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/77e0c4/" class="sidebar-link">UML工具之EA用法</a></li><li><a href="/rat-summ/pages/bb0cda/" class="sidebar-link">UML基于其的软件设计</a></li><li><a href="/rat-summ/pages/5a0304/" class="sidebar-link">UML基于其的需求分析</a></li><li><a href="/rat-summ/pages/3e0da4/" class="sidebar-link">UML基于其的需求分析之案例分析</a></li><li><a href="/rat-summ/pages/a233a0/" class="sidebar-link">UML用法之基础之基于StarUML</a></li><li><a href="/rat-summ/pages/46009e/" class="sidebar-link">UML用法之进阶之基于EA</a></li><li><a href="/rat-summ/pages/99ad7d/" class="sidebar-link">UML之类图分析</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>devops</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>gitd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0e4ee4/" class="sidebar-link">git常用命令及使用</a></li><li><a href="/rat-summ/pages/5f88ca/" class="sidebar-link">git提交规范</a></li><li><a href="/rat-summ/pages/3cf79d/" class="sidebar-link">git补丁patch和diff使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>jenkins</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/cf5bb3/" class="sidebar-link">jenkins配置及使用</a></li><li><a href="/rat-summ/pages/db0083/" class="sidebar-link">jenkins前端构建部署</a></li><li><a href="/rat-summ/pages/e9a204/" class="sidebar-link">Jenkins推送设置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>github</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/github-action/" class="sidebar-link">Github Action自动打包部署</a></li><li><a href="/rat-summ/pages/04ea51/" class="sidebar-link">gitpage设置</a></li><li><a href="/rat-summ/pages/27f7b7/" class="sidebar-link">Github常用自动化及发布设置</a></li><li><a href="/rat-summ/pages/9cd829/" class="sidebar-link">gitlhub&amp;lab几个常用的API</a></li><li><a href="/rat-summ/pages/3a598f/" class="sidebar-link">github墙外</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>gitlab</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/92a5da/" class="sidebar-link">gitlab环境及配置</a></li><li><a href="/rat-summ/pages/2a7fb1/" class="sidebar-link">常用功能</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>bash</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/307097/" class="sidebar-link">前端脚本通过时间生成对应环境</a></li><li><a href="/rat-summ/pages/209a7a/" class="sidebar-link">shell脚本中变量判断</a></li><li><a href="/rat-summ/pages/85b237/" class="sidebar-link">bash判断文件或文件夹是否存在</a></li><li><a href="/rat-summ/pages/39d420/" class="sidebar-link">sed命令替换匹配行</a></li><li><a href="/rat-summ/pages/b8cc91/" class="sidebar-link">shell中find使用</a></li><li><a href="/rat-summ/pages/d16bc3/" class="sidebar-link">shell中mv&amp;rm&amp;cp使用</a></li><li><a href="/rat-summ/pages/3e2bbc/" class="sidebar-link">shell管道及并串行</a></li><li><a href="/rat-summ/pages/5aff55/" class="sidebar-link">shell参数传递与默认值</a></li><li><a href="/rat-summ/pages/da9733/" class="sidebar-link">shell读取配置文件参数</a></li><li><a href="/rat-summ/pages/ee26ee/" class="sidebar-link">shell交互式传参</a></li><li><a href="/rat-summ/pages/79fe8b/" class="sidebar-link">shell中json使用</a></li><li><a href="/rat-summ/pages/b9af92/" class="sidebar-link">shell中catch使用</a></li><li><a href="/rat-summ/pages/23ad45/" class="sidebar-link">shell中后台运行</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>k8s</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/012f5e/" class="sidebar-link">前端实践k8s</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ansible</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/150b7c/" class="sidebar-link">ansible实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a07627/" class="sidebar-link">docker环境及配置</a></li><li><a href="/rat-summ/pages/docker-base/" aria-current="page" class="active sidebar-link">docker&amp;compose及swarm的使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#环境安装" class="sidebar-link">环境安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#安装步骤示范" class="sidebar-link">安装步骤示范</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#各系统参考" class="sidebar-link">各系统参考</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#镜像加速" class="sidebar-link">镜像加速</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker" class="sidebar-link">Docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#相关系统操作命令" class="sidebar-link">相关系统操作命令</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#常用管理命令" class="sidebar-link">常用管理命令</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#镜像压缩与优化" class="sidebar-link">镜像压缩与优化</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#镜像打包加速【要点】" class="sidebar-link">镜像打包加速【要点】</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#网络模式" class="sidebar-link">网络模式</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker-opts设置" class="sidebar-link">DOCKER_OPTS设置</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#容器启动与状态" class="sidebar-link">容器启动与状态</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#build设置" class="sidebar-link">Build设置</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#dockerfile" class="sidebar-link">Dockerfile</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker-compose" class="sidebar-link">Docker compose</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#常见命令" class="sidebar-link">常见命令</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker-compose-yml-属性" class="sidebar-link">docker-compose.yml 属性</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker-compose-其它" class="sidebar-link">Docker Compose 其它</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#常用示例" class="sidebar-link">常用示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#docker-swarm" class="sidebar-link">Docker swarm</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#制作示范" class="sidebar-link">制作示范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#目录结构" class="sidebar-link">目录结构</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#准备文件" class="sidebar-link">准备文件</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#相关问题" class="sidebar-link">相关问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#在docker里面使用systemctl" class="sidebar-link">在Docker里面使用systemctl</a></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#no-such-file-or-directory" class="sidebar-link">no such file or directory</a></li></ul></li><li class="sidebar-sub-header"><a href="/rat-summ/pages/docker-base/#相关链接" class="sidebar-link">相关链接</a></li></ul></li><li><a href="/rat-summ/pages/975a75/" class="sidebar-link">docker常用脚本及工具</a></li><li><a href="/rat-summ/pages/3b2696/" class="sidebar-link">前端常用到的docker容器</a></li><li><a href="/rat-summ/pages/71907e/" class="sidebar-link">docker镜像源加速</a></li><li><a href="/rat-summ/pages/8b98ff/" class="sidebar-link">docker搭建私有仓库registry及harbor</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>nginx</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/nginx-base/" class="sidebar-link">nginx环境设置</a></li><li><a href="/rat-summ/pages/nginx-good/" class="sidebar-link">nginx常用设置及实践</a></li><li><a href="/rat-summ/pages/626088/" class="sidebar-link">nginx配置https-http2</a></li><li><a href="/rat-summ/pages/f7b17f/" class="sidebar-link">nginx部署相关</a></li><li><a href="/rat-summ/pages/1fd240/" class="sidebar-link">nginx运维部署相关</a></li><li><a href="/rat-summ/pages/2aabd0/" class="sidebar-link">nginx的重定向问题</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ci&amp;cd</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/8ceda4/" class="sidebar-link">jenkins构建docker镜像上传至私有镜像库Nexus</a></li><li><a href="/rat-summ/pages/f645ee/" class="sidebar-link">ci&amp;cd通过k8s完整部署</a></li><li><a href="/rat-summ/pages/29c57b/" class="sidebar-link">gitLab搭建cicd</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>deploy</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a991cc/" class="sidebar-link">pm2常用命令及管理</a></li><li><a href="/rat-summ/pages/7e9083/" class="sidebar-link">pm2一键部署</a></li><li><a href="/rat-summ/pages/e5878d/" class="sidebar-link">pm2的实现原理</a></li><li><a href="/rat-summ/pages/2942f3/" class="sidebar-link">ansible部署</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>db</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>nedb</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/275bf3/" class="sidebar-link">nedb的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/a23297/" class="sidebar-link">mysql环境及配置</a></li><li><a href="/rat-summ/pages/bb5f4c/" class="sidebar-link">mysql语法相关</a></li><li><a href="/rat-summ/pages/c3d40c/" class="sidebar-link">mysql类型、储存引擎</a></li><li><a href="/rat-summ/pages/66840d/" class="sidebar-link">mysql事务</a></li><li><a href="/rat-summ/pages/e09335/" class="sidebar-link">mysql优化</a></li><li><a href="/rat-summ/pages/8b0470/" class="sidebar-link">sequelize事务</a></li><li><a href="/rat-summ/pages/408e49/" class="sidebar-link">mysql在win上bat脚本使用</a></li><li><a href="/rat-summ/pages/5ac000/" class="sidebar-link">sqlite的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/bcd737/" class="sidebar-link">redis环境及配置</a></li><li><a href="/rat-summ/pages/098cc4/" class="sidebar-link">redis简介、安装及配置</a></li><li><a href="/rat-summ/pages/7f774f/" class="sidebar-link">redis数据结构、订阅及案例</a></li><li><a href="/rat-summ/pages/7650e0/" class="sidebar-link">redis持久化、缓存及淘汰策略</a></li><li><a href="/rat-summ/pages/b7e7b7/" class="sidebar-link">redis集群、慢查询及内存优化</a></li><li><a href="/rat-summ/pages/0ecb33/" class="sidebar-link">redis事务、锁及分布式</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>业务其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>ambari</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/365af3/" class="sidebar-link">ambari-admin前端二次开发</a></li><li><a href="/rat-summ/pages/365af4/" class="sidebar-link">ambari-web前端二次开发</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>freemarker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/851ff6/" class="sidebar-link">freemarker基本语法</a></li><li><a href="/rat-summ/pages/2a94be/" class="sidebar-link">freemarker与vue实践</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ember</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/0597da/" class="sidebar-link">ember语法</a></li><li><a href="/rat-summ/pages/30db45/" class="sidebar-link">ember调试</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>go</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/850c2f/" class="sidebar-link">go环境相关配置</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>系统</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>mac</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/6a7c2d/" class="sidebar-link">mac中zsh配置</a></li><li><a href="/rat-summ/pages/00d9cb/" class="sidebar-link">mac常用软件</a></li><li><a href="/rat-summ/pages/f6ec35/" class="sidebar-link">mac上U盘及硬盘数据</a></li><li><a href="/rat-summ/pages/498a75/" class="sidebar-link">homebrew镜像设置</a></li><li><a href="/rat-summ/pages/6d2739/" class="sidebar-link">mac开发环境配置</a></li><li><a href="/rat-summ/pages/fa9bb9/" class="sidebar-link">mac升级固态重装系统</a></li><li><a href="/rat-summ/pages/b86746/" class="sidebar-link">mac打开scp功能</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f991c3/" class="sidebar-link">linux系统目录结构</a></li><li><a href="/rat-summ/pages/037572/" class="sidebar-link">shell脚本实现取当前时间</a></li><li><a href="/rat-summ/pages/6147ef/" class="sidebar-link">linux下通过端口查看进程</a></li><li><a href="/rat-summ/pages/5157d5/" class="sidebar-link">linux用户及权限配置管理</a></li><li><a href="/rat-summ/pages/bc509e/" class="sidebar-link">linux下使用Shell脚本使用ftp</a></li><li><a href="/rat-summ/pages/c74d05/" class="sidebar-link">linux下用户管理</a></li><li><a href="/rat-summ/pages/7c0099/" class="sidebar-link">linux解压缩命令</a></li><li><a href="/rat-summ/pages/02fc2e/" class="sidebar-link">服务常用命令</a></li><li><a href="/rat-summ/pages/99637c/" class="sidebar-link">linux安装配置sshd</a></li><li><a href="/rat-summ/pages/93d76c/" class="sidebar-link">centos7设置防火墙</a></li><li><a href="/rat-summ/pages/6f084f/" class="sidebar-link">linux写入的使用</a></li><li><a href="/rat-summ/pages/3ba63f/" class="sidebar-link">centos离线安装软件</a></li><li><a href="/rat-summ/pages/54a78b/" class="sidebar-link">linux下jdk环境安装</a></li><li><a href="/rat-summ/pages/d59afc/" class="sidebar-link">linux与win格式</a></li><li><a href="/rat-summ/pages/a85063/" class="sidebar-link">linux磁盘空间管理</a></li><li><a href="/rat-summ/pages/3654be/" class="sidebar-link">使用samba建立共享文件</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>win</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ceea52/" class="sidebar-link">桌面上图标出现x及感叹号处理</a></li><li><a href="/rat-summ/pages/ac4a51/" class="sidebar-link">Chocolatey的使用</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>pi</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/8f3e17/" class="sidebar-link">安装MATE及配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>centos</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/52b482/" class="sidebar-link">centos安装配置注意事项</a></li><li><a href="/rat-summ/pages/3a9aef/" class="sidebar-link">centos常用命令</a></li><li><a href="/rat-summ/pages/d8dad9/" class="sidebar-link">centos修改国内yum源</a></li><li><a href="/rat-summ/pages/a52dbe/" class="sidebar-link">centos利用createrepo制作本地yum源</a></li><li><a href="/rat-summ/pages/e672e6/" class="sidebar-link">centos安装vim及配置</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ubuntu</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/c21912/" class="sidebar-link">ubuntu上安装Chrome浏览器</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>tool</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>开发工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/fe80ea/" class="sidebar-link">vscode插件开发实践</a></li><li><a href="/rat-summ/pages/42487b/" class="sidebar-link">vscode常用插件及设置</a></li><li><a href="/rat-summ/pages/e7d3cc/" class="sidebar-link">vscode推荐插件分类</a></li><li><a href="/rat-summ/pages/191c13/" class="sidebar-link">谷歌插件推荐</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>命令终端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/13e164/" class="sidebar-link">win终端Cmder配置及美化</a></li><li><a href="/rat-summ/pages/326653/" class="sidebar-link">terminus</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>写作工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/f931af/" class="sidebar-link">Markdown For Typora</a></li><li><a href="/rat-summ/pages/e28d3c/" class="sidebar-link">mdeditor完整示例</a></li><li><a href="/rat-summ/pages/8d4c7d/" class="sidebar-link">markdown语法指南</a></li><li><a href="/rat-summ/pages/790131/" class="sidebar-link">typora配合PicGo图床设置</a></li><li><a href="/rat-summ/pages/27f6e7/" class="sidebar-link">使用md语法编写在线文档</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>系统工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/ccbd1b/" class="sidebar-link">U盘启动盘制作工具</a></li><li><a href="/rat-summ/pages/ee04b1/" class="sidebar-link">mac上创建可启动USB</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>外部墙</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/10414e/" class="sidebar-link">内网穿透</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>design_pattern</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/5a8250/" class="sidebar-link">设计模式js版</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>algorithm</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/bd8a49/" class="sidebar-link">十大经典排序算法js版</a></li><li><a href="/rat-summ/pages/9456b9/" class="sidebar-link">数据结构及常用算法</a></li><li><a href="/rat-summ/pages/ed57ec/" class="sidebar-link">前端算法</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>android</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>junior</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/006aef/" class="sidebar-link">Android开发环境搭建和其相关配置</a></li><li><a href="/rat-summ/pages/b7d0d8/" class="sidebar-link">Android开发环境搭建和其相关配之Linux</a></li><li><a href="/rat-summ/pages/7d6f22/" class="sidebar-link">Android代码编程规范</a></li><li><a href="/rat-summ/pages/5e275b/" class="sidebar-link">Android网络基础</a></li><li><a href="/rat-summ/pages/b705d6/" class="sidebar-link">Android应用部署与发布</a></li><li><a href="/rat-summ/pages/1d4106/" class="sidebar-link">Android动画框架概括</a></li><li><a href="/rat-summ/pages/1ab136/" class="sidebar-link">Android动画框架基础</a></li><li><a href="/rat-summ/pages/b5f1e2/" class="sidebar-link">Android动画框架进阶</a></li><li><a href="/rat-summ/pages/38a1c0/" class="sidebar-link">Android应用学习进阶步骤之面试参照</a></li><li><a href="/rat-summ/pages/9bb8d0/" class="sidebar-link">Android应用学习进阶之初级</a></li><li><a href="/rat-summ/pages/5cb39b/" class="sidebar-link">Android应用市场发布流程之运营&amp;推广</a></li><li><a href="/rat-summ/pages/d94fea/" class="sidebar-link">Android开发新规范整理</a></li><li><a href="/rat-summ/pages/7b6ec9/" class="sidebar-link">gradle构建脚本优化</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>intermediate</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/eb6937/" class="sidebar-link">Android应用学习进阶之中级</a></li><li><a href="/rat-summ/pages/2c5f39/" class="sidebar-link">Android通信协议简述</a></li><li><a href="/rat-summ/pages/6ebce7/" class="sidebar-link">Android通讯协议之蓝牙基础</a></li><li><a href="/rat-summ/pages/e6d82e/" class="sidebar-link">Android自定义控件基础之事件分发和绘制</a></li><li><a href="/rat-summ/pages/37e06f/" class="sidebar-link">Android自定义控件基础分类及示例</a></li><li><a href="/rat-summ/pages/d3fdc6/" class="sidebar-link">Android编译脚本比较</a></li><li><a href="/rat-summ/pages/0365a3/" class="sidebar-link">NDK开发实践之基础</a></li><li><a href="/rat-summ/pages/9e9aed/" class="sidebar-link">NDK开发实践之基础之C语言</a></li><li><a href="/rat-summ/pages/383970/" class="sidebar-link">NDK开发实践之案例</a></li><li><a href="/rat-summ/pages/699fca/" class="sidebar-link">NDK开发实践之进阶</a></li><li><a href="/rat-summ/pages/fd869c/" class="sidebar-link">NDK开发环境搭建及初探</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>senior</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/fb359c/" class="sidebar-link">Andriod框架分析</a></li><li><a href="/rat-summ/pages/ced670/" class="sidebar-link">Andriod性能分析之概括</a></li><li><a href="/rat-summ/pages/69bd19/" class="sidebar-link">Andoid内存泄露案例分析</a></li><li><a href="/rat-summ/pages/b49e19/" class="sidebar-link">Andriod性能分析之布局优化</a></li><li><a href="/rat-summ/pages/bb4528/" class="sidebar-link">Andriod性能分析之代码优化</a></li><li><a href="/rat-summ/pages/024edd/" class="sidebar-link">Android插件化开发</a></li><li><a href="/rat-summ/pages/8794d6/" class="sidebar-link">Android内存分析及工具</a></li><li><a href="/rat-summ/pages/cc3b41/" class="sidebar-link">Android热插拔式开发</a></li><li><a href="/rat-summ/pages/e8c6d3/" class="sidebar-link">Dagger2&amp;Retrofit&amp;Mvp&amp;Rxjava使用</a></li><li><a href="/rat-summ/pages/b0b383/" class="sidebar-link">设计模式designpattern之Android</a></li><li><a href="/rat-summ/pages/32c934/" class="sidebar-link">Android应用学习进阶之高级</a></li><li><a href="/rat-summ/pages/d0714d/" class="sidebar-link">Android代码重构杂谈</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>frame_analysis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/105499/" class="sidebar-link">photoview框架总体类关系类图</a></li><li><a href="/rat-summ/pages/3410a4/" class="sidebar-link">photoview_gestures类图</a></li><li><a href="/rat-summ/pages/d416e3/" class="sidebar-link">photoview_scrollerproxy类图</a></li><li><a href="/rat-summ/pages/caddb2/" class="sidebar-link">photoview时序图</a></li><li><a href="/rat-summ/pages/19455e/" class="sidebar-link">universalimageloader总体分析类图</a></li><li><a href="/rat-summ/pages/a6beae/" class="sidebar-link">universalimageloader图片显示时序图</a></li><li><a href="/rat-summ/pages/192be5/" class="sidebar-link">volley总体分析类图</a></li><li><a href="/rat-summ/pages/67eb09/" class="sidebar-link">volley网络调用时序图</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>source_analysis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/rat-summ/pages/782b10/" class="sidebar-link">Activity的Window创建的过程</a></li><li><a href="/rat-summ/pages/bd7c14/" class="sidebar-link">Android事件分发活动图</a></li><li><a href="/rat-summ/pages/98b15b/" class="sidebar-link">AppWidget相关类关系类图</a></li><li><a href="/rat-summ/pages/6de61b/" class="sidebar-link">AppWidget桌面小部件时序图</a></li><li><a href="/rat-summ/pages/9bcef6/" class="sidebar-link">drawable的层次关系类图</a></li><li><a href="/rat-summ/pages/39cfca/" class="sidebar-link">Toast的Window创建过程</a></li><li><a href="/rat-summ/pages/139a3b/" class="sidebar-link">Window的操作过程时序图</a></li><li><a href="/rat-summ/pages/9d63db/" class="sidebar-link">窗口视图相关类图</a></li><li><a href="/rat-summ/pages/92b566/" class="sidebar-link">视图相关类图</a></li><li><a href="/rat-summ/pages/5408af/" class="sidebar-link">总体视图组的继承结构类图</a></li><li><a href="/rat-summ/pages/cf8bd6/" class="sidebar-link">Notification通知栏时序图</a></li><li><a href="/rat-summ/pages/5da37d/" class="sidebar-link">Notification相关类关系类图</a></li><li><a href="/rat-summ/pages/dfd0ca/" class="sidebar-link">ViewGroup的绘制活动图</a></li><li><a href="/rat-summ/pages/9366f0/" class="sidebar-link">ViewGroup和View总体案例分析活动图</a></li><li><a href="/rat-summ/pages/285c96/" class="sidebar-link">ViewGroup事件分发活动图</a></li><li><a href="/rat-summ/pages/2d5ab3/" class="sidebar-link">View的绘制活动图</a></li><li><a href="/rat-summ/pages/5ed209/" class="sidebar-link">View事件分发活动图</a></li><li><a href="/rat-summ/pages/462233/" class="sidebar-link">View中draw子流程活动图</a></li><li><a href="/rat-summ/pages/33d189/" class="sidebar-link">消息处理机制时序图</a></li><li><a href="/rat-summ/pages/2963bb/" class="sidebar-link">消息处理机制相关类关系类图</a></li></ul></section></li></ul></section></li></ul> <div class="sidebar-slot sidebar-slot-bottom"><!-- 正方形 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="3508773082"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div></aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/rat-summ/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><span data-v-33863c7e>《技能记录》</span></li> <li data-v-33863c7e><span data-v-33863c7e>devops</span></li> <li data-v-33863c7e><span data-v-33863c7e>docker</span></li></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/samyzh" target="_blank" title="作者" class="beLink" data-v-33863c7e>samy</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2017-01-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          docker&amp;compose及swarm的使用
        </h1>  <div class="theme-vdoing-content content__default"><h2 id="环境安装"><a href="#环境安装" class="header-anchor">#</a> 环境安装</h2> <h3 id="安装步骤示范"><a href="#安装步骤示范" class="header-anchor">#</a> 安装步骤示范</h3> <ol><li><p>通过 uname -r 命令查看你当前的内核版本
<code>uname -r</code></p></li> <li><p>使用 root 权限登录 Centos。确保 yum 包更新到最新。
<code>yum -y update</code></p></li> <li><p>卸载旧版本(如果安装过旧版本的话)
<code>yum remove docker docker-common docker-selinux docker-engine</code></p></li> <li><p>安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的
<code>yum install -y yum-utils device-mapper-persistent-data lvm2</code></p></li> <li><p>设置yum源
<code>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></p></li> <li><p>可以查看所有仓库中所有docker版本，并选择特定版本安装
<code>yum list docker-ce --showduplicates | sort -r</code></p></li> <li><p>安装docker
<code>sudo yum install -y docker-ce #由于repo中默认只开启stable仓库，故这里安装的是最新稳定版18.03.1</code></p></li> <li><p>启动并加入开机启动</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>systemctl start docker     <span class="token comment">#启动docker</span>
systemctl <span class="token builtin class-name">enable</span> docker    <span class="token comment">#设置为开机启动</span>

<span class="token comment">#其他相关系统 docker操作命令</span>
systemctl <span class="token builtin class-name">enable</span> docker <span class="token comment">#设置docker系统启动</span>
systemctl start docker <span class="token comment">#启动docker</span>
systemctl status docker <span class="token comment">#查看docker状态</span>
systemctl stop docker <span class="token comment">#停止</span>
systemctl restart docker <span class="token comment">#重启</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>验证安装是否成功(有client和service两部分表示docker安装启动都成功了)
<code>docker version</code></p></li></ol> <p><strong>可以封装成脚本优化</strong></p> <p><code>docker.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash </span>
yum -y <span class="token function">install</span> <span class="token function">wget</span> 
<span class="token builtin class-name">cd</span> /etc/yum.repos.d/
<span class="token function">wget</span> http://mila.oss-cn-shenzhen.aliyuncs.com/docker.repo
yum clean all <span class="token operator">&amp;&amp;</span> yum makecache
<span class="token builtin class-name">cd</span> /root
<span class="token function">wget</span> http://mila.oss-cn-shenzhen.aliyuncs.com/soft/docker-engine-17.05.0.ce-1.el7.centos.x86_64.rpm
yum -y localinstall ./docker-engine-17.05.0.ce-1.el7.centos.x86_64.rpm
systemctl <span class="token builtin class-name">enable</span> docker
systemctl start docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>chmod +x docker.sh</code></p> <h3 id="各系统参考"><a href="#各系统参考" class="header-anchor">#</a> 各系统参考</h3> <ul><li><a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Docker安装步骤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.docker.com/compose/install/" target="_blank" rel="noopener noreferrer">Docker compose安装步骤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="镜像加速"><a href="#镜像加速" class="header-anchor">#</a> 镜像加速</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://xxx.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'</span>
<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
<span class="token operator">&gt;</span>   <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://xxx.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> EOF
<span class="token punctuation">{</span>
  <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://xxx.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token function">sudo</span> systemctl daemon-reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p><code>![](~/20-55-11.jpg)</code></p> <h3 id="相关系统操作命令"><a href="#相关系统操作命令" class="header-anchor">#</a> <strong>相关系统操作命令</strong></h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart docker
<span class="token comment">#其他相关系统 docker操作命令</span>
systemctl <span class="token builtin class-name">enable</span> docker <span class="token comment">#设置docker系统启动</span>
systemctl start docker <span class="token comment">#启动docker</span>
systemctl status docker <span class="token comment">#查看docker状态</span>
systemctl stop docker <span class="token comment">#停止</span>
systemctl restart docker <span class="token comment">#重启</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="常用管理命令"><a href="#常用管理命令" class="header-anchor">#</a> 常用管理命令</h3> <blockquote><p>docker -help</p></blockquote> <h4 id="run命令运行以及参数详解"><a href="#run命令运行以及参数详解" class="header-anchor">#</a> <strong>run命令运行以及参数详解</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker run命令运行以及参数详解
命令格式：
-a, --attach<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>            登录容器（必须是以docker run -d启动的容器）  
-w, --workdir<span class="token operator">=</span><span class="token string">&quot;&quot;</span>           指定容器的工作目录  
-c, --cpu-shares<span class="token operator">=</span><span class="token number">0</span>         设置容器CPU权重，在CPU共享场景使用    
-e, --env<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>               指定环境变量，容器中可以使用该环境变量    
-m, --memory<span class="token operator">=</span><span class="token string">&quot;&quot;</span>            指定容器的内存上限    
-P, --publish-all<span class="token operator">=</span>false    指定容器暴露的端口    
-p, --publish<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>           指定容器暴露的端口   
-h, --hostname<span class="token operator">=</span><span class="token string">&quot;&quot;</span>          指定容器的主机名    
-v, --volume<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>            给容器挂载存储卷，挂载到容器的某个目录    
--volumes-from<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>          给容器挂载其他容器上的卷，挂载到容器的某个目录  
--cap-add<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>               添加权限，权限清单详见：http://linux.die.net/man/7/capabilities    
--cap-drop<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>              删除权限，权限清单详见：http://linux.die.net/man/7/capabilities    
--cidfile<span class="token operator">=</span><span class="token string">&quot;&quot;</span>               运行容器后，在指定文件中写入容器PID值，一种典型的监控系统用法    
--cpuset<span class="token operator">=</span><span class="token string">&quot;&quot;</span>                设置容器可以使用哪些CPU，此参数可以用来容器独占CPU    
--device<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>                添加主机设备给容器，相当于设备直通    
--dns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>                   指定容器的dns服务器    
--dns-search<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>            指定容器的dns搜索域名，写入到容器的/etc/resolv.conf文件    
--entrypoint<span class="token operator">=</span><span class="token string">&quot;&quot;</span>            覆盖image的入口点    
--env-file<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>              指定环境变量文件，文件格式为每行一个环境变量    
--expose<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>                指定容器暴露的端口，即修改镜像的暴露端口    
--link<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>                  指定容器间的关联，使用其他容器的IP、env等信息    
--lxc-conf<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>              指定容器的配置文件，只有在指定--exec-driver<span class="token operator">=</span>lxc时使用    
--name<span class="token operator">=</span><span class="token string">&quot;&quot;</span>                  指定容器名字，后续可以通过名字进行容器管理，links特性需要使用名字    
--net<span class="token operator">=</span><span class="token string">&quot;bridge&quot;</span>             容器网络设置:
                                bridge 使用docker daemon指定的网桥
                                   <span class="token function">host</span>     //容器使用主机的网络
                                  container:NAME_or_ID  <span class="token operator">&gt;</span>//使用其他容器的网路，共享IP和PORT等网络资源
                                  none 容器使用自己的网络（类似--net<span class="token operator">=</span>bridge<span class="token punctuation">)</span>,但是不进行配置

--privileged<span class="token operator">=</span>false         指定容器是否为特权容器，特权容器拥有所有的capabilities    
--restart<span class="token operator">=</span><span class="token string">&quot;no&quot;</span>             指定容器停止后的重启策略:
                                  no：容器退出时不重启
                                  on-failure：容器故障退出（返回值非零）时重启
                                  always：容器退出时总是重启    
--rm<span class="token operator">=</span>false                 指定容器停止后自动删除容器<span class="token punctuation">(</span>不支持以docker run -d启动的容器<span class="token punctuation">)</span>    
--sig-proxy<span class="token operator">=</span>true           设置由代理接受并处理信号，但是SIGCHLD、SIGSTOP和SIGKILL不能被代理
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker run -it --name myjava java -p  -v <span class="token function">bash</span>
<span class="token comment"># docker run -t -i --name test2 centos7:7.3.1611 /bin/bash</span>
docker run -it --name test2 centos7:7.3.1611 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="执行命令"><a href="#执行命令" class="header-anchor">#</a> <strong>执行命令</strong></h4> <p>docker exec ：在运行的容器中执行命令;</p> <ul><li>-d :分离模式: 在后台运行</li> <li>-i :即使没有附加也保持STDIN（标准输入） 打开,以交互模式运行容器，通常与 -t 同时使用；</li> <li>-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#启动容器后，直接进入容器；</span>
docker run -t -i --name test1 docker.io/ubuntu /bin/bash
docker run -it --name test1 docker.io/ubuntu /bin/bash
<span class="token comment">#进入已经启动的容器中；</span>
docker <span class="token builtin class-name">exec</span> -it  f94d2c317477 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="停止-删除容器或镜像"><a href="#停止-删除容器或镜像" class="header-anchor">#</a> <strong>停止/删除容器或镜像</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#停止所有的container（容器），这样才能够删除其中的images：</span>
docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span> <span class="token comment">#或者 docker stop $(docker ps -aq) </span>
<span class="token comment">#如果想要删除所有container（容器）的话再加一个指令：</span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span> <span class="token comment">#或者 docker rm $(docker ps -aq) </span>

<span class="token comment">#删除images（镜像），通过image的id来指定删除谁</span>
docker rmi <span class="token operator">&lt;</span>image id<span class="token operator">&gt;</span> <span class="token comment">#或者 docker rmi 镜像名称：版本（TAG）</span>
<span class="token comment">#想要删除untagged images，也就是那些id为的image的话可以用 #删除id为none的镜像【非常有用】</span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;^&lt;none&gt;&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&quot;{print <span class="token variable">$3</span>}&quot;</span><span class="token variable">)</span></span>

<span class="token comment">#删除none的镜像，要先删除镜像中的容器。要删除镜像中的容器，必须先停止容器</span>
docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Exited&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span> }'</span><span class="token variable">)</span></span> <span class="token comment">#停止容器  </span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Exited&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span> }'</span><span class="token variable">)</span></span> <span class="token comment">#删除容器 </span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;none&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token variable">)</span></span>  <span class="token comment">#删除镜像</span>

<span class="token comment">#要删除全部image（镜像）的话</span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images -q<span class="token variable">)</span></span>
<span class="token comment">#强制删除全部image的话</span>
docker rmi -f <span class="token variable"><span class="token variable">$(</span>docker images -q<span class="token variable">)</span></span>
 
<span class="token comment">#删除所有停止的容器</span>
docker container prune
<span class="token comment">#删除所有不使用的镜像</span>
docker image prune --force --all <span class="token comment">#或者 docker image prune -f -a</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><code>remove-none-img.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Exited&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span> }'</span><span class="token variable">)</span></span> <span class="token comment">#停止容器  </span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Exited&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span> }'</span><span class="token variable">)</span></span> <span class="token comment">#删除容器 </span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;none&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token variable">)</span></span>  <span class="token comment">#删除镜像</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>容器相关操作</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#停止、启动、杀死、重启一个容器</span>
docker stop Name或者ID  
docker start Name或者ID  
docker <span class="token function">kill</span> Name或者ID  
docker restart name或者ID

docker <span class="token function">ps</span> –a <span class="token comment">#查看所有容器列表：</span>
docker <span class="token function">ps</span><span class="token comment">#查看启动的容器列表：</span>
docker start 容器ID或容器名 <span class="token comment">#启动容器：</span>
docker restart 容器ID或容器名 <span class="token comment">#重启容器：</span>
docker -t stop 容器ID或容器名,<span class="token comment">#限时关闭容器： </span>
docker -60 stop,容器 <span class="token comment">#如60秒以内关闭容器： 60秒以内未关闭，则直接关闭容器。</span>
docker <span class="token function">kill</span> 容器ID或容器名 <span class="token comment">#直接关闭容器：</span>
docker <span class="token function">rm</span> 容器id <span class="token comment">#删除终止状态的容器：</span>
docker <span class="token function">rm</span> -f 容器id <span class="token comment">#删除运行中的容器：</span>
docker stop <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span> <span class="token comment">#停止所有容器：</span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">$(</span>docker <span class="token function">ps</span> -a -q<span class="token variable">)</span></span> <span class="token comment">#删除所有终止状态的容器：</span>

docker logs 容器id <span class="token comment">#查看容器日志：</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>镜像相关操作</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker images <span class="token comment">#查看镜像列表：</span>
docker rmi <span class="token operator">&lt;</span>image id<span class="token operator">&gt;</span> 或者docker rmi 镜像名称：版本（TAG）<span class="token comment">#删除镜像：</span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;^&lt;none&gt;&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&quot;{print <span class="token variable">$3</span>}&quot;</span><span class="token variable">)</span></span> <span class="token comment">#删除id为none的镜像：</span>
docker rmi <span class="token variable"><span class="token variable">$(</span>docker images -q<span class="token variable">)</span></span> <span class="token comment">#删除所有未使用的镜像：</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="inspect目录挂载及查看"><a href="#inspect目录挂载及查看" class="header-anchor">#</a> inspect目录挂载及查看</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run -it -v /test2 centos /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>同样使用docker inspect命令查看宿主机的挂载目录；</p> <p><code>docker inspect autorun-pro</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>   <span class="token string">&quot;Mounts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;96256232eb74edb139d652746f0fe426e57fbacdf73376963e3acdb411b3d73a&quot;</span>,
            <span class="token string">&quot;Source&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/96256232eb74edb139d652746f0fe426e57fbacdf73376963e3acdb411b3d73a/_data&quot;</span>,
            <span class="token string">&quot;Destination&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/test2&quot;</span>,
            <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
            <span class="token string">&quot;Mode&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;RW&quot;</span><span class="token builtin class-name">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>具体过滤</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker inspect --format<span class="token operator">=</span><span class="token string">'{{.NetworkSettings.IPAddress}}'</span> f5b1bfc2811a
<span class="token number">192.168</span>.5.2

docker inspect --format <span class="token string">'{{.State.Running}}'</span> autorun-pro
<span class="token boolean">true</span>

docker inspect -f <span class="token string">'{{.State.Running}}'</span> autorun-pro

docker container inspect -f <span class="token string">'{{if .State}}{{.State.Status}}{{else}}undefined{{end}}'</span> autorun-pro
<span class="token comment">#Error: No such container: autorun-pro</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>启动脚本</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">PRO_NAME</span><span class="token operator">=</span>autorun-pro
<span class="token assign-left variable">PRO_VERSION</span><span class="token operator">=</span>latest 
<span class="token assign-left variable">isRemove</span><span class="token operator">=</span>false

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">isRemove</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$isRemove</span> <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器stop,rm---再run处理---&quot;</span>
    docker stop <span class="token variable">$PRO_NAME</span>
    <span class="token function">sleep</span> <span class="token number">5</span>
    docker <span class="token function">rm</span> <span class="token variable">$PRO_NAME</span>
    <span class="token function">sleep</span> <span class="token number">5</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">EXIST</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> $PRO_NAME <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$EXIST</span> -ne <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">STATUS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>docker inspect -f <span class="token string">'{{.State.Status}}'</span> $PRO_NAME<span class="token variable">`</span></span>
    <span class="token keyword">case</span> <span class="token variable">$STATUS</span> <span class="token keyword">in</span>
        <span class="token string">&quot;running&quot;</span><span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是running状态---将不做处理---&quot;</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token string">&quot;exited&quot;</span><span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是exited状态---将start处理...&quot;</span>
            docker start <span class="token variable">$PRO_NAME</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token string">&quot;paused&quot;</span><span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是paused状态---将unpause处理...&quot;</span>
            docker unpause <span class="token variable">$PRO_NAME</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是特使状态---暂时没有处理...&quot;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;---检查到容器不存在---将run处理中...&quot;</span>
  docker run -d <span class="token punctuation">\</span>
    -p <span class="token number">28080</span>:80 -p <span class="token number">26379</span>:6379 -p <span class="token number">23306</span>:3306 <span class="token punctuation">\</span>
    -v /data/autorun/mysql/log:/var/log/mysql <span class="token punctuation">\</span>
    -v /data/autorun/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
    --name <span class="token variable">$PRO_NAME</span> <span class="token variable">$PRO_NAME</span><span class="token builtin class-name">:</span><span class="token variable">$PRO_VERSION</span>
<span class="token keyword">fi</span>
<span class="token function">sleep</span> <span class="token number">5</span>
docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token variable">$PRO_NAME</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h4 id="主从数据复制"><a href="#主从数据复制" class="header-anchor">#</a> <strong>主从数据复制</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#从容器到宿主机复制</span>
docker <span class="token function">cp</span> tomcat:/webapps/js/text.js /home/admin
docker  <span class="token function">cp</span> 容器名:容器路径       宿主机路径   

<span class="token comment">#从宿主机到容器复制</span>
docker <span class="token function">cp</span> /home/admin/text.js tomcat:/webapps/js
docker <span class="token function">cp</span> 宿主路径中文件      容器名:容器路径   

docker <span class="token function">cp</span> dockerV/file.zip  c1cb:tmp/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="创建镜像、修改、上传镜像"><a href="#创建镜像、修改、上传镜像" class="header-anchor">#</a> <strong>创建镜像、修改、上传镜像</strong></h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#通过现在运行中的容器,做成一个新的镜像;</span>
docker commit <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> CONTAINER <span class="token punctuation">[</span>REPOSITORY<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token comment">#主要参数选项包括：</span>
    -a ，–author<span class="token operator">=</span>”” 作者信息
    -m，–message<span class="token operator">=</span>”” 提交信息
    -p，–pause<span class="token operator">=</span>true 提交是暂停容器运行
<span class="token comment">#提交</span>
docker commit -a <span class="token string">&quot;samy&quot;</span> -m <span class="token string">&quot;back up &quot;</span> -p containerId meeting-kz:v1115

<span class="token comment">#复制重命名</span>
docker tag testimage:lastest samy/testimage:lastes
docker push samy/testimage:lastest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="导入及导出命令"><a href="#导入及导出命令" class="header-anchor">#</a> <strong>导入及导出命令</strong></h4> <p>可以依据具体使用场景来选择命令</p> <ul><li>若是只想备份images，使用save、load即可</li> <li>若是在启动容器后，容器内容有变化，需要备份，则使用export、import</li></ul> <h5 id="export-import"><a href="#export-import" class="header-anchor">#</a> <strong>export/import</strong></h5> <blockquote><p>基于现在有的容器到处镜像；</p></blockquote> <p>压缩导出保存</p> <ul><li>docker export xxx -o/&gt; xxx.tar</li> <li>docker export xxx ｜ gzip  &gt; xxx.tar.gz</li></ul> <p>导入</p> <ul><li>docker import  xxx.tar</li> <li>docker import xxx.tar  xxx：导入重命名；</li></ul> <blockquote><p>OPTIONS说明：**-c :<strong>应用docker 指令创建镜像；</strong>-m 😗*提交时的说明文字；</p></blockquote> <p>联合使用</p> <ul><li>docker export test | docker import - test:3.0</li></ul> <p>命令：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker <span class="token builtin class-name">export</span> nginx-test -o nginx-test.tar 
<span class="token comment">#其中-o表示输出到文件，nginx-test.tar为目标文件，nginx-test是源容器名（name）</span>
docker <span class="token builtin class-name">export</span> nginx-test <span class="token operator">&gt;</span> nginx-test1.tar 
docker <span class="token builtin class-name">export</span> nginx-test <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> nginx-test1.tar.gz 

docker <span class="token function">ps</span>
docker <span class="token builtin class-name">export</span> ubuntu_test_container <span class="token operator">&gt;</span> ubuntu_test_container.tar

docker <span class="token function">import</span> ubuntu_test_container.tar
docker <span class="token function">import</span> ubuntu_test_container <span class="token operator">&lt;</span> ubuntu_test_container.tar
<span class="token comment">#支持同时导入多个</span>
docker <span class="token function">import</span> ubuntu_test_container.tar ubuntu_test_container:test
<span class="token comment">#从上面的命令可以看出，docker import将container导入后会成为一个image，而不是恢复为一个container。</span>
<span class="token comment">#注：容器导出的tar包是文件系统，且大小比镜像导出的tar小。</span>

<span class="token comment">#实践</span>
docker <span class="token builtin class-name">export</span> autorun-pro <span class="token operator">|</span> <span class="token function">gzip</span> -o ./images/autorun-pro:1.0.0.tar.gz
docker <span class="token function">import</span> images/autorun-pro:1.0.0.tar.gz autorun-pro:1.0.0

<span class="token comment">#已文件的方式导入;</span>
<span class="token function">cat</span> /home/alic/ubuntu.tar.gz <span class="token operator">|</span> <span class="token function">sudo</span> docker <span class="token function">import</span> - ubuntu:14.04
<span class="token function">cat</span> exampleimage.tgz <span class="token operator">|</span> docker <span class="token function">import</span> - exampleimagelocal:new
<span class="token function">cat</span> exampleimage.tgz <span class="token operator">|</span> docker <span class="token function">import</span> --message <span class="token string">&quot;New image imported from tarball&quot;</span> - exampleimagelocal:new

<span class="token comment">#以http的方式导入</span>
<span class="token function">sudo</span> docker <span class="token function">import</span> http://example.com/example.tgz example/imagere:demo
<span class="token comment">#查看</span>
<span class="token function">sudo</span> docker <span class="token function">ps</span> -a

<span class="token comment">#Import from a local directory with new configurations</span>
<span class="token function">sudo</span> <span class="token function">tar</span> -c <span class="token builtin class-name">.</span> <span class="token operator">|</span> docker <span class="token function">import</span> --change <span class="token string">&quot;ENV DEBUG=true&quot;</span> - exampleimagedir
<span class="token comment">#Import from a local directory</span>
<span class="token function">sudo</span> <span class="token function">tar</span> -c <span class="token builtin class-name">.</span> <span class="token operator">|</span> docker <span class="token function">import</span> - exampleimagedir

<span class="token comment">#运行这样的容器，要加这个参数；/bin/bash</span>
<span class="token comment">#Docker导入容器快照，执行报错：docker: Error response from daemon: No command specified.</span>
docker run --name nginxDockerfileCopy -p <span class="token number">8093</span>:80 -d username/nginx-dockerfilecopy /bin/bash

<span class="token comment">#参考以上COMMAND，将run命令修改为：</span>
<span class="token comment">#查询容器状态，发现容易已经停止。虽然执行中加了-d后台执行的参数，还是自动停止了。看来/bin/bash命令不能满足启动nginx的需求</span>
docker run --name testImportSnapshot -p <span class="token number">8094</span>:80 -d username/nginx-importsnapshot nginx -g <span class="token string">'daemon off;'</span>
<span class="token comment">#说明此次容器快照导出、导入生成新镜像，新镜像执行生成容器，容器具有导出之前一样的功能。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h5 id="save-load"><a href="#save-load" class="header-anchor">#</a> <strong>save/load</strong></h5> <p>导出保存为文件</p> <ul><li>docker save xx -o xx.tar</li> <li>docker save xx &gt; xx.tar   docker save xx | gzip &gt; xx.tar.gz</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 使用 docker save 命令根据 ID 将镜像保存成一个文件</span>
docker save 0fdf2b4c26d3 <span class="token operator">&gt;</span> server.tar

<span class="token comment">#还可以同时将多个 image 打包成一个文件，比如下面将镜像库中的 postgres 和 mongo 打包：</span>
docker save -o images-all.tar postgres:9.6 mongo:3.4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>压缩处理：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 其中-o和&gt;表示输出到文件，nginx.tar为目标文件，nginx:latest是源镜像名（name:tag）</span>
docker save -o nginx.tar nginx:latest
docker save <span class="token operator">&gt;</span> nginx.tar nginx:latest

<span class="token comment">#加入|gzip管道才有压缩效果；</span>
docker save java <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> /home/java.tar.gz

docker save -o mask_detection_v5.tar mask_detection:v5
<span class="token function">tar</span> -zcvf mask_detection_v5.tar.gz mask_detection_v5.tar
<span class="token comment">#还有一种容器的打包和压缩一步到位的方法：</span>
docker save mask_detection:v5 <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> mask_detection_v5.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># import</span>
<span class="token comment"># docker save autorun-pro | gzip &gt; ./images/autorun-pro:0.1.0.tar.gz</span>
<span class="token comment"># docker load &lt; ./images/autorun-pro:0.1.0.tar.gz</span>

<span class="token comment"># docker save $PRO_NAME | gzip &gt; ./images/$PRO_NAME:$PRO_VERSION.tar.gz</span>
docker load <span class="token operator">&lt;</span> ./images/<span class="token variable">$PRO_NAME</span><span class="token builtin class-name">:</span><span class="token variable">$PRO_VERSION</span>.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>导入从文件载入镜像</p> <ul><li>docker load --input 文件</li> <li>docker load &lt;</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker load <span class="token operator">&lt;</span> server.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="上面两操作区别"><a href="#上面两操作区别" class="header-anchor">#</a> <strong>上面两操作区别</strong></h5> <p>1，文件大小不同</p> <p><strong>export</strong> 导出的镜像文件体积小于 <strong>save</strong> 保存的镜像</p> <p>2，是否可以对镜像重命名</p> <ul><li><strong>docker import</strong> 可以为镜像指定新名称</li> <li><strong>docker load</strong> 不能对载入的镜像重命名</li></ul> <p>3，是否可以同时将多个镜像打包到一个文件中；【特殊】</p> <ul><li><strong>docker export</strong> 不支持</li> <li><strong>docker save</strong> 支持;</li></ul> <p>4，是否包含镜像历史</p> <ul><li><strong>export</strong> 导出（<strong>import</strong> 导入）是根据容器拿到的镜像，再导入时会丢失镜像所有的历史记录和元数据信息（即仅保存容器当时的快照状态），所以无法进行回滚操作。</li> <li>而 <strong>save</strong> 保存（<strong>load</strong> 加载）的镜像，没有丢失镜像的历史，可以回滚到之前的层（<strong>layer</strong>）。</li></ul> <p>5，应用场景不同</p> <ul><li><strong>docker export 的应用场景</strong>：主要用来制作基础镜像，比如我们从一个 <strong>ubuntu</strong> 镜像启动一个容器，然后安装一些软件和进行一些设置后，使用 <strong>docker export</strong> 保存为一个基础镜像。然后，把这个镜像分发给其他人使用，比如作为基础的开发环境。</li> <li><strong>docker save 的应用场景</strong>：如果我们的应用是使用 <strong>docker-compose.yml</strong> 编排的<strong>多个镜像组合</strong>，但我们要部署的客户服务器并不能连外网。这时就可以使用 <strong>docker save</strong> 将用到的镜像打个包，然后拷贝到客户服务器上使用 <strong>docker load</strong> 载入。</li></ul> <p>辅助命令，<strong>比较大小</strong></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">ls</span> -lh
docker <span class="token function">history</span> java-test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>特别注意：两种方法不可混用。</strong></p> <p>如果使用 <strong>import</strong> 导入 <strong>save</strong> 产生的文件，虽然导入不提示错误，但是启动容器时会提示失败，会出现类似&quot;<strong>docker: Error response from daemon: Container command not found or does not exist</strong>&quot;的错误。兼容上面的方式实现：</p> <p>镜像和容器导出的tar包组织结构完全不同，可根据tar中标志性文件区分两种类型tar包并分别使用相应的docker load或docker import导入镜像。</p> <p>可选择如下文件作为两种类型tar包的区分：</p> <p><strong>镜像tar包：manifest.json repositories</strong></p> <p><strong>容器tar包：.dockerenv</strong></p> <p><code>docker_upload.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#/bin/sh</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Usage: <span class="token variable">$0</span> *.tar&quot;</span>
    <span class="token builtin class-name">exit</span> -1
<span class="token keyword">fi</span>
<span class="token assign-left variable">TAR_FILE</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token function">tar</span> tvf <span class="token variable">${TAR_FILE}</span> <span class="token operator">|</span> <span class="token function">grep</span> -e <span class="token string">'manifest'</span> -e <span class="token string">'repositories'</span> -q  
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    docker load -i <span class="token variable">${TAR_FILE}</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------&gt;tar format is error!&quot;</span>
<span class="token keyword">else</span>
    <span class="token function">tar</span> tvf <span class="token variable">${TAR_FILE}</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'dockerenv'</span> -q <span class="token operator">&amp;&amp;</span> docker <span class="token function">import</span>  <span class="token variable">${TAR_FILE}</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;--------&gt;tar format is error!&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./docker_upload.sh ubuntu_test.tar 
docker images <span class="token operator">|</span> <span class="token function">grep</span> ubuntu
<span class="token comment">#注：因为参数只有一个tar名，所以导入容器时搜索到的镜像和tag都是&lt;none&gt;。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="实践"><a href="#实践" class="header-anchor">#</a> <strong>实践</strong></h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> docker save redis:5-alpine <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> images/redis:5-alpine.tar.gz
<span class="token function">sudo</span> docker load <span class="token operator">&lt;</span> ./docker/images/etag:1.1.1.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="查看日志"><a href="#查看日志" class="header-anchor">#</a> 查看日志</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker logs -f myjenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="update命令"><a href="#update命令" class="header-anchor">#</a> update命令</h4> <p>docker container update 命令用于更新一个或多个容器的配置。</p> <p><strong>用法</strong></p> <p><code>docker container update [OPTIONS] CONTAINER [CONTAINER...]</code></p> <p><strong>选项</strong></p> <table><thead><tr><th>名称,简写</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td><code>--blkio-weight</code></td> <td>0</td> <td>阻塞IO(相对权重)，介于<code>10</code>和<code>1000</code>之间，或<code>0</code>禁用(默认为<code>0</code>)</td></tr> <tr><td><code>--cpu-period</code></td> <td>0</td> <td>限制CPU CFS(完全公平的调度程序)周期</td></tr> <tr><td><code>--cpu-quota</code></td> <td>0</td> <td>限制CPU CFS(完全公平的调度程序)配额</td></tr> <tr><td><code>--cpu-rt-period</code></td> <td>0</td> <td>限制CPU实时周期(以微秒为单位)</td></tr> <tr><td><code>--cpu-rt-runtime</code></td> <td>0</td> <td>以微秒为单位限制CPU实时运行时间</td></tr> <tr><td><code>--cpu-shares, -c</code></td> <td>0</td> <td>CPU份额(相对权重)</td></tr> <tr><td><code>--cpuset-cpus</code></td> <td></td> <td>允许执行的CPU(0-3,0)</td></tr> <tr><td><code>--cpuset-mems</code></td> <td></td> <td>允许执行的内存率(0-3,0.1)</td></tr> <tr><td><code>--kernel-memory</code></td> <td></td> <td>内核内存限制</td></tr> <tr><td><code>--memory, -m</code></td> <td></td> <td>内存限制</td></tr> <tr><td><code>--memory-reservation</code></td> <td></td> <td>内存软限制</td></tr> <tr><td><code>--memory-swap</code></td> <td></td> <td>交换限制等于内存加交换：’<code>-1</code>‘以启用无限制的交换</td></tr> <tr><td><code>--restart</code></td> <td></td> <td>重新启动在容器退出时应用的策略</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#docker run -d \</span>
 -p <span class="token number">8080</span>:8080 <span class="token punctuation">\</span>
 -v <span class="token operator">&lt;</span>/your/local/assets/<span class="token operator">&gt;</span>:/www/assets <span class="token punctuation">\</span>
 --restart<span class="token operator">=</span>always <span class="token punctuation">\</span>
 samy/homer:latest

<span class="token comment">#sudo docker run --name=mysql --restart=always -e MYSQL_ROOT_PASSWORD=mypassword -v /path/to/directory:/var/lib/mysql -d mysql</span>
docker update mysql --restart<span class="token operator">=</span>always
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="镜像压缩与优化"><a href="#镜像压缩与优化" class="header-anchor">#</a> 镜像压缩与优化</h3> <p><strong>压缩镜像主要有以下</strong>：</p> <p>总括</p> <ul><li><p><strong>.dockerignore</strong>用于忽略非必须文件</p></li> <li><p>优化基础镜像；</p></li> <li><p>优化程序依赖, 优化Dockerfile顺序逻辑；移除不必要安装依赖，及资源下载；<strong>及时清理下载</strong></p></li> <li><p>串联 Dockerfile 指令；</p></li> <li><p>压缩自己的镜像；比如 export 和 import配合gzip或者docker-squash</p> <p><strong>启用squash特性</strong>: 通过启用squash特性（实验性功能）<code>docker build --squash -t curl:v3 .</code> 可以构建的镜像压缩为一层。但是为了充分发挥容器镜像层共享的优越设计，这种方法不被推荐。</p></li> <li><p>选用更合适的开发语言;</p></li></ul> <p>详细介绍</p> <ul><li><p>选择比较小的基础镜像，也就是FROM后面的那个镜像尽量要小; 比如：alpine</p> <ul><li><p>对比常用的、没有压缩过的基础镜像（在写作时使用的是:latest标签）：</p> <ul><li><code>scratch</code> 或者<code>busybox</code> 1-5MB</li> <li><code>Alpine</code> - 4.8MB</li> <li><code>Ubuntu</code> - 124.8 MB</li> <li><code>Centos</code> - 196MB</li></ul></li> <li><p><a href="https://link.zhihu.com/?target=https%3A//alpinelinux.org/" target="_blank" rel="noopener noreferrer">Alpine Linux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 是一个基于 <a href="https://link.zhihu.com/?target=https%3A//www.musl-libc.org/" target="_blank" rel="noopener noreferrer">musl libc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://link.zhihu.com/?target=https%3A//www.busybox.net/" target="_blank" rel="noopener noreferrer">busybox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的轻量级 Linux 发行版，主打安全。</p></li> <li><p>关于 scratch：</p> <ul><li>一个空镜像，只能用于构建镜像，通过 <code>FROM scratch</code></li> <li>在构建一些基础镜像，比如 <code>debian</code> 、 <code>busybox</code>，非常有用</li> <li>用于构建超少镜像，比如构建一个包含所有库的二进制文件</li></ul> <p>关于 <code>busybox</code></p> <ul><li>只有 1~5M 的大小</li> <li>包含了常用的 UNIX 工具</li> <li>非常方便构建小镜像</li></ul></li></ul></li> <li><p>RUN 命令要尽量写在一条里，每次 RUN 命令都是在之前的镜像上封装，只会增大不会减小;</p> <ul><li>不用修改固定层放一起,常用修改的一层分开处理下一层;</li> <li>wget下载后的资源，再删除，其实这个是压缩不到的；详见下图显示处理；</li> <li>Dockerfile 中的 RUN 指令通过 &amp;&amp; 和 / 支持将命令串联在一起，有时能达到意想不到的精简效果。</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>RUN <span class="token function">mkdir</span> -p <span class="token variable">$WORKDIR</span>/soft/nginx <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token variable">$WORKDIR</span>/soft/nginx <span class="token punctuation">\</span>
  <span class="token operator">&amp;&amp;</span> <span class="token function">wget</span> <span class="token variable">$URLBASE</span>/soft/nginx/nginx-1.18.0.tar.gz <span class="token punctuation">\</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p><strong>RUN命令中执行apt、apk或者yum类工具技巧</strong>; 每次进行依赖安装后，记得yum clean all【centos】 ; <strong>yum clean all 清除缓存中的rpm头文件和包文件</strong>；</p> <ul><li>执行 <code>apt-get install -y</code>时增加选项<code>--no-install-recommends</code> ，可以不用安装建议性（非必须）的依赖，也可以在执行 <code>apk add</code>时添加选项<code>--no-cache</code>达到同样效果；</li> <li>组件的安装和清理要串联在一条指令里面，如 <code>apt-get install zip &amp;&amp; rm -rf /var/cache/apk/*</code></li> <li>Ubuntu或 Debian可以使用 rm -rf /<strong>var</strong>/lib/apt/lists/* 清理镜像中缓存文件；CentOS 等系统使用 yum clean all 命令清理。</li></ul></li> <li><p><strong>上下文管理</strong>;经常会用到的COPY指令; COPY会把<strong>整个</strong> <strong>构建上下文</strong>复制到镜像中，并生产新的缓存层。为了不必要的文件如日志、缓存文件、Git 历史记录被加载到构建上下文，我们最好添加**.dockerignore**用于忽略非必须文件。这也是精简镜像关键一步，同时能更好的保证我们构建的镜像安全性;</p></li> <li><p>移除不必要安装依赖，及资源下载；<strong>及时清理下载</strong>;</p> <p>虽然使用了<code>rm</code>删除download.zip包，由于镜像分层的问题，download.zip是在新的一层被删除，上一层仍然存在。我们要在一层中及时清理下载</p> <p>比如现在用nodejs环境；用 distroless 去除所有不必要的东西；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>FROM node:8 as build
WORKDIR /app
COPY package.json index.js ./
RUN <span class="token function">npm</span> <span class="token function">install</span>

FROM node:8
COPY --from<span class="token operator">=</span>build /app /
EXPOSE <span class="token number">3000</span>
CMD <span class="token punctuation">[</span><span class="token string">&quot;index.js&quot;</span><span class="token punctuation">]</span>

docker build <span class="token builtin class-name">.</span> -t node-multi-stage
docker <span class="token function">history</span> node-multi-stage
docker images <span class="token operator">|</span> <span class="token function">grep</span> node-

<span class="token comment">#新镜像显示；</span>
FROM node:8 as build
WORKDIR /app
COPY package.json index.js ./
RUN <span class="token function">npm</span> <span class="token function">install</span>

FROM gcr.io/distroless/nodejs
COPY --from<span class="token operator">=</span>build /app /
EXPOSE <span class="token number">3000</span>
CMD <span class="token punctuation">[</span><span class="token string">&quot;index.js&quot;</span><span class="token punctuation">]</span>

docker build -t node-distroless <span class="token builtin class-name">.</span>
docker images <span class="token operator">|</span> <span class="token function">grep</span> node-distroless
docker run -p <span class="token number">3000</span>:3000 -ti --rm --init node-distroless
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li> <li><p>使用export和import后得到的镜像不会保存镜像的历史，所以镜像会变小；【推荐】</p> <p>但麻烦的是需要先将容器运行起来，而且这个过程中你会丢失镜像原有的一些信息，比如：导出端口，环境变量，默认指令。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ docker run -d redis:lab-3
$ docker <span class="token builtin class-name">export</span> 71b1c0ad0a2b <span class="token operator">|</span> docker <span class="token function">import</span> - redis:lab-4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>导出的文件通过gzip管道压缩；</p> <p><code>docker save &lt;image&gt;:&lt;tag&gt; | gzip &gt; /文件目录/压缩包名称.tar.gz</code></p></li> <li><p>使用<a href="https://github.com/jwilder/docker-squash#installation" target="_blank" rel="noopener noreferrer">docker-squash<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>；目前项目已经不维护； 注： 该工具在 Mac 下并不好使，请在 Linux 下使用；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker save <span class="token operator">!</span><span class="token punctuation">[</span>img<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">sudo</span> docker-squash -t newtag <span class="token operator">|</span> docker load

docker save redis:lab-3 <span class="token punctuation">\</span> 
  <span class="token operator">|</span> <span class="token function">sudo</span> docker-squash -verbose -t redis:lab-4  <span class="token punctuation">\</span> 
  <span class="token operator">|</span> docker load
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>新python库(docker-squash)[https://github.com/goldmann/docker-squash]</p></li> <li><p>squash功能一方面压缩了镜像的大小，另一方面保存了镜像的构建信息，但是该方法属于实验特性，需要谨慎使用。<strong>Experimental features 默认关闭，需要手动开启。</strong></p> <p><strong>设置</strong>：Daemon 进程启动前，要将 experimental 参数设置为 true; 通过修改<code>/etc/docker/daemon.json</code>开启：<code>&quot;experimental&quot;: true</code>;</p> <p>编译时，增加<code>--squash</code>参数;</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">service</span> docker restart

docker version
docker version -f <span class="token string">'{{.Server.Experimental}}'</span>
docker system info

docker build --no-cache --squash -t autorun-pro2 <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>服务中设置</strong>：<strong>修改docker配置文件</strong>docker.conf：</p> <p><code>systemctl status docker.service</code> 查看配置路径；</p> <p>Centos：<code>/usr/lib/systemd/system/docker.service</code></p> <p>Ubuntu: <code>/etc/systemd/system/docker.service.d/docker.conf</code></p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token comment"># cat /etc/systemd/system/docker.service.d/docker.conf </span>
<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
ExecStart<span class="token operator">=</span>
ExecStart<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>dockerd <span class="token operator">-</span>H fd<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span> <span class="token operator">--</span>experimental<span class="token operator">=</span><span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>并重启：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h3 id="镜像打包加速【要点】"><a href="#镜像打包加速【要点】" class="header-anchor">#</a> 镜像打包加速【要点】</h3> <ul><li><strong>借助<code>docker history xxx</code>,</strong> 可以查看到每一层命令的大小，方便定位优化；</li> <li>镜像压缩优化，变成一行处理；</li> <li>借助阿里云镜像在线打包及加速配置；</li> <li>分基处理打镜像,再分具体业务镜像； pdftk,liboffice；</li></ul> <p><img src="/rat-summ/assets/img/image-20220225144314367.9e4b617b.png" alt="image-20220225144314367"></p> <h3 id="网络模式"><a href="#网络模式" class="header-anchor">#</a> 网络模式</h3> <h4 id="五种网络模式比较"><a href="#五种网络模式比较" class="header-anchor">#</a> 五种网络模式比较</h4> <ul><li><strong>bridge</strong>：桥接，<em><strong>默认的网络驱动</strong></em>，如果不指定驱动，将默认使用桥接。通常用在同一个docker主机中的多个容器间通信。</li> <li><strong>host</strong>：去掉容器和宿主机之间的网络隔离，<strong>直接使用宿主机的网络</strong>。通常用在网络不与宿主机隔离但是其他资源需要隔离的场景。</li> <li><strong>none</strong>：禁用网络。swarm不支持。</li> <li><strong>overlay</strong>：叠加网络，将多个docker daemon连接到一起。<strong>主要用在运行在不同宿主机上的容器间通信</strong>。</li> <li><strong>macvlan</strong>：允许为容器分配一个MAC地址，让它成为一个物理设备。</li></ul> <h5 id="模式比较-正常机器下"><a href="#模式比较-正常机器下" class="header-anchor">#</a> 模式比较：正常机器下</h5> <ul><li>1.bridge网络</li></ul> <p>容器的默认网络模式，docker在安装时会创建一个名为docker0的Linux bridge，<strong>在不指定--network的情况下，创建的容器都会默认挂到docker0上面。</strong></p> <ul><li>2.host网络</li></ul> <p>通过命令--network=host指定，使用host模式的容器可以直接使用docker host的IP地址与外界通信，容器内部的服务端口也可以使用宿主机的端口，<strong>不需要进行NAT，host最大的优势就是网络性能比较好，但是docker host上已经使用的端口就不能再用了，网络的隔离性不好</strong>。</p> <ul><li>3.none网络</li></ul> <p>这种网络模式下容器只有lo回环网络，没有其他网卡。none网络可以在容器创建时通过--network=none来指定。<strong>这种类型的网络没有办法联网，封闭的网络能很好的保证容器的安全性</strong>。</p> <ul><li>4.container模式</li></ul> <p><strong>创建容器时使用--network=container:NAME_or_ID这个模式在创建新的容器的时候指定容器的网络和一个已经存在的容器共享一个Network Namespace</strong>，但是并不为docker容器进行任何网络配置，这个docker容器没有网卡、IP、路由等信息，<strong>需要手动的去为docker容器添加网卡、配置IP等</strong>。</p> <ul><li>5.user-defined模式</li></ul> <p>用户自定义模式主要可选的有三种网络驱动：<code>bridge</code>、<code>overlay</code>、<code>macvlan</code>。</p> <p><strong>bridge</strong>驱动用于创建类似于前面提到的bridge网络；</p> <p><strong>overlay</strong>和<strong>macvlan</strong>驱动用于<strong>创建跨主机的网络</strong>。</p> <p>ps:window环境下，<a href="https://docs.docker.com/docker-for-windows/networking/" target="_blank" rel="noopener noreferrer">host模式不支持<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>；</p> <h5 id="模式比较-虚拟器下"><a href="#模式比较-虚拟器下" class="header-anchor">#</a> 模式比较：虚拟器下</h5> <blockquote><p>主机跟虚拟机中的docker情况下</p></blockquote> <ul><li>本地网络</li></ul> <table><thead><tr><th>网络类型</th> <th>说明</th></tr></thead> <tbody><tr><td>bridge</td> <td>–net=bridge 默认模式,NAT转发</td></tr> <tr><td>host</td> <td>–net=host 使用宿主机网络</td></tr> <tr><td>none</td> <td>–net=none 无网卡</td></tr> <tr><td>container</td> <td>–net=container:容器名或ID ,共用其它容器网络</td></tr></tbody></table> <p>如果<strong>要是容器与宿主机进行通讯则不可选择host和container这两种网络</strong>，如果你仅需要Docker容器与宿主机网段相同，容器与其他同网段节点相互通信，不与宿主机进行通信，可以使用host网络模型！</p> <ul><li>跨主机网络</li></ul> <table><thead><tr><th>网络类型</th> <th>说明</th></tr></thead> <tbody><tr><td>overlay</td> <td>vxlan模式</td></tr> <tr><td>macvlan</td> <td>使用外部lan,需手动配置</td></tr></tbody></table> <p>macvlan的原理是在宿主机物理网卡上虚拟出多个子网卡，通过不同的MAC地址在数据链路层进行网络数据转发的，它是比较新的网络虚拟化技术，需要较新的内核支持，使用macVLAN模式的容器，无法ping通宿主机，宿主机也无法ping通该容器，对其他同网段的服务器和容器都可以联通。</p> <h5 id="虚拟机的设置"><a href="#虚拟机的设置" class="header-anchor">#</a> <strong>虚拟机的设置</strong></h5> <p><strong>“桥接”和“NAT”的区别</strong>：</p> <p>使用NAT模式可以实现在虚拟系统里访问互联网，虚拟系统无法和本局域网中的其他真实主机进行通讯。</p> <p>而使用桥接模式下虚拟出来的操作系统就像是局域网中的一台独立的主机，它可以访问网内任何一台机器。</p> <p>所以Docker0是属于桥接模式。</p> <h4 id="net、network-mode、networks"><a href="#net、network-mode、networks" class="header-anchor">#</a> net、network_mode、networks</h4> <p><strong>net</strong></p> <p><a href="https://docs.docker.com/compose/compose-file/#version-1" target="_blank" rel="noopener noreferrer">Version 1 file format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> only. In version 2, use <a href="https://docs.docker.com/compose/compose-file/#network_mode" target="_blank" rel="noopener noreferrer">network_mode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>为容器指定网络类型，version 1专用，version 2使用network_mode.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>net: &quot;bridge&quot;
net: &quot;host&quot;
net: &quot;none&quot;
net: &quot;container:[service name or container name/id]&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>network_mode</strong></p> <p><a href="https://docs.docker.com/compose/compose-file/#version-2" target="_blank" rel="noopener noreferrer">Version 2 file format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> only. In version 1, use <a href="https://docs.docker.com/compose/compose-file/#net" target="_blank" rel="noopener noreferrer">net<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>为容器指定网络类型.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>network_mode: &quot;bridge&quot;
network_mode: &quot;host&quot;
network_mode: &quot;none&quot;
network_mode: &quot;service:[service name]&quot;
network_mode: &quot;container:[container name/id]&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>networks</strong></p> <blockquote><p><a href="https://docs.docker.com/compose/compose-file/#version-2" target="_blank" rel="noopener noreferrer">Version 2 file format<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> only. In version 1, use <a href="https://docs.docker.com/compose/compose-file/#net" target="_blank" rel="noopener noreferrer">net<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></blockquote> <p>Networks to join, referencing entries under the <a href="https://docs.docker.com/compose/compose-file/#network-configuration-reference" target="_blank" rel="noopener noreferrer">top-level <code>networks</code> key<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>services:</p> <p>some-service:</p> <p>networks:</p> <p>- some-network</p> <p>- other-network</p> <p>指定网络模式。<strong>注意“network_mode: &quot;host&quot;”不能与 links 选项合用。</strong></p> <p>** links
关联另一个服务中的容器。如果同时指定了该选项和 networks 选项，那个关联的服务之间应该至少要有一个共同的网络才能相互通信。</p> <h3 id="docker-opts设置"><a href="#docker-opts设置" class="header-anchor">#</a> DOCKER_OPTS设置</h3> <h4 id="ubuntu"><a href="#ubuntu" class="header-anchor">#</a> ubuntu</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ <span class="token builtin class-name">echo</span> <span class="token string">'DOCKER_OPTS=&quot;-H tcp://0.0.0.0:2376&quot;'</span> <span class="token operator">&gt;&gt;</span> /etc/default/docker
$ <span class="token function">sudo</span> <span class="token function">service</span> docker start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="centos"><a href="#centos" class="header-anchor">#</a> centos</h4> <p>不同于Ubuntu目录 /etc/default/docker。 在 CentOS7中Docker默认配置的路径在 ；<code>/usr/lib/systemd/system/docker.service</code>
【例如修改 --icc = false】CentOS7中需要如下设置</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">vim</span> /usr/lib/systemd/system/docker.service

<span class="token comment">#ExecStart=/usr/bin/dockerd-current -H tcp://0.0.0.0:4343 -H unix:///var/run/docker.sock</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/dockerd -H tcp://0.0.0.0:4343 -H fd:// --containerd<span class="token operator">=</span>/run/containerd/containerd.sock

<span class="token comment"># DOCKER_OPTS=/usr/bin/dockerd-current -H tcp://0.0.0.0:4343 -H unix:///var/run/docker.sock</span>
<span class="token comment">#DOCKER_OPTS='-H tcp://0.0.0.0:4343 -H unix:///var/run/docker.sock'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>echo方式设置：<code>DOCKER_OPTS='-H tcp://0.0.0.0:2376 -H unix:///var/run/docker.sock'</code></p> <p>设置完毕后，执行重启；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker daemon -reload
systemctl restart docker
<span class="token comment">#查看是否生效</span>
<span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> docker 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="全局设置"><a href="#全局设置" class="header-anchor">#</a> 全局设置</h4> <img src="_image/01.docker&amp;compose及swarm的使用/image-20220121105223636.png" alt="image-20220121105223636" style="zoom:67%;"> <h3 id="容器启动与状态"><a href="#容器启动与状态" class="header-anchor">#</a> 容器启动与状态</h3> <h4 id="run-start的区别"><a href="#run-start的区别" class="header-anchor">#</a> run/start的区别</h4> <ul><li><strong>docker run 只在第一次运行时使用</strong>，将镜像放到容器中，以后再次启动这个容器时，只需要使用命令docker start 即可。</li> <li>docker run相当于执行了两步操作：
<ul><li>将镜像放入容器中（docker create）,然后将容器启动，使之变成运行时容器（docker start）。</li> <li>而docker start的作用是，重新启动已存在的镜像；也就是说，如果使用这个命令，我们必须事先知道这个容器的ID，或者这个容器的名字，我们可以使用docker; ps找到这个容器的信息。</li></ul></li></ul> <h4 id="kill-stop的区别与联系"><a href="#kill-stop的区别与联系" class="header-anchor">#</a> kill/stop的区别与联系</h4> <p>相同点：</p> <ul><li>两者都是停掉容器，并把容器状态指定到stopped。</li></ul> <p>不同点：</p> <ul><li>被kill杀死容器，进入stopped状态被重新start后，会开启新的进程号；</li> <li>被stop停掉的容器，再次被重新start后，进程号不变，还是原来的。</li></ul> <p>kill命令比较生猛，不管容器死活，直接给系统发送SIGKILL的系统信号强行kill掉进程，就是要用kill -9干掉容器；</p> <p>stop比较温柔，先给容器发送一个TERM信号，给容器充足时间(默认10秒)保存数据，让容器自动安全停止运行，超时后再给系统发送SIGKILL的系统信号强行kill掉进程，最后转变为stop状态。</p> <p><strong>使用docker stop -t [s, default 10],可调整超时时间（docker stop -t 20 mynginx）</strong></p> <h4 id="pause-unpause暂停和取消暂停"><a href="#pause-unpause暂停和取消暂停" class="header-anchor">#</a> pause/unpause暂停和取消暂停</h4> <ul><li>pause  暂停容器中所有的进程，状态为Pause(暂停对外提供服务)</li> <li>unpause 取消暂停，将容器恢复为Up上线状态</li></ul> <p>使用场景：在各个容器之间调试时使用。</p> <p>语法：docker pause [OPTIONS] CONTAINER [CONTAINER...]</p> <p>-t, --time int   Seconds to wait for stop before killing it (default 10)</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker pause mynginx

docker pause mynginx -t <span class="token number">30</span>
<span class="token comment">#该命令首先向容器发送SIGTERM信号，等待一段时间后（-t 参数指定，默认为10s），再发送SIGKILL信号来终止容器。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="prune命令"><a href="#prune命令" class="header-anchor">#</a> <code>prune</code>命令</h4> <p><code>docker container prune</code>命令，会自动清除掉所有处于停止状态的容器</p> <h4 id="生命周期演示"><a href="#生命周期演示" class="header-anchor">#</a> 生命周期演示</h4> <p>常见的五种状态：<code>created</code>,<code>running</code>,<code>exited</code>,<code>paused</code>,其他,</p> <p>更好的展示效果，先停掉Docker服务</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#service docker stop</span>
或者
<span class="token comment">#systemctl stop docker </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="create状态为create创建状态"><a href="#create状态为create创建状态" class="header-anchor">#</a> create状态为create创建状态</h5> <blockquote><p>发现：create命令，创建容器后，#docker ps 并看不到该容器，因为ps命令不带任何任何参数时，只显示状态为Up的容器。<strong>此时的容器状态是Created</strong>。</p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker create tomcat:8.5.46-jdk8-openjdk  <span class="token comment">#创建容器（并没有启动）</span>
docker <span class="token function">ps</span>  <span class="token comment">#查看容器列表（只显示已启动的）</span>
docker <span class="token function">ps</span> -a  <span class="token comment">#查看所有容器（可以看到状态是Created的容器）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="start状态为up上线状态"><a href="#start状态为up上线状态" class="header-anchor">#</a> start状态为up上线状态</h5> <blockquote><p>发现：start命令后，容器状态<strong>由Created变为Up</strong></p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker start bf88214f5f6d  <span class="token comment">#根据容器id启动容器</span>
docker <span class="token function">ps</span> <span class="token comment">#可以看到容器状态为up，已上线状态</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="pause-unpause状态为pause暂停-上线状态"><a href="#pause-unpause状态为pause暂停-上线状态" class="header-anchor">#</a> pause/unpause状态为pause暂停/上线状态</h5> <blockquote><p>发现：pause命令后，容器状态<strong>从Up变为Paused; unpause命令后，状态又切回Up状态。</strong></p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker pause bf88214f5f6d  <span class="token comment">#根据容器id启动容器</span>
docker <span class="token function">ps</span> <span class="token comment">#可以看到容器状态为up(pause)，已上线(暂停)状态</span>
docker unpause bf88214f5f6d  <span class="token comment">#取消暂停容器</span>
docker <span class="token function">ps</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="stop停掉容器"><a href="#stop停掉容器" class="header-anchor">#</a> stop停掉容器</h5> <blockquote><p>发现：stop命令后,容器状态<strong>从Up变为Exited</strong>，退出状态。</p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker stop bf88214f5f6d
docker <span class="token function">ps</span> -a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="rm-f强制删除容器"><a href="#rm-f强制删除容器" class="header-anchor">#</a> rm -f强制删除容器</h5> <blockquote><p>发现：容器被rm命令移除后，docker ps -a 看不到任何容器</p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker <span class="token function">rm</span> -f  bf88214f5f6d 
docker <span class="token function">ps</span> -a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="也通过命令inspect查看"><a href="#也通过命令inspect查看" class="header-anchor">#</a> 也通过命令<code>inspect</code>查看</h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#docker ps -a | grep $PRO_NAME</span>
docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> autorun-pro

docker inspect autorun-pro
docker inspect --format <span class="token string">'{{.State.Status}}'</span> autorun-pro
docker inspect --format <span class="token string">'{{.State.Running}}'</span> autorun-pro

<span class="token comment">#running, exited, paused, 其他err</span>
Template parsing error: template: :1:8: executing <span class="token string">&quot;&quot;</span> at <span class="token operator">&lt;</span>.State.Status<span class="token operator">&gt;</span>: map has no entry <span class="token keyword">for</span> key <span class="token string">&quot;State&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker start autorun-pro
        <span class="token string">&quot;State&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;running&quot;</span>,
            <span class="token string">&quot;Running&quot;</span><span class="token builtin class-name">:</span> true,
            <span class="token string">&quot;Paused&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Restarting&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;OOMKilled&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Dead&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Pid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">8940</span>,
            <span class="token string">&quot;ExitCode&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;Error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;StartedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:27:57.407867285Z&quot;</span>,
            <span class="token string">&quot;FinishedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:25:59.451068304Z&quot;</span>
        <span class="token punctuation">}</span>,

docker stop autorun-pro
docker start autorun-pro
 <span class="token string">&quot;State&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;exited&quot;</span>,
            <span class="token string">&quot;Running&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Paused&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Restarting&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;OOMKilled&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Dead&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Pid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;ExitCode&quot;</span><span class="token builtin class-name">:</span> <span class="token number">137</span>,
            <span class="token string">&quot;Error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;StartedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:06:10.631579416Z&quot;</span>,
            <span class="token string">&quot;FinishedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:25:59.451068304Z&quot;</span>
        <span class="token punctuation">}</span>,
      
docker pause autorun-pro
docker unpause autorun-pro
        <span class="token string">&quot;State&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;Status&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;paused&quot;</span>,
            <span class="token string">&quot;Running&quot;</span><span class="token builtin class-name">:</span> true,
            <span class="token string">&quot;Paused&quot;</span><span class="token builtin class-name">:</span> true,
            <span class="token string">&quot;Restarting&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;OOMKilled&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Dead&quot;</span><span class="token builtin class-name">:</span> false,
            <span class="token string">&quot;Pid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">8940</span>,
            <span class="token string">&quot;ExitCode&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
            <span class="token string">&quot;Error&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;StartedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:27:57.407867285Z&quot;</span>,
            <span class="token string">&quot;FinishedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2022-03-02T07:25:59.451068304Z&quot;</span>
        <span class="token punctuation">}</span>,
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h4 id="脚本处理启动状态变化"><a href="#脚本处理启动状态变化" class="header-anchor">#</a> 脚本处理启动状态变化</h4> <p><code>start.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">###</span>
 <span class="token comment"># @Author: samy</span>
 <span class="token comment"># @email: yessz#foxmail.com</span>
 <span class="token comment"># @time: 2022-02-18 13:21:47</span>
 <span class="token comment"># @modAuthor: samy</span>
 <span class="token comment"># @modTime: 2022-02-28 17:20:34</span>
 <span class="token comment"># @desc: 容器启动</span>
 <span class="token comment"># Copyright © 2015~2022 BDP FE</span>
<span class="token comment">### </span>
<span class="token comment">#autorun-pro:latest</span>
<span class="token assign-left variable">PRO_NAME</span><span class="token operator">=</span>autorun-pro
<span class="token assign-left variable">PRO_VERSION</span><span class="token operator">=</span>latest 

<span class="token comment"># docker inspect --format '{{.State.Running}}' autorun-pro</span>
<span class="token comment"># docker inspect --format '{{.State.Status}}' autorun-pro</span>
<span class="token comment"># EXIST=`docker ps -a | grep $PRO_NAME | wc -l`</span>
<span class="token assign-left variable">EXISTS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>docker inspect --format <span class="token string">'{{.State.Status}}'</span> $PRO_NAME<span class="token variable">`</span></span>

<span class="token keyword">case</span> <span class="token variable">$EXISTS</span> <span class="token keyword">in</span>
    <span class="token string">&quot;running&quot;</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是running状态---将不做处理---&quot;</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">&quot;exited&quot;</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是exited状态---将start处理...&quot;</span>
        docker start <span class="token variable">$PRO_NAME</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token string">&quot;paused&quot;</span><span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是paused状态---将unpause处理...&quot;</span>
        docker unpause <span class="token variable">$PRO_NAME</span>
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
     <span class="token string">&quot;created&quot;</span><span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">&quot;---容器是created状态---将start处理...&quot;</span>
            docker start <span class="token variable">$PRO_NAME</span>
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;---检查到容器不存在---将run处理中...&quot;</span>
        docker run -d <span class="token punctuation">\</span>
          -p <span class="token number">28080</span>:80 -p <span class="token number">26379</span>:6379 -p <span class="token number">23306</span>:3306 <span class="token punctuation">\</span>
          -v /data/autorun/mysql/log:/var/log/mysql <span class="token punctuation">\</span>
          -v /data/autorun/mysql/data:/var/lib/mysql <span class="token punctuation">\</span>
          --name <span class="token variable">$PRO_NAME</span> <span class="token variable">$PRO_NAME</span><span class="token builtin class-name">:</span><span class="token variable">$PRO_VERSION</span>
<span class="token keyword">esac</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h3 id="build设置"><a href="#build设置" class="header-anchor">#</a> Build设置</h3> <p><code>-t,-f</code> 指定版本；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker build -f /path/to/a/Dockerfile <span class="token builtin class-name">.</span>

docker build -t runoob/ubuntu:v1 <span class="token builtin class-name">.</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>--no-cache</code>不使用缓存；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment"># docker build -t autorun-pro .</span>
docker build --no-cache -t autorun-pro <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h3> <h4 id="格式"><a href="#格式" class="header-anchor">#</a> <strong>格式</strong></h4> <h5 id="from"><a href="#from" class="header-anchor">#</a> FROM</h5> <blockquote><p>指定基于哪个基础镜像</p></blockquote> <p>格式 FROM<code>&lt;image&gt;</code> 或者  FROM <code>&lt;image&gt;:&lt;tag&gt;</code>，  比如</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>FROM centos
FROM centos<span class="token punctuation">:</span>latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="maintainer"><a href="#maintainer" class="header-anchor">#</a> MAINTAINER</h5> <blockquote><p>指定作者信息</p></blockquote> <p>格式  MAINTAIN <code>&lt;name&gt;</code>，比如</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>MAINTAINER  samy  samy@163.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="workdir"><a href="#workdir" class="header-anchor">#</a> WORKDIR</h5> <blockquote><p>格式 <strong>WORKDIR  /path/to/workdir</strong></p></blockquote> <p>为后续的RUN、CMD或者ENTRYPOINT指定工作目录；</p> <p>WORKDIR 用来切换工作目录的。Docker 默认的工作目录是/，只有 RUN 能执行 cd 命令切换目录，而且还只作用在当下下的 RUN，也就是说每一个 RUN 都是独立进行的。<strong>如果想让其他指令在指定的目录下执行，就得靠 WORKDIR。WORKDIR 动作的目录改变是持久的，不用每个指令前都使用一次 WORKDIR</strong>。</p> <h5 id="user"><a href="#user" class="header-anchor">#</a> USER</h5> <blockquote><p>格式 USER daemon</p></blockquote> <p>指定运行容器的用户</p> <h5 id="run"><a href="#run" class="header-anchor">#</a> RUN</h5> <blockquote><p>镜像操作指令</p></blockquote> <p>格式为 RUN <command>  或者 RUN [“executable”, “param1”, “param2”]，比如</command></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>RUN  yum install  httpd
RUN <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echo hello&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="env"><a href="#env" class="header-anchor">#</a> ENV</h5> <p>格式 ENV  <code>&lt;key&gt; &lt;value&gt;</code>；</p> <p>格式有两种：</p> <ul><li><code>ENV &lt;key&gt; &lt;value&gt;</code></li> <li><code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...</code></li></ul> <p>它主要是为后续的RUN指令提供一个环境变量，我们也可以定义一些自定义的变量</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>ENV MYSQL_version 5.6

<span class="token comment">#定义工作目录</span>
ENV WORKDIR /srv/app
WORKDIR $WORKDIR
<span class="token comment"># COPY . .</span>
ADD entrypoint.sh $WORKDIR/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>设置JDK环境：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>ENV JAVA_HOME=/usr/local/java
ENV JRE_HOME=/usr/local/java/jre
ENV CLASSPATH=.<span class="token punctuation">:</span>$JAVA_HOME/lib/dt.jar<span class="token punctuation">:</span>$JAVA_HOME/lib/tools.jar<span class="token punctuation">:</span>$JRE_HOME/lib<span class="token punctuation">:</span>$CLASSPATH
ENV PATH=$PATH<span class="token punctuation">:</span>$JAVA_HOME/bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="add"><a href="#add" class="header-anchor">#</a> ADD</h5> <blockquote><p>格式 add <code>&lt;src&gt; &lt;dest&gt;</code></p></blockquote> <p>两种格式</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token constant">ADD</span> <span class="token punctuation">[</span><span class="token operator">--</span>chown<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token operator">&lt;</span>group<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span><span class="token operator">...</span> <span class="token operator">&lt;</span>dest<span class="token operator">&gt;</span>
<span class="token constant">ADD</span> <span class="token punctuation">[</span><span class="token operator">--</span>chown<span class="token operator">=</span><span class="token operator">&lt;</span>user<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token operator">&lt;</span>group<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token string">&quot;&lt;src&gt;&quot;</span><span class="token punctuation">,</span><span class="token operator">...</span> <span class="token string">&quot;&lt;dest&gt;&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>--chown：仅适用于 linux 上的 dockerfile，在 window 上没有用户、组的概念；</p> <p>将本地的一个文件或目录拷贝到容器的某个目录里。 其中src为Dockerfile所在目录的相对路径，它也可以是一个url；</p> <p>ADD的另外一个特性是有能力自动解压文件。如果<code>&lt;src&gt;</code>参数是一个可识别的压缩格式（tar, gzip, bzip2, etc）的本地文件（所以实现不了同时下载并解压），就会被解压到指定容器文件系统的路径<code>&lt;dest&gt;</code>。</p> <p><src> 是压缩格式（gzip、bzip2、identity、xz）的本地 tar 文件</src></p> <ul><li>会将它自动解压为目录</li> <li>但来自远程 URL 资源不会被解压缩</li> <li>当一个目录被复制或解压时，它的行为与 tar -x 相同</li> <li>注意：文件是否被识别为可识别的压缩格式完全取决于文件的内容，而不是文件的名称；例如，如果一个空文件恰好以 .tar.gz 结尾，黄不会被识别为压缩文件，也不会生成任何类型的解压缩错误消息，而只会将该文件复制到目标位置</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>ADD &lt;conf/vhosts<span class="token punctuation">&gt;</span> &lt;/usr/local/nginx/conf<span class="token punctuation">&gt;</span>

ADD http<span class="token punctuation">:</span>//foo.com/bar.go /tmp/main.go
ADD http<span class="token punctuation">:</span>//foo.com/bar.go /tmp/

<span class="token comment">#会使foo.tar.gz压缩文件解压到容器的/tmp目录</span>
ADD /foo.tar.gz /tmp/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>有如下注意事项</strong></p> <ul><li>如果源路径是个文件，且目标路径是以 / 结尾， 则docker会把目标路径当作一个目录，会把源文件拷贝到该目录下。
如果目标路径不存在，则会自动创建目标路径。</li> <li>如果源路径是个文件，且目标路径是不是以 / 结尾，则docker会把目标路径当作一个文件。
如果目标路径不存在，会以目标路径为名创建一个文件，内容同源文件；
如果目标文件是个存在的文件，会用源文件覆盖它，当然只是内容覆盖，文件名还是目标文件名。
如果目标文件实际是个存在的目录，则会源文件拷贝到该目录下。 注意，这种情况下，最好显示的以 / 结尾，以避免混淆。</li> <li>如果源路径是个目录，且目标路径不存在，则docker会自动以目标路径创建一个目录，把源路径目录下的文件拷贝进来。
如果目标路径是个已经存在的目录，则docker会把源路径目录下的文件拷贝到该目录下。</li> <li>如果源文件是个归档文件（压缩文件），则docker会自动帮解压。</li></ul> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>ADD config/ /config/

ADD test1.txt test1.txt
ADD test1.txt test1.txt.bak
ADD test1.txt /mydir/
ADD data1 data1
ADD data2 data2
ADD zip.tar /myzip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>ADD 和 COPY 的区别和使用场景</strong></p> <ul><li>ADD 支持添加远程 url 和自动提取压缩格式的文件，COPY 只允许从本机中复制文件</li> <li>COPY 支持从其他构建阶段中复制源文件（--from）</li> <li>根据官方 Dockerfile 最佳实践，除非真的需要从远程 url 添加文件或自动提取压缩文件才用 ADD，其他情况一律使用 COPY</li></ul> <p><strong>注意</strong></p> <ul><li>ADD 从远程 url 获取文件和复制的效果并不理想，<strong>因为该文件会增加 Docker Image 最终的大小</strong>;</li> <li>相反，应该使用 curl 或者 wget 来获取远程文件，然后在不需要它时进行删除;</li></ul> <h5 id="copy"><a href="#copy" class="header-anchor">#</a> COPY</h5> <blockquote><p>格式同add</p></blockquote> <p>使用方法和add一样，不同的是，<strong>它不支持url</strong></p> <p><strong>Docker 团队的建议是在大多数情况下使用COPY。拷贝文件的原则：使用COPY（除非你明确你需要ADD）;</strong></p> <p>&lt;目标路径&gt; 可以是容器内的绝对路径，<strong>也可以是相对于工作目录的相对路径（工作目录可以用 WORKDIR 指令来指定）</strong>。目标路径不需要事先创建，如果目录不存在会在复制文件前先行</p> <p>创建缺失目录。</p> <p><code>COPY &lt;源路径&gt;... &lt;目标路径&gt;</code> <code>COPY [&quot;&lt;源路径1&gt;&quot;,... &quot;&lt;目标路径&gt;&quot;]</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#正确：</span>
COPY ./package.json /app/
COPY package.json /usr/src/app/

<span class="token comment">#错误：</span>
COPY <span class="token punctuation">..</span>/package.json /app
<span class="token comment">#或者 COPY /opt/xxxx /app</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意：</p> <p>此外，还需要注意一点，使用 COPY 指令，源文件的各种元数据都会保留。比如读、写、执
行权限、文件变更时间等。</p> <p><strong>复制保留子目录结构</strong></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>COPY files/ /files/
RUN ls <span class="token punctuation">-</span>la /files/*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>完整示范：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>FROM centos
<span class="token comment"># 添加文件到目录下</span>
ADD test.txt /mydir/

<span class="token comment"># 将文件内容写入 mytest</span>
ADD test.txt /mytest

<span class="token comment"># 压缩文件,自动解压</span>
ADD jmeter.log.zip /myzipdir/

<span class="token comment"># 添加目录</span>
ADD TeamFile /

<span class="token comment"># 其他文件</span>
ADD jmeter.log /mydir/

<span class="token comment"># 多个文件</span>
ADD test1.txt test2.txt /mydir/

<span class="token comment"># 通配符,dest 不存在自动创建</span>
ADD test<span class="token important">*.txt</span> /mydir/test/

<span class="token comment"># 特殊字符串</span>
ADD add<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span>0<span class="token punctuation">]</span>.txt /mydir/

WORKDIR /data

<span class="token comment"># 相对路径</span>
ADD test.txt test/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h5 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h5> <blockquote><p>三种格式：</p> <ul><li>CMD [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</li> <li>CMD command param1 param2</li> <li>CMD [&quot;param1&quot;, &quot;param2&quot;]</li></ul></blockquote> <p>RUN和CMD看起来挺像，但是CMD用来指定<strong>容器启动时用到的命令</strong>，只能有一条。比如</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>CMD <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/nginx/sbin/nginx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-c&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/usr/local/nginx/conf/nginx.conf&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>cmd执行外部脚本</strong></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>FROM ubuntu<span class="token punctuation">:</span><span class="token number">14.04</span>
ADD shell.sh /usr/local/bin/shell.sh
RUN chmod 777 /usr/local/bin/shell.sh
CMD /usr/local/bin/shell.sh<span class="token punctuation">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="expose"><a href="#expose" class="header-anchor">#</a> EXPOSE</h5> <p>格式为 EXPOSE <code>&lt;port&gt; [&lt;port&gt;...] ,</code> 比如</p> <p>EXPOSE 22 80 8443</p> <p>这个用来指定要映射出去的端口，比如容器内部我们启动了sshd和nginx，所以我们需要把22和80端口暴漏出去。这个需要配合-P（大写）来工作，也就是说在<strong>启动容器时，需要加上-P，让它自动分配</strong>。如果想<strong>指定具体的端口，也可以使用-p（小写）来指定</strong>。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run -itd -p <span class="token number">19876</span>:80  --name autorun-test autorun-test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="entrypoint【要点】"><a href="#entrypoint【要点】" class="header-anchor">#</a> ENTRYPOINT【要点】</h5> <blockquote><p>格式类似CMD</p></blockquote> <p>容器启动时要执行的命令，它和CMD很像，也是只有一条生效，如果写多个只有最后一条有效。和CMD不同是：</p> <p>如果同时有cmd和entrypoint的话，都会执行：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>FROM ubuntu
MAINTAINER sofija
RUN apt<span class="token punctuation">-</span>get update
ENTRYPOINT <span class="token punctuation">[</span>“echo”<span class="token punctuation">,</span> “Hello”<span class="token punctuation">]</span>
CMD <span class="token punctuation">[</span>“World”<span class="token punctuation">]</span>
<span class="token comment"># Hello World</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>CMD 是可以被 docker run 指令覆盖的，而ENTRYPOINT不能覆盖</strong>。</p> <p>CMD 和 ENTRYPOINT 区别</p> <ul><li>CMD                   # 指定这个容器启动的时候要运行的命令，不可以追加命令</li> <li>ENTRYPOINT            # 指定这个容器启动的时候要运行的命令，可以追加命令</li></ul> <p>比如，容器名字为aming</p> <p>我们在Dockerfile中指定如下CMD：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>CMD <span class="token punctuation">[</span><span class="token string">&quot;/bin/echo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># CMD [&quot;/usr/sbin/nginx&quot;, &quot;-g&quot; ,&quot;daemon off;&quot;]</span>
<span class="token comment"># CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>启动容器的命令是  docker run aming 这样会输出 test</p> <p>假如启动容器的命令是 docker run -it aming  /bin/bash  什么都不会输出</p> <p><strong>ENTRYPOINT不会被覆盖，而且会比CMD或者docker run指定的命令要靠前执行</strong></p> <p>ENTRYPOINT [&quot;echo&quot;, &quot;test&quot;]</p> <p>docker run -it aming  123</p> <p>则会输出 test  123 ，这相当于要执行命令  echo test  123</p> <p>ps：如果设置cmd或者ENTRYPOINT，启动容器时，不要设置bash命令；要分两部处理i；</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
docker stop autorun-test
docker <span class="token function">rm</span> autorun-test
docker run -itd -p <span class="token number">19876</span>:80  --name autorun-test autorun-test
docker <span class="token builtin class-name">exec</span> -it autorun-test <span class="token function">bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>ENTRYPOINT执行外部脚本</strong></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./entrypoint.sh&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>./entrypoint.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
redis /usr/local/redis/redis.conf
nginx -g <span class="token string">&quot;daemon off;&quot;</span>
<span class="token comment"># nginx -c /usr/local/nginx/conf/nginx.conf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="volume"><a href="#volume" class="header-anchor">#</a> VOLUME</h5> <blockquote><p>格式  VOLUME [&quot;/data&quot;]</p></blockquote> <p>创建一个可以从本地主机或其他容器挂载的挂载点。</p> <h4 id="构建"><a href="#构建" class="header-anchor">#</a> 构建</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># 使用说明:</span>
<span class="token comment"># 启动脚本:sudo bash ./docker/build.sh</span>
<span class="token function">sudo</span> docker build -t etag -f docker/Dockerfile <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="源、时间动态设置"><a href="#源、时间动态设置" class="header-anchor">#</a> 源、时间动态设置</h4> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> alpine<span class="token punctuation">:</span>3.9

<span class="token comment"># 设置时区为上海</span>
<span class="token keyword">RUN</span> apk add tzdata &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \
    &amp;&amp; echo <span class="token string">&quot;Asia/Shanghai&quot;</span> <span class="token punctuation">&gt;</span> /etc/timezone \
    &amp;&amp; apk del tzdata
    
<span class="token keyword">RUN</span> echo  <span class="token string">&quot;http://mirrors.aliyun.com/alpine/v3.7/main/&quot;</span> <span class="token punctuation">&gt;</span> /etc/apk/repositories
<span class="token comment">#apk update</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>示例：</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> ubuntu<span class="token punctuation">:</span>16.04
<span class="token keyword">LABEL</span> author=<span class="token string">&quot;samy&quot;</span> version=<span class="token string">&quot;1.0.0&quot;</span>

<span class="token keyword">RUN</span> apt<span class="token punctuation">-</span>get update \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y sudo \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y language<span class="token punctuation">-</span>pack<span class="token punctuation">-</span>zh<span class="token punctuation">-</span>hans \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y language<span class="token punctuation">-</span>pack<span class="token punctuation">-</span>en \
    &amp;&amp; apt<span class="token punctuation">-</span>get install python2.7 python2.7<span class="token punctuation">-</span>dev make gcc <span class="token punctuation">-</span>y \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y curl \
    &amp;&amp; curl <span class="token punctuation">-</span>sL https<span class="token punctuation">:</span>//deb.nodesource.com/setup_10.x <span class="token punctuation">|</span> sudo <span class="token punctuation">-</span>E bash <span class="token punctuation">-</span> \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y nodejs \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y build<span class="token punctuation">-</span>essential \
    &amp;&amp; apt<span class="token punctuation">-</span>get install <span class="token punctuation">-</span>y vim &amp;&amp; \
    rm <span class="token punctuation">-</span>rf /tmp/* /var/lib/apt/* /var/cache/* /var/log/*

<span class="token keyword">ENV</span> LANG en_US.UTF<span class="token punctuation">-</span>8 \
    &amp;&amp; NODE_PATH=/usr/local/lib/node_modules/<span class="token punctuation">:</span>/usr/local/lib  NODE_ENV=docker \
    &amp;&amp; PRO_PATH ./

<span class="token keyword">WORKDIR</span> ../

<span class="token keyword">RUN</span> npm install <span class="token punctuation">-</span>g cnpm <span class="token punctuation">-</span><span class="token punctuation">-</span>registry=https<span class="token punctuation">:</span>//registry.npm.taobao.org \
    &amp;&amp; cnpm install <span class="token punctuation">-</span>g node<span class="token punctuation">-</span>gyp \
 <span class="token comment">#   &amp;&amp; cnpm install -g pm2 \</span>
    &amp;&amp; cnpm install

<span class="token keyword">CMD</span> <span class="token punctuation">[</span> <span class="token string">&quot;pm2-docker&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;docker-process.json&quot;</span> <span class="token punctuation">]</span>

<span class="token keyword">EXPOSE</span> 8004
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> node<span class="token punctuation">:</span>10.14<span class="token punctuation">-</span>alpine

<span class="token keyword">RUN</span> apk <span class="token punctuation">-</span><span class="token punctuation">-</span>update add tzdata \
    &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \
    &amp;&amp; echo <span class="token string">&quot;Asia/Shanghai&quot;</span> <span class="token punctuation">&gt;</span> /etc/timezone \
    &amp;&amp; apk del tzdata

<span class="token keyword">RUN</span> apk add <span class="token punctuation">-</span><span class="token punctuation">-</span>update <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>cache make gcc g++ \
    curl bash tree vim git \
&amp;&amp; rm <span class="token punctuation">-</span>r /usr/share/man \
&amp;&amp; rm <span class="token punctuation">-</span>r /var/cache/apk/*

<span class="token keyword">ENV</span> PYTHONUNBUFFERED=1
<span class="token comment"># Install python3 &amp; pip3</span>
<span class="token keyword">RUN</span> apk add <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>cache python python<span class="token punctuation">-</span>dev &amp;&amp; \
    python3 python3<span class="token punctuation">-</span>dev \
    linux<span class="token punctuation">-</span>headers build<span class="token punctuation">-</span>base ca<span class="token punctuation">-</span>certificates &amp;&amp; \
    python3 <span class="token punctuation">-</span>m ensurepip &amp;&amp; \
    rm <span class="token punctuation">-</span>r /usr/lib/python*/ensurepip &amp;&amp; \
    pip3 install <span class="token punctuation">-</span><span class="token punctuation">-</span>upgrade pip setuptools &amp;&amp; \
    pip3 install <span class="token punctuation">-</span><span class="token punctuation">-</span>no<span class="token punctuation">-</span>cache Pillow numpy PyCRC qrcode argparse &amp;&amp; \
    if <span class="token punctuation">[</span> ! <span class="token punctuation">-</span>e /usr/bin/pip <span class="token punctuation">]</span>; then ln <span class="token punctuation">-</span>s pip3 /usr/bin/pip ; fi &amp;&amp; \
    rm <span class="token punctuation">-</span>r /root/.cache


<span class="token keyword">RUN</span> mkdir <span class="token punctuation">-</span>p /usr/src/app
<span class="token keyword">WORKDIR</span> /usr/src/app

<span class="token keyword">COPY</span> package.json /usr/src/app/
<span class="token comment"># RUN npm i  --registry=https://registry.npm.taobao.org --production</span>
<span class="token keyword">RUN</span> npm i  <span class="token punctuation">-</span><span class="token punctuation">-</span>registry=https<span class="token punctuation">:</span>//registry.npm.taobao.org

<span class="token keyword">COPY</span> . .
   
<span class="token keyword">EXPOSE</span> 7082

<span class="token comment"># CMD npm run docker</span>
<span class="token keyword">CMD</span> npm run dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="docker-compose"><a href="#docker-compose" class="header-anchor">#</a> Docker compose</h2> <h3 id="常见命令"><a href="#常见命令" class="header-anchor">#</a> 常见命令</h3> <ul><li><strong>ps</strong>：列出所有运行容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>logs</strong>：查看服务日志输出</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose logs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>port</strong>：打印绑定的公共端口，下面命令可以输出 eureka 服务 8761 端口所绑定的公共端口</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose port eureka <span class="token number">8761</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>build</strong>：构建或者重新构建服务</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>start</strong>：启动指定服务已存在的容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose start eureka
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>stop</strong>：停止已运行的服务的容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose stop eureka
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>rm</strong>：删除指定服务的容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose <span class="token function">rm</span> eureka
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>up</strong>：构建、启动容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose up
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>kill</strong>：通过发送 SIGKILL 信号来停止指定服务的容器</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose <span class="token function">kill</span> eureka
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>pull</strong>：下载服务镜像</li> <li><strong>scale</strong>：设置指定服务运气容器的个数，以 service=num 形式指定</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose scale <span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">movie</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>run</strong>：在一个服务上执行一个命令</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>docker-compose run web <span class="token function">bash</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="docker-compose-yml-属性"><a href="#docker-compose-yml-属性" class="header-anchor">#</a> docker-compose.yml 属性</h3> <ul><li><strong>version</strong>：指定 docker-compose.yml 文件的写法格式</li> <li><strong>services</strong>：多个容器集合</li> <li><strong>build</strong>：配置构建时，Compose 会利用它自动构建镜像，该值可以是一个路径，也可以是一个对象，用于指定 Dockerfile 参数</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>build: ./dir
---------------
build:
    context: ./dir
    dockerfile: Dockerfile
    args:
        buildno: 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>command</strong>：覆盖容器启动后默认执行的命令</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>command: bundle exec thin -p 3000
----------------------------------
command: [bundle,exec,thin,-p,3000]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>dns</strong>：配置 dns 服务器，可以是一个值或列表</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>dns: 8.8.8.8
------------
dns:
    - 8.8.8.8
    - 9.9.9.9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>dns_search</strong>：配置 DNS 搜索域，可以是一个值或列表</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>dns_search: example.com
------------------------
dns_search:
    - dc1.example.com
    - dc2.example.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>environment</strong>：环境变量配置，可以用数组或字典两种方式</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>environment:
    RACK_ENV: development
    SHOW: 'ture'
-------------------------
environment:
    - RACK_ENV=development
    - SHOW=ture
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><strong>env_file</strong>：从文件中获取环境变量，可以指定一个文件路径或路径列表，其优先级低于 environment 指定的环境变量</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>env_file: .env
---------------
env_file:
    - ./common.env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>expose</strong>：暴露端口，只将端口暴露给连接的服务，而不暴露给主机</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>expose:
    - &quot;3000&quot;
    - &quot;8000&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>image</strong>：指定服务所使用的镜像</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>image: java
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>network_mode</strong>：设置网络模式</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>network_mode: &quot;bridge&quot;
network_mode: &quot;host&quot;
network_mode: &quot;none&quot;
network_mode: &quot;service:[service name]&quot;
network_mode: &quot;container:[container name/id]&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>ports</strong>：对外暴露的端口定义，和 expose 对应</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>ports:   # 暴露端口信息  - &quot;宿主机端口:容器暴露端口&quot;
- &quot;8763:8763&quot;
- &quot;8763:8763&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>links</strong>：将指定容器连接到当前连接，可以设置别名，避免ip方式导致的容器重启动态改变的无法连接情况</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>links:    # 指定服务名称:别名 
    - docker-compose-eureka-server:compose-eureka
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><strong>volumes</strong>：卷挂载路径</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>volumes:
  - /lib
  - /var
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><strong>logs</strong>：日志输出信息</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>--no-color          单色输出，不显示其他颜.
-f, --follow        跟踪日志输出，就是可以实时查看日志
-t, --timestamps    显示时间戳
--tail              从日志的结尾显示，--tail=200
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="docker-compose-其它"><a href="#docker-compose-其它" class="header-anchor">#</a> Docker Compose 其它</h3> <h4 id="更新容器"><a href="#更新容器" class="header-anchor">#</a> 更新容器</h4> <ul><li>当服务的配置发生更改时，可使用 docker-compose up 命令更新配置</li> <li>此时，Compose 会删除旧容器并创建新容器，新容器会以不同的 IP 地址加入网络，名称保持不变，任何指向旧容起的连接都会被关闭，重新找到新容器并连接上去</li></ul> <h4 id="links"><a href="#links" class="header-anchor">#</a> links</h4> <ul><li>服务之间可以使用服务名称相互访问，links 允许定义一个别名，从而使用该别名访问其它服务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>version: '2'
services:
    web:
        build: .
        links:
            - &quot;db:database&quot;
    db:
        image: postgres
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>这样 Web 服务就可以使用 db 或 database 作为 hostname 访问 db 服务了</li></ul> <h4 id="build"><a href="#build" class="header-anchor">#</a> build</h4> <p>服务除了可以基于指定的镜像，还可以基于一份 Dockerfile，在使用 up 启动之时执行构建任务，这个构建标签就是 build，它可以指定 Dockerfile 所在文件夹的路径。Compose 将会利用它自动构建这个镜像，然后使用这个镜像启动服务容器。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build: /path/to/build/dir
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>也可以是相对路径，只要上下文确定就可以读取到 Dockerfile。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build: ./dir
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>设定上下文根目录，然后以该目录为准指定 Dockerfile。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build:
  context: ../
  dockerfile: path/of/Dockerfile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>注意 build 都是一个目录，如果你要指定 Dockerfile 文件需要在 build 标签的子级标签中使用 dockerfile 标签指定，如上面的例子。
如果你同时指定了 image 和 build 两个标签，那么 Compose 会构建镜像并且把镜像命名为 image 后面的那个名字。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build: ./dir
image: webapp:tag
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>既然可以在 docker-compose.yml 中定义构建任务，那么一定少不了 arg 这个标签，就像 Dockerfile 中的 ARG 指令，它可以在构建过程中指定环境变量，但是在构建成功后取消，在 docker-compose.yml 文件中也支持这样的写法：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build:
  context: .
  args:
    buildno: 1
    password: secret
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>下面这种写法也是支持的，一般来说下面的写法更适合阅读。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>build:
  context: .
  args:
    - buildno=1
    - password=secret
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>与 ENV 不同的是，ARG 是允许空值的。例如：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>args:
  - buildno
  - password
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样构建过程可以向它们赋值。</p> <p><strong>mysql配置及启动依赖</strong></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code>    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> mysql
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> mysql
<span class="token key atrule">command</span><span class="token punctuation">:</span> mysqld <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4 <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci <span class="token punctuation">-</span><span class="token punctuation">-</span>init<span class="token punctuation">-</span>connect='SET NAMES utf8mb4;' <span class="token punctuation">-</span><span class="token punctuation">-</span>innodb<span class="token punctuation">-</span>flush<span class="token punctuation">-</span>log<span class="token punctuation">-</span>at<span class="token punctuation">-</span>trx<span class="token punctuation">-</span>commit=0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="常用示例"><a href="#常用示例" class="header-anchor">#</a> 常用示例</h3> <p><code>docker-compose.yml</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2.2'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>5<span class="token punctuation">-</span>alpine
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /srv/etag/redis/data<span class="token punctuation">:</span>/data
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
  <span class="token key atrule">mysql</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>5.7.24
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> /srv/etag/mysql/data<span class="token punctuation">:</span>/var/lib/mysql
        <span class="token punctuation">-</span> /srv/etag/mysql/init<span class="token punctuation">:</span>/docker<span class="token punctuation">-</span>entrypoint<span class="token punctuation">-</span>initdb.d/
    <span class="token key atrule">command</span><span class="token punctuation">:</span> mysqld <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4 <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci <span class="token punctuation">-</span><span class="token punctuation">-</span>init<span class="token punctuation">-</span>connect='SET NAMES utf8mb4;' <span class="token punctuation">-</span><span class="token punctuation">-</span>innodb<span class="token punctuation">-</span>flush<span class="token punctuation">-</span>log<span class="token punctuation">-</span>at<span class="token punctuation">-</span>trx<span class="token punctuation">-</span>commit=0
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> MYSQL_ROOT_PASSWORD=xxx
        <span class="token comment"># - MYSQL_DATABASE=etag_dev</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
  <span class="token key atrule">etag</span><span class="token punctuation">:</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> mysql
    <span class="token key atrule">image</span><span class="token punctuation">:</span> etag<span class="token punctuation">:</span>1.1.1
    <span class="token key atrule">network_mode</span><span class="token punctuation">:</span> host
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /srv/etag/config/config.json<span class="token punctuation">:</span>/usr/src/app/database/config.json
      <span class="token punctuation">-</span> /srv/etag/config/config.default.js<span class="token punctuation">:</span>/usr/src/app/config/config.default.js
      <span class="token punctuation">-</span> /srv/etag/config/config.prod.js<span class="token punctuation">:</span>/usr/src/app/config/config.prod.js
      <span class="token punctuation">-</span> /srv/etag/logs<span class="token punctuation">:</span>/usr/src/app/logs
      <span class="token punctuation">-</span> /srv/etag/public<span class="token punctuation">:</span>/usr/src/app/public
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>FROM node:10.14-alpine

RUN apk --update <span class="token function">add</span> tzdata <span class="token punctuation">\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token function">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime <span class="token punctuation">\</span>
    <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;Asia/Shanghai&quot;</span> <span class="token operator">&gt;</span> /etc/timezone <span class="token punctuation">\</span>
    <span class="token operator">&amp;&amp;</span> apk del tzdata

RUN apk <span class="token function">add</span> --update --no-cache <span class="token function">make</span> gcc g++ <span class="token punctuation">\</span>
    <span class="token function">curl</span> <span class="token function">bash</span> tree <span class="token function">vim</span> <span class="token function">git</span> <span class="token punctuation">\</span>
<span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -r /usr/share/man <span class="token punctuation">\</span>
<span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -r /var/cache/apk/*

ENV <span class="token assign-left variable">PYTHONUNBUFFERED</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment"># Install python3 &amp; pip3</span>
RUN apk <span class="token function">add</span> --no-cache python python-dev <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token comment">#     python3 python3-dev \</span>
<span class="token comment">#     linux-headers build-base ca-certificates &amp;&amp; \</span>
<span class="token comment">#     python3 -m ensurepip &amp;&amp; \</span>
<span class="token comment">#     rm -r /usr/lib/python*/ensurepip &amp;&amp; \</span>
<span class="token comment">#     pip3 install --upgrade pip setuptools &amp;&amp; \</span>
<span class="token comment">#     pip3 install --no-cache Pillow numpy PyCRC qrcode argparse &amp;&amp; \</span>
 <span class="token comment">#    if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi &amp;&amp; \</span>
    <span class="token function">rm</span> -r /root/.cache


RUN <span class="token function">mkdir</span> -p /usr/src/app
WORKDIR /usr/src/app

COPY package.json /usr/src/app/
<span class="token comment"># RUN npm i  --registry=https://registry.npm.taobao.org --production</span>
RUN <span class="token function">npm</span> i  --registry<span class="token operator">=</span>https://registry.npm.taobao.org

COPY <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>
   
EXPOSE <span class="token number">7082</span>

<span class="token comment"># CMD npm run docker</span>
CMD <span class="token function">npm</span> run dev

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'2.2'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">delos</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rap2<span class="token punctuation">-</span>delos
    <span class="token comment"># build from ./Dockerfile</span>
<span class="token comment">#    build: .</span>
    <span class="token comment"># build from images</span>
    <span class="token comment"># you can find last tag from https://hub.docker.com/r/blackdog1987/rap2-delos</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> blackdog1987/rap2<span class="token punctuation">-</span>delos<span class="token punctuation">:</span>2.6.aa3be03
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token comment"># if you have your own mysql, config it here, and disable the 'mysql' config blow</span>
      <span class="token punctuation">-</span> MYSQL_URL=rap2<span class="token punctuation">-</span>mysql <span class="token comment"># links will maintain /etc/hosts, just use 'container_name'</span>
      <span class="token punctuation">-</span> MYSQL_PORT=3306
      <span class="token punctuation">-</span> MYSQL_USERNAME=root
      <span class="token punctuation">-</span> MYSQL_PASSWD=
      <span class="token punctuation">-</span> MYSQL_SCHEMA=rap2

      <span class="token comment"># redis config</span>
      <span class="token punctuation">-</span> REDIS_URL=rap2<span class="token punctuation">-</span>redis
      <span class="token punctuation">-</span> REDIS_PORT=6379

      <span class="token comment"># production / development</span>
      <span class="token punctuation">-</span> NODE_ENV=production
    <span class="token key atrule">working_dir</span><span class="token punctuation">:</span> /app
    <span class="token key atrule">privileged</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token comment">###### 'sleep 30 &amp;&amp; node scripts/init' will drop the tables</span>
    <span class="token comment">###### RUN ONLY ONCE THEN REMOVE 'sleep 30 &amp;&amp; node scripts/init'</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> /bin/sh <span class="token punctuation">-</span>c 'sleep 30; node scripts/init; node dispatch.js'
    <span class="token comment"># init the databases</span>
<span class="token comment">#    command: sleep 30 &amp;&amp; node scripts/init &amp;&amp; node dispatch.js</span>
    <span class="token comment"># without init</span>
<span class="token comment">#    command: node dispatch.js</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> mysql
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis
      <span class="token punctuation">-</span> mysql
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;38080:8080&quot;</span>  <span class="token comment"># expose 38080</span>

  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rap2<span class="token punctuation">-</span>redis
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>4.0.9

  <span class="token comment"># disable this if you have your own mysql</span>
  <span class="token key atrule">mysql</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> rap2<span class="token punctuation">-</span>mysql
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>5.7.22
    <span class="token comment"># expose 33306 to client (navicat)</span>
    <span class="token comment">#ports:</span>
    <span class="token comment">#   - 33306:3306</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token comment"># change './docker/mysql/volume' to your own path</span>
      <span class="token comment"># WARNING: without this line, your data will be lost.</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;./docker/mysql/volume:/var/lib/mysql&quot;</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> mysqld <span class="token punctuation">-</span><span class="token punctuation">-</span>character<span class="token punctuation">-</span>set<span class="token punctuation">-</span>server=utf8mb4 <span class="token punctuation">-</span><span class="token punctuation">-</span>collation<span class="token punctuation">-</span>server=utf8mb4_unicode_ci <span class="token punctuation">-</span><span class="token punctuation">-</span>init<span class="token punctuation">-</span>connect='SET NAMES utf8mb4;' <span class="token punctuation">-</span><span class="token punctuation">-</span>innodb<span class="token punctuation">-</span>flush<span class="token punctuation">-</span>log<span class="token punctuation">-</span>at<span class="token punctuation">-</span>trx<span class="token punctuation">-</span>commit=0
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">MYSQL_ALLOW_EMPTY_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">&quot;true&quot;</span>
      <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> <span class="token string">&quot;rap2&quot;</span>
      <span class="token key atrule">MYSQL_USER</span><span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token key atrule">MYSQL_PASSWORD</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h2 id="docker-swarm"><a href="#docker-swarm" class="header-anchor">#</a> Docker swarm</h2> <p><strong>docker部署 code-push-server</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>//启动swarm
<span class="token function">sudo</span> docker swarm init
//部署
<span class="token function">sudo</span> docker stack deploy -c docker-compose.yml code-push-server
//查看服务日志
<span class="token function">sudo</span> docker <span class="token function">service</span> logs code-push-server_server
<span class="token function">sudo</span> docker <span class="token function">service</span> logs code-push-server_db
<span class="token function">sudo</span> docker <span class="token function">service</span> logs code-push-server_redis
//销毁退出应用
<span class="token function">sudo</span> docker stack <span class="token function">rm</span> code-push-server
<span class="token function">sudo</span> docker swarm leave --force
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="制作示范"><a href="#制作示范" class="header-anchor">#</a> 制作示范</h2> <h3 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 获取示例项目</span>
<span class="token function">git</span> clone https://github.com/samy/jenkins_demo.git

<span class="token comment"># 项目文件</span>
├── index.html              <span class="token comment"># 页面文件</span>
├── Dockerfile              <span class="token comment"># 镜像文件</span>
├── docker-compose.src.yml  <span class="token comment"># Docker 部署文件</span>
├── deploy_jenkins.sh       <span class="token comment"># 部署脚本</span>
├── Jenkinsfile             <span class="token comment"># Jenkins Pipeline 文件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="准备文件"><a href="#准备文件" class="header-anchor">#</a> 准备文件</h3> <p><code>index.html</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Jenkins demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Jenkins demo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>Dockerfile</code></p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token keyword">FROM</span> nginx<span class="token punctuation">:</span>1.15.2
<span class="token keyword">ENV</span> REFRESHED_AT 2018<span class="token punctuation">-</span>08<span class="token punctuation">-</span>09

<span class="token keyword">COPY</span> ./index.html /usr/share/nginx/html/index.html

<span class="token keyword">RUN</span> ln <span class="token punctuation">-</span>sf /dev/stdout /var/log/nginx/access.log \
    &amp;&amp; ln <span class="token punctuation">-</span>sf /dev/stderr /var/log/nginx/error.log

<span class="token keyword">EXPOSE</span> 80

<span class="token keyword">STOPSIGNAL</span> SIGTERM

<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;nginx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-g&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;daemon off;&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>docker-compose.src.yml</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.4'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">jenkins_demo</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> IMAGE_LATEST
    <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
      <span class="token key atrule">restart_policy</span><span class="token punctuation">:</span>
        <span class="token key atrule">condition</span><span class="token punctuation">:</span> on<span class="token punctuation">-</span>failure
    <span class="token key atrule">expose</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;80&quot;</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8081<span class="token punctuation">:</span><span class="token number">80</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>部署脚本：<code>deploy_jenkins.sh</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># 容器名称</span>
<span class="token assign-left variable">CONTAINER</span><span class="token operator">=</span><span class="token string">&quot;jenkins_demo&quot;</span>
<span class="token comment"># 镜像名称（以日期时间为镜像标签，防止重复）</span>
<span class="token assign-left variable">IMAGE</span><span class="token operator">=</span><span class="token variable">$CONTAINER</span><span class="token string">&quot;:&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> -d <span class="token string">&quot;today&quot;</span> +<span class="token string">&quot;%Y%m%d_%H%M%S&quot;</span><span class="token variable">)</span></span>

<span class="token comment"># 删除滚动更新残留的容器</span>
docker <span class="token function">rm</span> <span class="token variable"><span class="token variable">`</span>docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> -w $CONTAINER<span class="token string">&quot;_&quot;</span>$CONTAINER <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token variable">`</span></span>
<span class="token comment"># 强制删除滚动更新残留的镜像</span>
docker rmi --force <span class="token variable"><span class="token variable">`</span>docker images <span class="token operator">|</span> <span class="token function">grep</span> -w $CONTAINER <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token variable">`</span></span>

<span class="token comment"># 创建新镜像</span>
docker build -t <span class="token variable">$IMAGE</span> <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>

<span class="token comment"># 删除 docker-compose.jenkins.yml 文件，防止使用相同镜像</span>
<span class="token function">rm</span> -rf docker-compose.jenkins.yml <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>

<span class="token comment"># 复制 docker-compose.src.yml 文件，防止污染原文件</span>
<span class="token function">cp</span> docker-compose.src.yml docker-compose.jenkins.yml <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>

<span class="token comment"># 替换镜像名标志位为最新镜像</span>
<span class="token function">sed</span> -i s%IMAGE_LATEST%<span class="token variable">$IMAGE</span>%g docker-compose.jenkins.yml <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>

<span class="token comment"># 使用 docker stack 启动服务</span>
docker stack deploy -c docker-compose.jenkins.yml <span class="token variable">$CONTAINER</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="相关问题"><a href="#相关问题" class="header-anchor">#</a> 相关问题</h2> <h3 id="在docker里面使用systemctl"><a href="#在docker里面使用systemctl" class="header-anchor">#</a> 在Docker里面使用systemctl</h3> <p>我们有时在使用docker的时候，会发现在容器中是用systemctl 或者 service的时候，会遇到下面的错误：
<code>Failed to connect to bus: No such file or directory</code></p> <p><strong>原因</strong></p> <blockquote><p>That’s because “systemctl” talks to the systemd daemon by using the d-bus. In a container there is no systemd-daemon. Asking for a start will probably not quite do what you expect - the dev-mapping need to be a bit longer.</p></blockquote> <p>容器里面是没有systemd进程的，所以不能正常开启systemctl。为什么docker会这样呢：</p> <blockquote><p>This is by design. Docker should be running a process in the foreground in your container and it will be spawned as PID 1 within the container’s pid namespace. Docker is designed for process isolation, not for OS virtualization, so there are no other OS processes and daemons running inside the container (like systemd, cron, syslog, etc), only your entrypoint or command you run.
If they included systemd commands, you’d find a lot of things not working since your entrypoint replaces init. Systemd also makes use to cgroups which docker restricts inside of containers since the ability to change cgroups could allow a process to escape the container’s isolation. Without systemd running as init inside your container, there’s no daemon to process your start and stop commands.</p></blockquote> <p>docker只是提供了进程隔离，不是操作系统的虚拟。</p> <p><strong>解决方案</strong></p> <ol><li>我们可以在启动容器的时候将在启动参数加上 /sbin/init 来让其生效。
以centos为例：
<code>docker run -d -v /sys/fs/cgroup/:/sys/fs/cgroup:ro --cap-add SYS_ADMIN --name systemd_websrv centos /sbin/init</code>
就可以正常使用systemd了
但是如果容器重启，那么就可能导致失效。</li> <li>替换systemctl
使用 <a href="https://github.com/gdraheim/docker-systemctl-replacement" target="_blank" rel="noopener noreferrer">docker-systemctl-replacement<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>替换容器中的systemctl。
以ubuntu镜像为例：
1). 安装python2
<code>sudo apt install python</code>
2). 替换systemcl (注意路径，可以使用<code>whereis systemctl</code>查看当前默认路径)
<code>wget https://raw.githubusercontent.com/gdraheim/docker-systemctl-replacement/master/files/docker/systemctl.py -O /bin/systemctl</code>
3). 给定权限
<code>sudo chmod a+x /bin/systemctl</code>
这样接可以使用非systemd的systemctl，但是因为是非官方的systemcl所以可能存在一些未知问题。</li></ol> <p>最好还是建议将docker作为进程隔离环境，<code>single app single container</code>， 但是遇到非常特殊的情况下，可以上述两个解决方案；</p> <h3 id="no-such-file-or-directory"><a href="#no-such-file-or-directory" class="header-anchor">#</a> no such file or directory</h3> <blockquote><h4 id="var-lib-docker-tmp-docker-import-525555606-repositories-no-such-file-or-directory"><a href="#var-lib-docker-tmp-docker-import-525555606-repositories-no-such-file-or-directory" class="header-anchor">#</a> /var/lib/docker/tmp/docker-import-525555606/repositories: no such file or directory</h4></blockquote> <p><strong>第一种可能：load/import错乱；</strong></p> <p>首先得明白docker load 和docker import 的区别：docker load 用来载入镜像包，docker import 用来载入容器包，但两者都会恢复为镜像。docker export保存的容器，需要docker import载入，而docker save的镜像包，需要docker load载入。</p> <blockquote><h5 id="docker-save-与-docker-export-以及-docker-load-和-docker-import-的区别"><a href="#docker-save-与-docker-export-以及-docker-load-和-docker-import-的区别" class="header-anchor">#</a> docker save 与 docker export 以及 docker load 和 docker import 的区别</h5></blockquote> <ul><li>docker save保存的是镜像（image），docker export保存的是容器（container）；</li> <li>docker load用来载入镜像包，docker import用来载入容器包，但两者都会恢复为镜像；</li> <li>docker load不能对载入的镜像重命名，而docker import可以为镜像指定新名称。</li></ul> <p>因为压缩包如果是用 docker save 打包的，就可以用 docker load，但是如果压缩包是用 docker export 打包的，那就需要用 docker import</p> <p><strong>第二种可能：导入进去的根本不是镜像；检查那压缩文件是否是镜像；</strong></p> <h2 id="相关链接"><a href="#相关链接" class="header-anchor">#</a> 相关链接</h2> <ul><li><a href="https://docs.docker.com/engine/reference/builder" target="_blank" rel="noopener noreferrer">Dockerfile reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>https://docker-practice.github.io/zh-cn</li></ul></div></div> <div class="page-slot page-slot-bottom"><!-- 横向自适应 -->
      <ins class="adsbygoogle"
          style="display:block"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="6620245489"
          data-ad-format="auto"
          data-full-width-responsive="true"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/04/15, 05:41:30</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/rat-summ/pages/a07627/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">docker环境及配置</div></a> <a href="/rat-summ/pages/975a75/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">docker常用脚本及工具</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/rat-summ/pages/a07627/" class="prev">docker环境及配置</a></span> <span class="next"><a href="/rat-summ/pages/975a75/">docker常用脚本及工具</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:yessz@foxmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/samyzh" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
    Copyright © 2015-2022
    <span><a href='https://my.samyz.cn' target='_blank'>友一升 | yessz</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><i class="close-but">×</i> <div><!-- 固定160*160px -->
      <ins class="adsbygoogle"
          style="display:inline-block;width:160px;height:160px"
          data-ad-client="ca-pub-7828333725993554"
          data-ad-slot="8377369658"></ins>
      <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
      </div></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/rat-summ/assets/js/app.12c8e251.js" defer></script><script src="/rat-summ/assets/js/3.9ee9750d.js" defer></script><script src="/rat-summ/assets/js/204.f9c43a60.js" defer></script><script src="/rat-summ/assets/js/126.5b6d9993.js" defer></script>
  </body>
</html>